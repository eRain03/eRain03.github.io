<!DOCTYPE html>
<html lang="en" dir="auto">

<head><meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="robots" content="index, follow">
<title>ç¥å·æ•°ç è®¾å¤‡çŸ¥è¯†ç‚¹å¤‡ä»½ | æœªæ·¼çš„åšå®¢</title>
<meta name="keywords" content="">
<meta name="description" content="ä»…ä½œä¸ºå¤‡ä»½æ–‡ä»¶ å¤‡ä»½æ—¶é—´ 2023.6.23 ä¸€ã€äº¤æ¢æœºé…ç½® 1ã€ç”Ÿæˆæ ‘spanning-tree SW1ã€SW2ã€SW3å¯ç”¨MSTPï¼Œå®ç°ç½‘ç»œäºŒå±‚è´Ÿè½½å‡è¡¡å’Œå†—ä½™å¤‡ä»½">
<meta name="author" content="æœªæ·¼">
<link rel="canonical" href="https://erain.fun/posts/tech/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81%E8%AE%BE%E5%A4%87%E7%9F%A5%E8%AF%86%E7%82%B9%E5%A4%87%E4%BB%BD/">
<link crossorigin="anonymous" href="/assets/css/stylesheet.2738a21a8f4259354ef8232db6a6357622c8ec4dca4c991280ca23151173cfd9.css" integrity="sha256-JziiGo9CWTVO&#43;CMttqY1diLI7E3KTJkSgMojFRFzz9k=" rel="preload stylesheet" as="style">
<script defer crossorigin="anonymous" src="/assets/js/highlight.f413e19d0714851f6474e7ee9632408e58ac146fbdbe62747134bea2fa3415e0.js" integrity="sha256-9BPhnQcUhR9kdOfuljJAjlisFG&#43;9vmJ0cTS&#43;ovo0FeA="
    onload="hljs.initHighlightingOnLoad();"></script>
<link rel="icon" href="https://erain.fun/img/Q.jpg">
<link rel="icon" type="image/png" sizes="16x16" href="https://erain.fun/img/Q.jpg">
<link rel="icon" type="image/png" sizes="32x32" href="https://erain.fun/img/Q.jpg">
<link rel="apple-touch-icon" href="https://erain.fun/Q.jpg">
<link rel="mask-icon" href="https://erain.fun/Q.jpg">
<meta name="theme-color" content="#2e2e33">
<meta name="msapplication-TileColor" content="#2e2e33">
<noscript>
    <style>
        #theme-toggle,
        .top-link {
            display: none;
        }

    </style>
</noscript><link href="https://fonts.cdnfonts.com/css/code-new-roman" rel="stylesheet">               
<meta property="og:title" content="ç¥å·æ•°ç è®¾å¤‡çŸ¥è¯†ç‚¹å¤‡ä»½" />
<meta property="og:description" content="ä»…ä½œä¸ºå¤‡ä»½æ–‡ä»¶ å¤‡ä»½æ—¶é—´ 2023.6.23 ä¸€ã€äº¤æ¢æœºé…ç½® 1ã€ç”Ÿæˆæ ‘spanning-tree SW1ã€SW2ã€SW3å¯ç”¨MSTPï¼Œå®ç°ç½‘ç»œäºŒå±‚è´Ÿè½½å‡è¡¡å’Œå†—ä½™å¤‡ä»½" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://erain.fun/posts/tech/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81%E8%AE%BE%E5%A4%87%E7%9F%A5%E8%AF%86%E7%82%B9%E5%A4%87%E4%BB%BD/" /><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2023-07-14T09:14:15+08:00" />
<meta property="article:modified_time" content="2023-07-14T09:14:15+08:00" />

<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="ç¥å·æ•°ç è®¾å¤‡çŸ¥è¯†ç‚¹å¤‡ä»½"/>
<meta name="twitter:description" content="ä»…ä½œä¸ºå¤‡ä»½æ–‡ä»¶ å¤‡ä»½æ—¶é—´ 2023.6.23 ä¸€ã€äº¤æ¢æœºé…ç½® 1ã€ç”Ÿæˆæ ‘spanning-tree SW1ã€SW2ã€SW3å¯ç”¨MSTPï¼Œå®ç°ç½‘ç»œäºŒå±‚è´Ÿè½½å‡è¡¡å’Œå†—ä½™å¤‡ä»½"/>


<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BreadcrumbList",
  "itemListElement": [, 
    {
      "@type": "ListItem",
      "position":  2 ,
      "name": "â€œæ–‡ç« â€",
      "item": "https://erain.fun/posts/"
    }, 
    {
      "@type": "ListItem",
      "position":  3 ,
      "name": "â€œæŠ€æœ¯åˆ†äº«â€",
      "item": "https://erain.fun/posts/tech/"
    }, 
    {
      "@type": "ListItem",
      "position":  4 ,
      "name": "ç¥å·æ•°ç è®¾å¤‡çŸ¥è¯†ç‚¹å¤‡ä»½",
      "item": "https://erain.fun/posts/tech/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81%E8%AE%BE%E5%A4%87%E7%9F%A5%E8%AF%86%E7%82%B9%E5%A4%87%E4%BB%BD/"
    }
  ]
}
</script>
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "BlogPosting",
  "headline": "ç¥å·æ•°ç è®¾å¤‡çŸ¥è¯†ç‚¹å¤‡ä»½",
  "name": "ç¥å·æ•°ç è®¾å¤‡çŸ¥è¯†ç‚¹å¤‡ä»½",
  "description": "ä»…ä½œä¸ºå¤‡ä»½æ–‡ä»¶ å¤‡ä»½æ—¶é—´ 2023.6.23 ä¸€ã€äº¤æ¢æœºé…ç½® 1ã€ç”Ÿæˆæ ‘spanning-tree SW1ã€SW2ã€SW3å¯ç”¨MSTPï¼Œå®ç°ç½‘ç»œäºŒå±‚è´Ÿè½½å‡è¡¡å’Œå†—ä½™å¤‡ä»½",
  "keywords": [
    
  ],
  "articleBody": " ä»…ä½œä¸ºå¤‡ä»½æ–‡ä»¶ å¤‡ä»½æ—¶é—´ 2023.6.23\nä¸€ã€äº¤æ¢æœºé…ç½® 1ã€ç”Ÿæˆæ ‘spanning-tree SW1ã€SW2ã€SW3å¯ç”¨MSTPï¼Œå®ç°ç½‘ç»œäºŒå±‚è´Ÿè½½å‡è¡¡å’Œå†—ä½™å¤‡ä»½ï¼Œåˆ›å»ºå®ä¾‹Instance10å’ŒInstance20ï¼Œåç§°ä¸ºSKILLSï¼Œä¿®è®¢ç‰ˆæœ¬ä¸º1ï¼Œå…¶ä¸­Instance10å…³è”vlan60å’Œvlan70ï¼ŒInstance20å…³è”vlan80å’Œvlan90ã€‚SW1ä¸ºInstance0å’ŒInstance10çš„æ ¹äº¤æ¢æœºï¼Œä¸ºInstance20å¤‡ä»½æ ¹äº¤æ¢æœºï¼›SW2ä¸ºInstance20æ ¹äº¤æ¢æœºï¼Œä¸ºInstance0å’ŒInstance10çš„å¤‡ä»½æ ¹äº¤æ¢æœºï¼›æ ¹äº¤æ¢æœºSTPä¼˜å…ˆçº§ä¸º0ï¼Œå¤‡ä»½æ ¹äº¤æ¢æœºSTPä¼˜å…ˆçº§ä¸º4096ã€‚å…³é—­äº¤æ¢æœºä¹‹é—´ä¸‰å±‚äº’è”æ¥å£çš„STPã€‚\nSW1:\nspanning-tree mst configuration name SKILLS revision-level 1 instance 0 vlan 1-59;61-69;71-79;81-89;91-4094 instance 10 vlan 60;70 instance 20 vlan 80;90 exit ! spanning-tree spanning-tree mst 0 priority 0 spanning-tree mst 10 priority 0 spanning-tree mst 20 priority 4096 Interface Ethernet1/0/22 no spanning-tree Interface Ethernet1/0/26 no spanning-tree SW2:\nspanning-tree mst configuration name SKILLS revision-level 1 instance 0 vlan 1-59;61-69;71-79;81-89;91-4094 instance 10 vlan 60;70 instance 20 vlan 80;90 exit ! spanning-tree spanning-tree mst 0 priority 4096 spanning-tree mst 10 priority 4096 spanning-tree mst 20 priority 0 Interface Ethernet1/0/22 no spanning-tree Interface Ethernet1/0/26 no spanning-tree SW3:\nspanning-tree mst configuration name SKILLS revision-level 1 instance 0 vlan 1-59;61-69;71-79;81-89;91-4094 instance 10 vlan 60;70 instance 20 vlan 80;90 exit ! spanning-tree Interface Ethernet1/0/21 no spanning-tree Interface Ethernet1/0/22 no spanning-tree é…ç½®ç»“æœï¼š\nSW3(config)#show spanning-tree *********************************** Process 0 *********************************** -- MSTP Bridge Config Info -- Standard : IEEE 802.1s Bridge MAC : 00:03:0f:e0:f9:b9 Bridge Times : Max Age 20, Hello Time 2, Forward Delay 15 Force Version: 3 ########################### Instance 0 ########################### Self Bridge Id : 32768.00:03:0f:e0:f9:b9 Root Id : 0.00:03:0f:e0:f9:b3 Ext.RootPathCost : 0 Region Root Id : 0.00:03:0f:e0:f9:b3 Int.RootPathCost : 20000 Root Port ID : 128.23 Current port list in Instance 0: Ethernet1/0/11 Ethernet1/0/12 Ethernet1/0/15 Ethernet1/0/17 Ethernet1/0/18 Ethernet1/0/23 Ethernet1/0/24 (Total 7) PortName ID ExtRPC IntRPC State Role DsgBridge DsgPort -------------- ------------ --------- --------- --- ---- ------------------ ------------ Ethernet1/0/11 128.00011 0 20000 FWD DSGN 32768.00030fe0f9b9 128.00011 Ethernet1/0/12 128.00012 0 20000 FWD DSGN 32768.00030fe0f9b9 128.00012 Ethernet1/0/15 128.00015 0 20000 FWD DSGN 32768.00030fe0f9b9 128.00015 Ethernet1/0/17 128.00017 0 20000 FWD DSGN 32768.00030fe0f9b9 128.00017 Ethernet1/0/18 128.00018 0 20000 FWD DSGN 32768.00030fe0f9b9 128.00018 Ethernet1/0/23 128.00023 0 0 FWD ROOT 0.00030fe0f9b3 128.00023 Ethernet1/0/24 128.00024 0 20000 BLK ALTR 4096.00030fe0f9b6 128.00023 ########################### Instance 10 ########################### Self Bridge Id : 32768.00:03:0f:e0:f9:b9 Region Root Id : 0.00:03:0f:e0:f9:b3 Int.RootPathCost : 20000 Root Port ID : 128.23 Current port list in Instance 10: Ethernet1/0/23 Ethernet1/0/24 (Total 2) PortName ID IntRPC State Role DsgBridge DsgPort --------------- ------------ --------- --- ---- ------------------ ---------- Ethernet1/0/23 128.00023 0 FWD ROOT 0.00030fe0f9b3 128.00023 Ethernet1/0/24 128.00024 20000 BLK ALTR 4096.00030fe0f9b6 128.00023 ########################### Instance 20 ########################### Self Bridge Id : 32768.00:03:0f:e0:f9:b9 Region Root Id : 0.00:03:0f:e0:f9:b6 Int.RootPathCost : 20000 Root Port ID : 128.24 Current port list in Instance 20: Ethernet1/0/23 Ethernet1/0/24 (Total 2) PortName ID IntRPC State Role DsgBridge DsgPort --------------- ------------ --------- --- ---- ------------------ ---------- Ethernet1/0/23 128.00023 20000 BLK ALTR 4096.00030fe0f9b3 128.00023 Ethernet1/0/24 128.00024 0 FWD ROOT 0.00030fe0f9b6 128.00023 2ã€é“¾è·¯èšåˆLACP SW1 å’Œ SW2 ä¹‹é—´åˆ©ç”¨ä¸‰æ¡è£¸å…‰ç¼†å®ç°äº’é€šï¼Œå…¶ä¸­ä¸€æ¡è£¸å…‰ç¼†æ‰¿è½½ä¸‰å±‚ IPä¸šåŠ¡ã€ä¸€æ¡è£¸å…‰ç¼†æ‰¿è½½ VPN ä¸šåŠ¡ã€ä¸€æ¡è£¸å…‰ç¼†æ‰¿è½½äºŒå±‚ä¸šåŠ¡ã€‚ç”¨ç›¸å…³æŠ€æœ¯åˆ†åˆ«å®ç°è´¢åŠ¡ 1 æ®µã€è´¢åŠ¡ 2 æ®µä¸šåŠ¡è·¯ç”±è¡¨ä¸å…¶å®ƒä¸šåŠ¡è·¯ç”±è¡¨éš”ç¦»ï¼Œè´¢åŠ¡ä¸šåŠ¡ VPN å®ä¾‹åç§°ä¸º CWã€‚\nSW1ï¼š\nSW1#sho ip vrf VRF CW, FIB ID 1 Router ID: 10.10.255.2 (automatic) Interfaces: Vlan40 Vlan1027 ! VRF CW; (id=1); RIP is not enabled Name Interfaces CW Vlan40 Vlan1027 Name Default RD Interfaces CW Vlan40 Vlan1027 SW2ï¼š\nSW2#sho ip vrf VRF CW, FIB ID 1 Router ID: 10.10.255.2 (automatic) Interfaces: Vlan40 Vlan1027 ! VRF CW; (id=1); RIP is not enabled Name Interfaces CW Vlan40 Vlan1027 Name Default RD Interfaces CW Vlan40 Vlan1027 æ‰¿è½½äºŒå±‚ä¸šåŠ¡çš„åªæœ‰ä¸€æ¡è£¸å…‰ç¼†é€šé“ï¼Œé…ç½®ç›¸å…³æŠ€æœ¯ï¼Œæ–¹ä¾¿åç»­é“¾è·¯æ‰©å®¹ä¸å†—ä½™å¤‡ä»½ï¼Œç¼–å·ä¸º 1ï¼Œç”¨ LACP åè®®ï¼ŒSW1 ä¸º activeï¼ŒSW2 ä¸º activeï¼›é‡‡ç”¨æºã€ç›®çš„ IP è¿›è¡Œå®ç°æµé‡è´Ÿè½½åˆ†æ‹…ã€‚\nSW1ï¼š\nSW1(config)#port-group 1 SW1(config)#int e1/0/25;28 SW1(config-if-port-range)#port-group 1 mode active SW1(config-if-port-range)#exit SW1(config)#load-balance dst-src-ip é…ç½®ç»“æœï¼š\nSW1#sho port-group 1 detail Flags: A -- LACP_Activity, B -- LACP_timeout, C -- Aggregation, D -- Synchronization, E -- Collecting, F -- Distributing, G -- Defaulted, H -- Expired Port-group number: 1, Mode: active, Load-balance: dst-src-ip Port-group detail information: System ID: 0x8000,00-03-0f-e0-f9-b3 Local: Port Status Priority Oper-Key Flag ----------------------------------------------------------- Ethernet1/0/25 Unselected 32768 1 {ACG} Ethernet1/0/28 Selected 32768 1 {ACDEF} Remote: Actor Partner Priority Oper-Key SystemID Flag -------------------------------------------------------------------------------- Ethernet1/0/28 28 32768 1 0x8000,00-03-0f-e0-f9-b6 {ACDEF} SW2ï¼š\nSW2(config)#port-group 1 SW1(config)#int e1/0/25;28 SW1(config-if-port-range)#port-group 1 mode active SW1(config-if-port-range)#exit SW2(config)#load-balance dst-src-ip é…ç½®ç»“æœï¼š\nSW2#sho port-group 1 detail Flags: A -- LACP_Activity, B -- LACP_timeout, C -- Aggregation, D -- Synchronization, E -- Collecting, F -- Distributing, G -- Defaulted, H -- Expired Port-group number: 1, Mode: active, Load-balance: dst-src-ip Port-group detail information: System ID: 0x8000,00-03-0f-e0-f9-b6 Local: Port Status Priority Oper-Key Flag ----------------------------------------------------------- Ethernet1/0/25 Unselected 32768 1 {ACG} Ethernet1/0/28 Selected 32768 1 {ACDEF} Remote: Actor Partner Priority Oper-Key SystemID Flag -------------------------------------------------------------------------------- Ethernet1/0/28 28 32768 1 0x8000,00-03-0f-e0-f9-b3 {ACDEF} 3ã€è·¯ç”±è¡¨éš”ç¦»VPN å°† SW3 æ¨¡æ‹Ÿä¸º Internet äº¤æ¢æœºï¼Œå®ç°ä¸é›†å›¢å…¶å®ƒä¸šåŠ¡è·¯ç”±è¡¨éš”ç¦»ï¼ŒInternet è·¯ç”±è¡¨ VPN å®ä¾‹åç§°ä¸º Internetã€‚å°† SW3 æ¨¡æ‹ŸåŠäº‹å¤„äº¤æ¢æœºï¼Œå®ç°ä¸é›†å›¢å…¶å®ƒä¸šåŠ¡è·¯ç”±è¡¨éš”ç¦»ï¼ŒåŠäº‹å¤„è·¯ç”±è¡¨ VPN å®ä¾‹åç§°ä¸º Guangdongã€‚\nip vrf Guangdong ! ip vrf Internet ! interface Loopback2 ip vrf forwarding Guangdong ipv6 address 2001:10:10:3::2/128 ip address 10.10.3.2 255.255.255.255 ! interface Loopback3 ip vrf forwarding Internet ipv6 address 2001:200:200:3::3/128 ip address 200.200.3.3 255.255.255.255 ! interface Vlan110 ip vrf forwarding Guangdong ipv6 address 2001:10:16:110::1/64 ip address 10.16.110.1 255.255.255.0 ! interface Vlan120 ip vrf forwarding Guangdong ipv6 address 2001:10:16:120::1/64 ip address 10.16.120.1 255.255.255.0 ! interface Vlan1015 ip vrf forwarding Guangdong ip address 10.10.255.46 255.255.255.252 ! interface Vlan1017 ip vrf forwarding Internet ip address 200.200.200.1 255.255.255.252 ! interface Vlan1018 ip vrf forwarding Internet ip address 200.200.200.5 255.255.255.252 ! é…ç½®ç»“æœï¼š\nSW3#sho ip vrf VRF Guangdong, FIB ID 1 Router ID: 10.10.3.2 (loopback) Interfaces: Vlan110 Vlan120 Vlan1015 Loopback2 ! VRF Internet, FIB ID 2 Router ID: 200.200.3.3 (loopback) Interfaces: Vlan1017 Vlan1018 Loopback3 ! VRF Guangdong; (id=1); RIP is not enabled VRF Internet; (id=2); RIP is not enabled Name Interfaces Guangdong Vlan110 Vlan120 Vlan1015 Loopback2 Internet Vlan1017 Vlan1018 Loopback3 Name Default RD Interfaces Guangdong Vlan110 Vlan120 Vlan1015 Loopback2 Internet Vlan1017 Vlan1018 Loopback3 4ã€ç«¯å£å®‰å…¨ SW1 æ³•åŠ¡ç‰©ç†æ¥å£é™åˆ¶æ”¶å‘æ•°æ®å ç”¨çš„å¸¦å®½å‡ä¸º 1000Mbpsï¼Œé™åˆ¶æ‰€æœ‰æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡ä¸º 1000packets/sï¼Œå¦‚æœè¶…è¿‡äº†é…ç½®äº¤æ¢æœºç«¯å£çš„æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡åˆ™å…³é—­æ­¤ç«¯å£ï¼Œ1 åˆ†é’Ÿåæ¢å¤æ­¤ç«¯å£ï¼›å¯ç”¨ç«¯å£å®‰å…¨åŠŸèƒ½ï¼Œæœ€å¤§å®‰å…¨ MAC åœ°å€æ•°ä¸º 20ï¼Œå½“è¶…è¿‡è®¾å®š MAC åœ°å€æ•°é‡çš„æœ€å¤§å€¼ï¼Œä¸å­¦ä¹ æ–°çš„ MACã€ä¸¢å¼ƒæ•°æ®åŒ…ã€å‘nmp trapã€åŒæ—¶åœ¨ syslog æ—¥å¿—ä¸­è®°å½•ï¼Œç«¯å£çš„è€åŒ–å®šæ—¶å™¨åˆ°æœŸåï¼Œåœ¨è€åŒ–å‘¨æœŸä¸­æ²¡æœ‰æµé‡çš„éƒ¨åˆ†è¡¨é¡¹è€åŒ–ï¼Œæœ‰æµé‡çš„éƒ¨åˆ†ä¾æ—§ä¿ç•™ï¼Œæ¢å¤æ—¶é—´ä¸º 10 åˆ†é’Ÿï¼›ç¦æ­¢é‡‡ç”¨è®¿æ§åˆ¶åˆ—è¡¨ï¼Œåªå…è®¸ IP ä¸»æœºä½ä¸º 20-50 çš„æ•°æ®åŒ…è¿›è¡Œè½¬å‘ï¼›ç¦æ­¢é…ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼Œå®ç°ç«¯å£é—´äºŒå±‚æµé‡æ— æ³•äº’é€šï¼Œç»„åç§° FWã€‚\nSW1(config)#inter e1/0/3 SW1(config-if-ethernet1/0/3)#rate-violation all 1000 SW1(config-if-ethernet1/0/3)#bandwidth control 1000000 both SW1(config-if-ethernet1/0/3)#rate-violation control shutdown recovery 60 SW1(config-if-ethernet1/0/3)#switchport port-security Mac learning is not in cpu-control mode, please enable it to make port-security work well! SW1(config-if-ethernet1/0/3)#switchport port-security maximum 20 SW1(config-if-ethernet1/0/3)#exit SW1(config)#mac-address-learning cpu-control SW1(config)#inter e1/0/3 SW1(config-if-ethernet1/0/3)#switchport port-security violation restrict recovery 600 SW1(config-if-ethernet1/0/3)#switchport port-security aging type inactivity SW1(config-if-ethernet1/0/3)#exit SW1(config)#am enable SW1(config)#inter e1/0/3 SW1(config-if-ethernet1/0/3)#am port SW1(config-if-ethernet1/0/3)#am ip-pool 10.10.120.20 31 SW1(config-if-ethernet1/0/3)#exit SW1(config)#isolate-port group FW switchport interface e1/0/3 SW1(config)#isolate-port apply l2 é…ç½®ç»“æœï¼š\nSW1(config-if-ethernet1/0/3)#sho run c bandwidth control 1000000 both rate-violation all 1000 rate-violation control shutdown recovery 60 switchport access vlan 30 switchport port-security switchport port-security maximum 20 switchport port-security violation restrict recovery 600 switchport port-security aging type inactivity am port am ip-pool 10.10.120.20 31 SW1#sho isolate-port group FW Isolate-port group FW The isolate-port Ethernet1/0/3 SW1 æ³•åŠ¡ç‰©ç†æ¥å£é™åˆ¶æ”¶å‘æ•°æ®å ç”¨çš„å¸¦å®½åˆ†åˆ«ä¸º 100Mbpsã€90Mbps,é™åˆ¶æ‰€æœ‰æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡ä¸º100packets/s,å¦‚æœè¶…è¿‡äº†é…ç½®äº¤æ¢æœºç«¯å£çš„æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡åˆ™å…³é—­æ­¤ç«¯å£,10 åˆ†é’Ÿåæ¢å¤æ­¤ç«¯å£;å¯ç”¨ç«¯å£å®‰å…¨åŠŸèƒ½,æœ€å¤§å®‰å…¨ MAC åœ°å€æ•°ä¸º 10,å½“è¶…è¿‡è®¾å®š MAC åœ°å€æ•°é‡çš„æœ€å¤§å€¼,ä¸å­¦ä¹ æ–°çš„ MACã€ä¸¢å¼ƒæ•°æ®åŒ…ã€å‘nmp trapã€åŒæ—¶åœ¨ syslog æ—¥å¿—ä¸­è®°å½•,ç«¯å£çš„è€åŒ–å®šæ—¶å™¨åˆ°æœŸå,åœ¨è€åŒ–å‘¨æœŸä¸­æ²¡æœ‰æµé‡çš„éƒ¨åˆ†è¡¨é¡¹è€åŒ–,æœ‰æµé‡çš„éƒ¨åˆ†ä¾æ—§ä¿ç•™,æ¢å¤æ—¶é—´ä¸º 10 åˆ†é’Ÿ;ç¦æ­¢é‡‡ç”¨è®¿æ§åˆ¶åˆ—è¡¨,åªå…è®¸ IP ä¸»æœºä½ä¸º 20-50 çš„æ•°æ®åŒ…è¿›è¡Œè½¬å‘;ç¦æ­¢é…ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨,å®ç°ç«¯å£é—´äºŒå±‚æµé‡æ— æ³•äº’é€š,ç»„åç§° FWã€‚\nbandwidth control 90000 transmit bandwidth control 100000 receive rate-violation all 100 rate-violation control shutdown recovery 600 switchport access vlan 30 switchport port-security switchport port-security maximum 10 switchport port-security violation restrict recovery 600 switchport port-security aging type inactivity am port am ip-pool 10.1.13.20 31 SW1(config)#isolate-port group FW switchport interface e1/0/3 SW1(config)#isolate-port apply l2 5ã€å¼€å¯æ—¥å¿—è®°å½•\u0026ä¿æŠ¤åŠŸèƒ½ å¼€å¯ SW1æ—¥å¿—è®°å½•åŠŸèƒ½å’Œä¿æŠ¤åŠŸèƒ½ï¼Œé‡‡æ ·å‘¨æœŸ5sä¸€æ¬¡ï¼Œæ¢å¤å‘¨æœŸä¸º100sï¼Œä»è€Œä¿éšœ CPU ç¨³å®šè¿è¡Œã€‚\nSW1(config)#cpu-protect log enable SW1(config)#cpu-protect enable SW1(config)#cpu-protect interval 5 SW1(config)#cpu-protect recovery-time 100 é…ç½®ç»“æœï¼š\nSW1#sho cpu-protect running-config Cpu-Protect Globle: enable Cpu-Protect trap : disable Cpu-Protect Log: enable Cpu-Protect Interval: 5 Cpu-Protect Recovery-Time: 100 Cap-Num Ip-Num Mac-Num Protocal-Num 0 0 0 0 Stream Threshould Limit-Speed Action IP 300 150 Speed-Limit DHCP 150 80 Speed-Limit IGMP 150 80 Speed-Limit ARP 300 150 Speed-Limit ICMP 80 50 Speed-Limit PER-IP 400 200 Speed-Limit PER-MAC 400 200 Speed-Limit 6ã€SNMP .SW1 é…ç½® SNMPï¼Œå¼•æ“ id åˆ†åˆ«ä¸º 1ï¼›åˆ›å»ºç»„ GROUP2022ï¼Œé‡‡ç”¨æœ€é«˜å®‰å…¨çº§åˆ«ï¼Œé…ç½®ç»„çš„è¯»ã€å†™è§†å›¾åˆ†åˆ«ä¸ºï¼šSKILLS_Rã€SKILLS_Wï¼›åˆ›å»ºè®¤è¯ç”¨æˆ·ä¸ºSER2022ï¼Œé‡‡ç”¨ aes ç®—æ³•è¿›è¡ŒåŠ å¯†ï¼Œå¯†é’¥ä¸º Pass-1234ï¼Œå“ˆå¸Œç®—æ³•ä¸º shaï¼Œå¯†é’¥ä¸º Pass-1234ï¼›å½“è®¾å¤‡æœ‰å¼‚å¸¸æ—¶ï¼Œéœ€è¦ç”¨æœ¬åœ°çš„ç¯å›åœ°å€ loopback1 å‘é€ v3 Trap æ¶ˆæ¯è‡³é›†å›¢ç½‘ç®¡æœåŠ¡å™¨ 10.10.11.99ã€2001:10:10:11::99ï¼Œé‡‡ç”¨æœ€é«˜å®‰å…¨çº§åˆ«ï¼›\nsnmp-server enable snmp-server securityip 10.1.15.120 snmp-server securityip 2001:10:1:15::120 snmp-server trap-source 10.1.1.1 snmp-server trap-source 2001:10:1:1::1 snmp-server engineid 1000 snmp-server user UserSkills GroupSkills authPriv aes Key-1122 auth sha Key-1122 snmp-server group GroupSkills authpriv read Skills_R write Skills_W snmp-server host 10.1.1.1 v3 authpriv UserSkills snmp-server host 2001:10:1:1::1 v3 authpriv UserSkills snmp-server enable traps é…ç½®ç»“æœï¼š\nSW1(config)#sho snmp engineid SNMP engineID:1 Engine Boots is:1 SW1(config)#sho snmp group Group Name:GROUP2022 Security Level:AuthPriv Read View:SKILLS_R Write View:SKILLS_W Notify View: SW1(config)#sho snmp status System Name : DC YunKe Networks Co.,Ltd. System Contact : 400-810-9119 System Location : China Trap enable RMON enable Community Information: V1/V2c Trap Host Information: V3 Trap Host Information: Trap-rec-address: 2001:10:10:11::99 User-name :USER2022 Security Level:AuthPriv Trap-rec-address: 10.10.11.99 User-name :USER2022 Security Level:AuthPriv Security IP is Enabled. Security IP: 10.10.11.99 Security IP: 2001:10:10:11::99 SW1(config)#sho snmp user User name: USER2022 Engine ID: 0x31 Auth Protocol:SHA Priv Protocol:AES-CFB-128 Row status:active å½“æ³•åŠ¡éƒ¨é—¨å¯¹åº”çš„ç”¨æˆ·æ¥å£å‘ç”Ÿ UP DOWN äº‹ä»¶æ—¶ï¼Œç¦æ­¢å‘é€ trap æ¶ˆæ¯è‡³ä¸Šè¿°é›†å›¢ç½‘ç®¡æœåŠ¡å™¨ã€‚\nSW1(config-if-ethernet1/0/3)#sho run c no switchport updown notification enable 7ã€äº’è”æµé‡é•œåƒ å°† W1 ä¸ FW1 äº’è¿æµé‡é•œåƒåˆ° SW1 E1/0/1ï¼Œä¼šè¯åˆ—è¡¨ä¸º 1ã€‚\nmonitor session 1 source interface Ethernet1/0/21 tx monitor session 1 source interface Ethernet1/0/21 rx monitor session 1 destination interface Ethernet1/0/1 é…ç½®ç»“æœï¼š\nSW1(config)#sho monitor monitor session 1: Destination Ethernet1/0/1 Card: slot 1 source ports: RX port: 21 TX port: 21 -------------------------------------------------------- No monitor in session 2 -------------------------------------------------------- No monitor in session 3 -------------------------------------------------------- No monitor in session 4 -------------------------------------------------------- No monitor in session 5 -------------------------------------------------------- No monitor in session 6 -------------------------------------------------------- No monitor in session 7 -------------------------------------------------------- 8ã€ULDP SW1 å’Œ SW2 E1/0/21-28 å¯ç”¨å•å‘é“¾è·¯æ•…éšœæ£€æµ‹ï¼Œå½“å‘ç”Ÿè¯¥æ•…éšœæ—¶ï¼Œç«¯å£æ ‡è®°ä¸º errdisable çŠ¶æ€ï¼Œè‡ªåŠ¨å…³é—­ç«¯å£ï¼Œç»è¿‡ 1 åˆ†é’Ÿåï¼Œç«¯å£è‡ªåŠ¨é‡å¯ï¼›å‘é€ã€ã€\nHello æŠ¥æ–‡æ—¶é—´é—´éš”ä¸º 15sï¼›\nSW1ï¼š\nSW1(config)#uldp enable SW1(config)#uldp aggressive-mode SW1(config)#inter e1/0/21-28 SW1(config-if-port-range)#uldp enable SW1(config-if-port-range)#uldp aggressive-mode SW1(config)#uldp recovery-time 60 SW1(config)#uldp hello-interval 15 é…ç½®ç»“æœï¼š\nSW1(config)#sho uldp uldp enable uldp hello interval is 15 uldp recovery time is 60 uldp shut down mode is AUTO uldp global work mode is AGGRESSIVE the total number of the port is 8 --------------------------------------------------------------------------- PortName PhyLink LineProto WorkMode PortState NeighborNum --------------------------------------------------------------------------- Ethernet1/0/21 UP UP AGGRESSIVE BIDIRECTION 0 Ethernet1/0/22 UP UP AGGRESSIVE BIDIRECTION 0 Ethernet1/0/23 UP UP AGGRESSIVE BIDIRECTION 0 Ethernet1/0/24 UP DOWN AGGRESSIVE INACTIVE 0 Ethernet1/0/25 UP DOWN AGGRESSIVE INACTIVE 0 Ethernet1/0/26 UP UP AGGRESSIVE BIDIRECTION 1 Ethernet1/0/27 UP UP AGGRESSIVE BIDIRECTION 1 Ethernet1/0/28 UP UP AGGRESSIVE BIDIRECTION 1 --------------------------------------------------------------------------- SW2ï¼š\nSW2(config)#uldp enable SW2(config)#uldp aggressive-mode SW2(config)#inter e1/0/21-28 SW2(config-if-port-range)#uldp enable SW2(config-if-port-range)#uldp aggressive-mode SW2(config)#uldp recovery-time 60 SW2(config)#uldp hello-interval 15 é…ç½®ç»“æœï¼š\nSW2(config)#sho uldp uldp enable uldp hello interval is 15 uldp recovery time is 60 uldp shut down mode is AUTO uldp global work mode is AGGRESSIVE the total number of the port is 8 --------------------------------------------------------------------------- PortName PhyLink LineProto WorkMode PortState NeighborNum --------------------------------------------------------------------------- Ethernet1/0/21 UP UP AGGRESSIVE BIDIRECTION 0 Ethernet1/0/22 UP UP AGGRESSIVE BIDIRECTION 0 Ethernet1/0/23 UP UP AGGRESSIVE BIDIRECTION 0 Ethernet1/0/24 UP DOWN AGGRESSIVE INACTIVE 0 Ethernet1/0/25 UP DOWN AGGRESSIVE INACTIVE 0 Ethernet1/0/26 UP UP AGGRESSIVE BIDIRECTION 1 Ethernet1/0/27 UP UP AGGRESSIVE BIDIRECTION 1 Ethernet1/0/28 UP UP AGGRESSIVE BIDIRECTION 1 --------------------------------------------------------------------------- 9ã€LLDP\nSW1å’ŒSW2æ‰€æœ‰ç«¯å£å¯ç”¨é“¾è·¯å±‚å‘ç°åè®®ï¼Œæ›´æ–°æŠ¥æ–‡å‘é€æ—¶é—´é—´éš”ä¸º20sï¼Œè€åŒ–æ—¶é—´ä¹˜æ³•å™¨å€¼ä¸º 5ï¼ŒTrap æŠ¥æ–‡å‘é€é—´éš”ä¸º 10sï¼Œé…ç½®ä¸‰æ¡è£¸å…‰ç¼†ç«¯å£ä½¿èƒ½Trap åŠŸèƒ½ã€‚\nSW1ï¼š\n! lldp enable lldp msgTxHold 5 lldp tx-interval 10 ! Interface Ethernet1/0/26 lldp trap enable ! Interface Ethernet1/0/27 lldp trap enable ! Interface Ethernet1/0/28 lldp trap enable ! é…ç½®ç»“æœï¼š\nSW1#sho lldp -----LLDP GLOBAL INFORMATIONS----- LLDP has been enabled globally. LLDP enabled port : Ethernet1/0/21 Ethernet1/0/22 Ethernet1/0/23 Ethernet1/0/26 Ethernet1/0/27 Ethernet1/0/28 LLDP interval :10 LLDP txTTL :50 LLDP NotificationInterval :5 LLDP txDelay :2 LLDP-MED FastStart Repeat Count :4 -------------END------------------ SW1(config)#inter e1/0/26-28 SW1(config-if-port-range)#sho run c Interface Ethernet1/0/26 lldp trap enable ! Interface Ethernet1/0/27 lldp trap enable ! Interface Ethernet1/0/28 lldp trap enable SW2ï¼š\n! lldp enable lldp msgTxHold 5 lldp tx-interval 10 ! Interface Ethernet1/0/26 lldp trap enable ! Interface Ethernet1/0/27 lldp trap enable ! Interface Ethernet1/0/28 lldp trap enable ! é…ç½®ç»“æœï¼š\nSW2#sho lldp -----LLDP GLOBAL INFORMATIONS----- LLDP has been enabled globally. LLDP enabled port : Ethernet1/0/21 Ethernet1/0/22 Ethernet1/0/23 Ethernet1/0/26 Ethernet1/0/27 Ethernet1/0/28 LLDP interval :10 LLDP txTTL :50 LLDP NotificationInterval :5 LLDP txDelay :2 LLDP-MED FastStart Repeat Count :4 -------------END------------------ SW2(config)#inter e1/0/26-28 SW2(config-if-port-range)#sho run c Interface Ethernet1/0/26 lldp trap enable ! Interface Ethernet1/0/27 lldp trap enable ! Interface Ethernet1/0/28 lldp trap enable äºŒã€è·¯ç”±é…ç½® 1ã€SSHæœåŠ¡ å¯ç”¨æ‰€æœ‰è®¾å¤‡çš„ ssh æœåŠ¡ï¼Œé˜²ç«å¢™ç”¨æˆ·å adminï¼Œæ˜æ–‡å¯†ç  Pass-1234ï¼Œå…¶ä½™è®¾å¤‡ç”¨æˆ·åå’Œæ˜æ–‡å¯†ç å‡ä¸º adminã€‚\näº¤æ¢æœº\u0026ACï¼š\nSW(config)#ssh-server enable SW(config)#username admin password 0 admin è·¯ç”±å™¨ï¼š\nRT1_config#username admin password 0 admin RT1_config#aaa authentication login default local RT1_config#aaa authentication enable default none RT1_config#ip sshd enable é˜²ç«å¢™ï¼šin\nåœ¨æ‰€éœ€ç«¯å£ä¸Šå¼€å¯SSHæœåŠ¡\nä¾‹å¦‚ï¼š FW1(config)# interface e0/0 FW1(config-if-eth0/0)# manage ssh 2ã€é…ç½®æ—¶åŒº é…ç½®æ‰€æœ‰è®¾å¤‡çš„æ—¶åŒºä¸º GMT+08:00ï¼Œè°ƒæ•´ SW1 æ—¶é—´ä¸ºå®é™…æ—¶é—´ï¼ŒSW1 é…ç½®ä¸º ntp serverï¼Œå…¶ä»–è®¾å¤‡ç”¨ SW1 loopback1 ipv4 åœ°å€ä½œä¸º ntp server åœ°å€ï¼Œntp client è¯·æ±‚æŠ¥æ–‡æ—¶é—´é—´éš” 1 åˆ†é’Ÿã€‚\nSW1ï¼š\nSW1#clock set 14:41:30 2023.4.24 SW1#config SW1(config)#clock timezone GMT add 8 0 SW1(config)#ntp enable SW1(config)#ntp-service refclock-master 1 SW1(config)#ntp server 10.10.1.1 SW1(config)#ntp syn-interval 60 SW2ã€SW3ã€ACï¼š\nclock timezone GMT add 8 0 ntp enable ntp syn-interval 60 ntp server 10.10.1.1 è·¯ç”±å™¨ï¼š\ntime-zone GMT 8 0 ntp query-interval 60 ntp server 10.10.1.1 é˜²ç«å¢™ï¼š\nFW1(config)# clock zone GMT 8 0 FW1(config)# ntp enable FW1(config)# ntp server 10.10.1.1 FW1(config)# ntp query-interval 1 é…ç½®ç»“æœï¼š\nSW1(config)#sho clock Current time is Mon Apr 24 15:13:30 2023 [GMT+08:00] SW1(config)#sho ntp status ntp clock status: synchronized Clock stratum:4 Reference clock server:10.10.1.1 Clock offset:0.0 s Root delay:0.000 ms Root dispersion:0.000 ms Reference time:Mon Apr 24 07:06:3.203 2023 Syn-interval:60s 3ã€VRRP åˆ©ç”¨ vrrpv2 å’Œ vrrpv3 æŠ€æœ¯å®ç° vlan60ã€vlan70ã€vlan80ã€vlan90 ç½‘å…³å†—ä½™å¤‡ä»½ï¼Œvrrp id ä¸ vlan id ç›¸åŒã€‚vrrpv2 vip ä¸º 10.10.vlanid.9ï¼ˆå¦‚ vlan60çš„ vrrpv2 vip ä¸º 10.10.60.9ï¼‰ï¼Œvrrpv3 vip ä¸º FE80:vlanid::9ï¼ˆå¦‚ vlan60 çš„vrrpv3 vip ä¸º FE80:60::9ï¼‰ã€‚é…ç½® SW1 ä¸º vlan60ã€vlan70 çš„ Masterï¼ŒSW2 ä¸ºvlan80ã€vlan90 çš„ asterã€‚è¦æ±‚ vrrp ç»„ä¸­é«˜ä¼˜å…ˆçº§ä¸º 120ï¼Œä½ä¼˜å…ˆçº§ä¸ºé»˜è®¤å€¼ï¼ŒæŠ¢å æ¨¡å¼ä¸ºé»˜è®¤å€¼ï¼Œvrrpv2 å’Œ vrrpv3 å‘é€é€šå‘ŠæŠ¥æ–‡æ—¶é—´é—´éš”ä¸ºé»˜è®¤å€¼ã€‚å½“ SW1æˆ– SW2 ä¸Šè”é“¾è·¯å‘ç”Ÿæ•…éšœï¼ŒMaster ä¼˜å…ˆçº§é™ä½ 50ã€‚\nVRRPv2 SW1ï¼š\n! router vrrp 60 virtual-ip 10.10.60.9 interface Vlan60 circuit-failover Vlan1021 50 priority 120 enable ! router vrrp 70 virtual-ip 10.10.70.9 interface Vlan70 circuit-failover Vlan1021 50 priority 120 enable ! router vrrp 80 virtual-ip 10.10.80.9 interface Vlan80 enable ! router vrrp 90 virtual-ip 10.10.90.9 interface Vlan90 enable ! é…ç½®ç»“æœï¼š\nSW1(config)#sho vrrp VrId 60 State is Master Virtual IP is 10.10.60.9 (Not IP owner) Interface is Vlan60 Configured priority is 120, Current priority is 120 Advertisement interval is 1 sec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP VrId 70 State is Master Virtual IP is 10.10.70.9 (Not IP owner) Interface is Vlan70 Configured priority is 120, Current priority is 120 Advertisement interval is 1 sec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP VrId 80 State is Backup Virtual IP is 10.10.80.9 (Not IP owner) Interface is Vlan80 Priority is 100(config priority is 100) Advertisement interval is 1 sec Preempt mode is TRUE VrId 90 State is Backup Virtual IP is 10.10.90.9 (Not IP owner) Interface is Vlan90 Priority is 100(config priority is 100) Advertisement interval is 1 sec Preempt mode is TRUE SW2ï¼š\n! router vrrp 60 virtual-ip 10.10.60.9 interface Vlan60 enable ! router vrrp 70 virtual-ip 10.10.70.9 interface Vlan70 enable ! router vrrp 80 virtual-ip 10.10.80.9 interface Vlan80 circuit-failover Vlan1021 50 priority 120 enable ! router vrrp 90 virtual-ip 10.10.90.9 interface Vlan90 circuit-failover Vlan1021 50 priority 120 enable ! é…ç½®ç»“æœï¼š\nSW2(config)#sho vrrp VrId 60 State is Backup Virtual IP is 10.10.60.9 (Not IP owner) Interface is Vlan60 Priority is 100(config priority is 100) Advertisement interval is 1 sec Preempt mode is TRUE VrId 70 State is Backup Virtual IP is 10.10.70.9 (Not IP owner) Interface is Vlan70 Priority is 100(config priority is 100) Advertisement interval is 1 sec Preempt mode is TRUE VrId 80 State is Master Virtual IP is 10.10.80.9 (Not IP owner) Interface is Vlan80 Configured priority is 120, Current priority is 120 Advertisement interval is 1 sec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP VrId 90 State is Master Virtual IP is 10.10.90.9 (Not IP owner) Interface is Vlan90 Configured priority is 120, Current priority is 120 Advertisement interval is 1 sec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP é…ç½®ç»“æœï¼š\nSW2(config)#sho ipv6 vrrp VrId 60 State is Backup Virtual IPv6 is fe80:60::9 (Not IPv6 owner) Interface is Vlan60 Priority is 100(config priority is 100) Advertisement interval is 100 centisec Preempt mode is TRUE VrId 70 State is Backup Virtual IPv6 is fe80:70::9 (Not IPv6 owner) Interface is Vlan70 Priority is 100(config priority is 100) Advertisement interval is 100 centisec Preempt mode is TRUE VrId 80 State is Master Virtual IPv6 is fe80:80::9 (Not IPv6 owner) Interface is Vlan80 Configured priority is 120, Current priority is 120 Advertisement interval is 100 centisec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP VrId 90 State is Master Virtual IPv6 is fe80:90::9 (Not IPv6 owner) Interface is Vlan90 Configured priority is 120, Current priority is 120 Advertisement interval is 100 centisec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP VRRPv3 SW1:\n! router ipv6 vrrp 60 virtual-ipv6 fe80:60::9 interface Vlan60 circuit-failover Vlan1021 50 priority 120 enable ! router ipv6 vrrp 70 virtual-ipv6 fe80:70::9 interface Vlan70 circuit-failover Vlan1021 50 priority 120 enable ! router ipv6 vrrp 80 virtual-ipv6 fe80:80::9 interface Vlan80 enable ! router ipv6 vrrp 90 virtual-ipv6 fe80:90::9 interface Vlan90 enable ! SW2:\n! router ipv6 vrrp 60 virtual-ipv6 fe80:60::9 interface Vlan60 enable ! router ipv6 vrrp 70 virtual-ipv6 fe80:70::9 interface Vlan70 enable ! router ipv6 vrrp 80 virtual-ipv6 fe80:80::9 interface Vlan80 circuit-failover Vlan1021 50 priority 120 enable ! router ipv6 vrrp 90 virtual-ipv6 fe80:90::9 interface Vlan90 circuit-failover Vlan1021 50 priority 120 enable ! é…ç½®ç»“æœï¼š\nSW1(config)#sho ipv6 vrrp VrId 60 State is Master Virtual IPv6 is fe80:60::9 (Not IPv6 owner) Interface is Vlan60 Configured priority is 120, Current priority is 120 Advertisement interval is 100 centisec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP VrId 70 State is Master Virtual IPv6 is fe80:70::9 (Not IPv6 owner) Interface is Vlan70 Configured priority is 120, Current priority is 120 Advertisement interval is 100 centisec Preempt mode is TRUE Circuit failover interface Vlan1021, Priority Delta 50, Status UP VrId 80 State is Backup Virtual IPv6 is fe80:80::9 (Not IPv6 owner) Interface is Vlan80 Priority is 100(config priority is 100) Advertisement interval is 100 centisec Preempt mode is TRUE VrId 90 State is Backup Virtual IPv6 is fe80:90::9 (Not IPv6 owner) Interface is Vlan90 Priority is 100(config priority is 100) Advertisement interval is 100 centisec Preempt mode is TRUE 4ã€DHCPæœåŠ¡ AC1é…ç½®dhcpv4å’Œdhcpv6ï¼Œåˆ†åˆ«ä¸ºSW1äº§å“1æ®µvlan10å’Œåˆ†å…¬å¸vlan100ã€vlan110 å’Œ vlan120 åˆ†é…åœ°å€ï¼›ipv4 åœ°å€æ± åç§°åˆ†åˆ«ä¸º POOLv4-10ã€POOLv4-100ã€POOLv4-110ã€POOLv4-120\nservice dhcp ! ip dhcp pool POOLv4-10 network-address 10.10.11.0 255.255.255.0 default-router 10.10.11.1 dns-server 114.114.114.114 ! ip dhcp pool POOLv4-100 network-address 10.17.100.0 255.255.255.0 default-router 10.17.100.1 dns-server 114.114.114.114 ! ip dhcp pool POOLv4-110 network-address 10.17.110.0 255.255.255.0 default-router 10.17.110.1 dns-server 114.114.114.114 ! ip dhcp pool POOLv4-120 network-address 10.17.120.0 255.255.255.0 default-router 10.17.120.1 dns-server 114.114.114.114 ipv6 åœ°å€æ± åç§°åˆ†åˆ«ä¸º POOLv6-10ã€POOLv6-100ã€POOLv6-110ã€POOLv6-120ï¼›ipv6 åœ°å€æ± ç”¨ç½‘ç»œå‰ç¼€è¡¨ç¤ºï¼›\nservice dhcpv6 ! ipv6 dhcp pool POOLv6-120 network-address 2001:10:17:120:: 64 static-binding 2001:10:17:120::9 24-69-8e-1e-b9-5e excluded-address 2001:10:17:120::1 ! ipv6 dhcp pool POOLv6-110 network-address 2001:10:17:110:: 64 static-binding 2001:10:17:110::9 8c-16-45-78-8d-98 excluded-address 2001:10:17:110::1 ! ipv6 dhcp pool POOLv6-100 network-address 2001:10:17:100:: 64 static-binding 2001:10:17:100::9 00-03-0f-8a-f8-b0 excluded-address 2001:10:17:100::1 ! ipv6 dhcp pool POOLv6-10 network-address 2001:10:10:11:: 64 excluded-address 2001:10:10:11::1 dns-server 2400:3200::1 ! æ’é™¤ç½‘å…³ï¼›\nIPv4:\nip dhcp excluded-address 10.10.11.1 ip dhcp excluded-address 10.17.100.1 ip dhcp excluded-address 10.17.110.1 ip dhcp excluded-address 10.17.120.1 IPv6:\nipv6 dhcp pool POOLv6-120 excluded-address 2001:10:17:120::1 ! ipv6 dhcp pool POOLv6-110 excluded-address 2001:10:17:110::1 ! ipv6 dhcp pool POOLv6-100 excluded-address 2001:10:17:100::1 ! ipv6 dhcp pool POOLv6-10 dns-server 2400:3200::1 ! DNS åˆ†åˆ«ä¸º114.114.114.114 å’Œ 2400:3200::1 ï¼› ä¸º PC1 ä¿ ç•™ åœ° å€ 10.10.11.9 å’Œ2001:10:10:11::9ï¼Œä¸º AP1 ä¿ç•™åœ°å€ 10.17.100.9 å’Œ 2001:10:17ğŸ’¯9ï¼Œä¸º PC2ä¿ç•™åœ°å€ 10.17.110.9 å’Œ 2001:10:17:110::9ã€‚\nip dhcp pool AP1 host 10.17.100.9 255.255.255.0 hardware-address 00-03-0F-8A-F8-B0 default-router 10.17.100.1 ! ip dhcp pool PC1 host 10.10.11.9 255.255.255.0 hardware-address 8C-16-45-78-8D-98 default-router 10.10.11.1 dns-server 114.114.114.114 ! ip dhcp pool PC2 host 10.17.110.9 255.255.255.0 hardware-address 24-69-8E-1E-B9-5E default-router 10.17.110.1 dns-server 114.114.114.114 ! interface Vlan1000 no ipv6 nd suppress-ra ipv6 nd managed-config-flag ipv6 nd other-config-flag ipv6 dhcp server POOLv6-100 ! interface Vlan110 no ipv6 nd suppress-ra ipv6 nd managed-config-flag ipv6 nd other-config-flag ipv6 dhcp server POOLv6-110 ! interface Vlan120 no ipv6 nd suppress-ra ipv6 nd managed-config-flag ipv6 nd other-config-flag ipv6 dhcp server POOLv6-120 ! DHCPä¸­ç»§ï¼š SW1 ä¸Šä¸­ç»§åœ°å€ä¸º AC1 loopback1åœ°å€ã€‚\nIPV4:\nSW1ï¼š\nSW1(config)#service dhcp SW1(config)#ip forward-protocol udp bootps interface Vlan10 ip helper-address 10.10.8.1 IPV6:\nSW1(config)#service dhcpv6 interface Vlan10 no ipv6 nd suppress-ra ipv6 nd managed-config-flag ipv6 nd other-config-flag ipv6 dhcp relay destination 2001:10:10:8::1 DHCP snooping SW1 å¯ç”¨ dhcpv4 å’Œ dhcpv6 snoopingï¼Œå¦‚æœ E1/0/1 è¿æ¥ dhcpv4 æœåŠ¡å™¨ï¼Œåˆ™å…³é—­è¯¥ç«¯å£ï¼Œæ¢å¤æ—¶é—´ä¸º 1 åˆ†é’Ÿã€‚\nIPV4:\nip dhcp snooping enable ! Interface Ethernet1/0/1 ip dhcp snooping action shutdown recovery 60 Interface Ethernet1/0/21;26;22 ip dhcp snooping trust IPV6:\nSW1(config)#savi enable SW1(config)#savi ipv6 dhcp-only enable Interface Ethernet1/0/21;26;22 ipv dhcp snooping trust 5ã€OSPF SW1ã€SW2ã€SW3ã€RT1 ä»¥å¤ªé“¾è·¯ã€RT2 ä»¥å¤ªé“¾è·¯ã€FW1ã€FW2ã€AC1 ä¹‹é—´è¿è¡ŒOSPFv2 å’Œ OSPFv3 åè®®ï¼ˆè·¯ç”±æ¨¡å¼å‘å¸ƒç½‘ç»œç”¨æ¥å£åœ°å€ï¼Œ-\tBGP åè®®é™¤å¤–ï¼‰ã€‚\nOSPFv2 (1) SW1ã€SW2ã€SW3ã€RT1ã€RT2ã€FW1 ä¹‹é—´ OSPFv2 ï¼Œè¿›ç¨‹ 1ï¼ŒåŒºåŸŸ 0ï¼Œåˆ†åˆ«å‘å¸ƒ loopback1 åœ°å€è·¯ç”±å’Œäº§å“è·¯ç”±ï¼ŒFW1 é€šå‘Š type2 é»˜è®¤è·¯ç”±ã€‚\nSW1:\nrouter ospf 1 ospf router-id 10.10.1.1 network 10.10.1.1/32 area 0 network 10.10.11.1/32 area 0 network 10.10.255.1/32 area 0 network 10.10.255.5/32 area 0 network 10.10.255.14/32 area 0 SW2:\nrouter ospf 1 ospf router-id 10.10.2.1 network 10.10.2.1/32 area 0 network 10.10.21.1/32 area 0 network 10.10.255.2/32 area 0 network 10.10.255.9/32 area 0 network 10.10.255.22/32 area 0 SW3:\nrouter ospf 1 ospf router-id 10.10.3.1 network 10.10.3.1/32 area 0 network 10.10.31.1/32 area 0 network 10.10.255.6/32 area 0 network 10.10.255.10/32 area 0 RT1:\nrouter ospf 1 router-id 10.10.4.1 network 10.10.4.1 255.255.255.255 area 0 network 10.10.255.29 255.255.255.255 area 0 network 10.10.255.21 255.255.255.255 area 0 network 10.10.255.18 255.255.255.255 area 0 RT2:\nrouter ospf 1 router-id 10.10.5.1 network 10.10.5.1 255.255.255.255 area 0 network 10.10.255.30 255.255.255.255 area 0 FW1:\nip vrouter \"trust-vr\" ip route 0.0.0.0/0 200.200.200.1 router ospf 1 router-id 10.10.6.1 default-information originate network 10.10.6.1/32 area 0 network 10.10.255.13/32 area 0 network 10.10.255.17/32 area 0 exit (2) RT2 ä¸ AC1 ä¹‹é—´è¿è¡Œ OSPFv2 åè®®ï¼Œè¿›ç¨‹ 1ï¼Œnssa no-summary åŒºåŸŸ 1ï¼›AC1 å‘å¸ƒ loopback1 åœ°å€è·¯ç”±ã€äº§å“å’Œè¥é”€è·¯ç”±ï¼Œç”¨ prefix-list é‡å‘å¸ƒloopback3ã€‚\nRT2:\nrouter ospf 1 network 10.10.255.41 255.255.255.255 area 1 area 1 nssa no-summary AC1:\nrouter ospf 1 ospf router-id 10.10.8.1 area 1 nssa no-summary network 10.10.8.1/32 area 1 network 10.10.255.42/32 area 1 network 10.17.110.1/32 area 1 network 10.17.120.1/32 area 1 redistribute connected route-map L3 ! ip prefix-list L3 seq 5 permit 10.10.8.3/32 ! route-map L3 permit 10 match ip address prefix-list L3 (4)SW3 æ¨¡æ‹ŸåŠäº‹å¤„äº§å“å’Œè¥é”€æ¥å£é…ç½®ä¸º loopbackï¼Œæ¨¡æ‹Ÿæ¥å£ upã€‚SW3 æ¨¡æ‹ŸåŠäº‹å¤„ä¸ FW2 ä¹‹é—´è¿è¡Œ OSPFv2 åè®®ï¼Œè¿›ç¨‹ 2ï¼ŒåŒºåŸŸ 2ï¼ŒSW3 æ¨¡æ‹ŸåŠäº‹å¤„å‘å¸ƒloopback2ã€äº§å“å’Œè¥é”€ã€‚\nSW3ï¼š\nInterface Ethernet1/0/11 loopback switchport access vlan 110 ! Interface Ethernet1/0/12 loopback switchport access vlan 120 router ospf 2 Guangdong ospf router-id 10.10.3.2 network 10.10.3.2/32 area 2 network 10.10.255.46/32 area 2 network 10.16.110.1/32 area 2 network 10.16.120.1/32 area 2 FW2:\nip vrouter \"trust-vr\" router ospf 2 router-id 10.10.7.1 network 10.10.255.45/32 area 2 network 10.10.255.26/32 area 2 network 10.10.7.1/32 area 2 exit (5)RT1ã€FW2 ä¹‹é—´ OSPFv2 åè®®ï¼Œè¿›ç¨‹ 2ï¼ŒåŒºåŸŸ 2ï¼›RT1 å‘å¸ƒ loopback4è·¯ç”±ï¼Œå‘è¯¥åŒºåŸŸé€šå‘Š type1 é»˜è®¤è·¯ç”±ï¼›\nRT1:\nrouter ospf 2 router-id 10.10.4.4 network 10.10.4.4 255.255.255.255 area 2 network 10.10.255.25 255.255.255.255 area 2 default-information originate always metric-type 1 FW2 å‘å¸ƒ loopback1 è·¯ç”±ï¼ŒFW2 ç¦æ­¢å­¦ä¹ åˆ°é›†å›¢å’Œåˆ†å…¬å¸çš„æ‰€æœ‰è·¯ç”±ã€‚\nip vrouter \"trust-vr\" router ospf 2 router-id 10.10.7.1 network 10.10.255.45/32 area 2 network 10.10.255.26/32 area 2 network 10.10.7.1/32 area 2 exit RT1 ç”¨ prefix-list åŒ¹é… FW2 loopback1 è·¯ç”±ã€SW3æ¨¡æ‹ŸåŠäº‹å¤„ loopback2 å’Œäº§å“è·¯ç”±ã€RT1 ä¸ FW2 ç›´è¿ ipv4 è·¯ç”±ï¼Œå°†è¿™äº›è·¯ç”±é‡å‘å¸ƒåˆ°åŒºåŸŸ 0ã€‚\nrouter ospf 1 router-id 10.10.4.1 network 10.10.4.1 255.255.255.255 area 0 network 10.10.255.29 255.255.255.255 area 0 network 10.10.255.21 255.255.255.255 area 0 network 10.10.255.18 255.255.255.255 area 0 redistribute ospf 2 route-map BSC redistribute connect route-map ZL route-map BSC 10 permit match ip address prefix-list BSC ip prefix-list BSC seq 5 permit 10.10.7.1/32 ip prefix-list BSC seq 10 permit 10.10.3.2/32 ip prefix-list BSC seq 15 permit 10.16.110.0/24 route-map ZL 10 permit match ip address prefix-list ZL ip prefix-list ZL seq 5 permit 10.10.255.24/30 è·¯ç”±è¡¨ï¼š\nSW1:\nSW1(config)#sho ip route ospf O*E2 0.0.0.0/0 [110/10] via 10.10.255.13, Vlan1021, 12:37:46 tag:0 O 10.10.2.1/32 [110/2] via 10.10.255.2, Vlan1026, 15:51:53 tag:0 O 10.10.3.1/32 [110/2] via 10.10.255.6, Vlan1022, 15:46:35 tag:0 O E2 10.10.3.2/32 [110/100] via 10.10.255.13, Vlan1021, 11:56:19 tag:0 [110/100] via 10.10.255.2, Vlan1026, 11:56:19 tag:0 O 10.10.4.1/32 [110/3] via 10.10.255.13, Vlan1021, 14:40:59 tag:0 [110/3] via 10.10.255.2, Vlan1026, 14:40:59 tag:0 O 10.10.5.1/32 [110/4] via 10.10.255.13, Vlan1021, 14:40:59 tag:0 [110/4] via 10.10.255.2, Vlan1026, 14:40:59 tag:0 O 10.10.6.1/32 [110/2] via 10.10.255.13, Vlan1021, 14:42:20 tag:0 O E2 10.10.7.1/32 [110/100] via 10.10.255.13, Vlan1021, 12:02:08 tag:0 [110/100] via 10.10.255.2, Vlan1026, 12:02:08 tag:0 O IA 10.10.8.1/32 [110/5] via 10.10.255.13, Vlan1021, 13:59:39 tag:0 [110/5] via 10.10.255.2, Vlan1026, 13:59:39 tag:0 O E2 10.10.8.3/32 [110/20] via 10.10.255.13, Vlan1021, 12:32:00 tag:0 [110/20] via 10.10.255.2, Vlan1026, 12:32:00 tag:0 O 10.10.21.0/24 [110/2] via 10.10.255.2, Vlan1026, 15:51:53 tag:0 O 10.10.31.0/24 [110/2] via 10.10.255.6, Vlan1022, 15:46:35 tag:0 O 10.10.255.8/30 [110/2] via 10.10.255.6, Vlan1022, 15:46:35 tag:0 [110/2] via 10.10.255.2, Vlan1026, 15:46:35 tag:0 O 10.10.255.16/30 [110/2] via 10.10.255.13, Vlan1021, 14:41:09 tag:0 O 10.10.255.20/30 [110/2] via 10.10.255.2, Vlan1026, 15:51:53 tag:0 O E2 10.10.255.24/30 [110/100] via 10.10.255.13, Vlan1021, 11:52:58 tag:0 [110/100] via 10.10.255.2, Vlan1026, 11:52:58 tag:0 O 10.10.255.28/30 [110/3] via 10.10.255.13, Vlan1021, 14:40:59 tag:0 [110/3] via 10.10.255.2, Vlan1026, 14:40:59 tag:0 O IA 10.10.255.40/30 [110/4] via 10.10.255.13, Vlan1021, 13:59:30 tag:0 [110/4] via 10.10.255.2, Vlan1026, 13:59:30 tag:0 O E2 10.16.110.0/24 [110/100] via 10.10.255.13, Vlan1021, 11:55:52 tag:0 [110/100] via 10.10.255.2, Vlan1026, 11:55:52 tag:0 O IA 10.17.110.0/24 [110/5] via 10.10.255.13, Vlan1021, 13:59:39 tag:0 [110/5] via 10.10.255.2, Vlan1026, 13:59:39 tag:0 O IA 10.17.120.0/24 [110/5] via 10.10.255.13, Vlan1021, 13:59:39 tag:0 [110/5] via 10.10.255.2, Vlan1026, 13:59:39 tag:0 Total routes are : 34 item(s) SW2:\nSW2(config)#sho ip rout ospf O*E2 0.0.0.0/0 [110/10] via 10.10.255.1, Vlan1026, 12:38:26 tag:0 [110/10] via 10.10.255.21, Vlan1021, 12:38:26 tag:0 O 10.10.1.1/32 [110/2] via 10.10.255.1, Vlan1026, 15:52:34 tag:0 O 10.10.3.1/32 [110/2] via 10.10.255.10, Vlan1022, 15:47:42 tag:0 O E2 10.10.3.2/32 [110/100] via 10.10.255.21, Vlan1021, 11:57:00 tag:0 O 10.10.4.1/32 [110/2] via 10.10.255.21, Vlan1021, 15:18:41 tag:0 O 10.10.5.1/32 [110/3] via 10.10.255.21, Vlan1021, 15:03:50 tag:0 O 10.10.6.1/32 [110/3] via 10.10.255.1, Vlan1026, 14:41:39 tag:0 [110/3] via 10.10.255.21, Vlan1021, 14:41:39 tag:0 O E2 10.10.7.1/32 [110/100] via 10.10.255.21, Vlan1021, 12:02:49 tag:0 O IA 10.10.8.1/32 [110/4] via 10.10.255.21, Vlan1021, 14:00:19 tag:0 O E2 10.10.8.3/32 [110/20] via 10.10.255.21, Vlan1021, 12:32:40 tag:0 O 10.10.11.0/24 [110/2] via 10.10.255.1, Vlan1026, 15:52:34 tag:0 O 10.10.31.0/24 [110/2] via 10.10.255.10, Vlan1022, 15:47:42 tag:0 O 10.10.255.4/30 [110/2] via 10.10.255.1, Vlan1026, 15:47:42 tag:0 [110/2] via 10.10.255.10, Vlan1022, 15:47:42 tag:0 O 10.10.255.12/30 [110/2] via 10.10.255.1, Vlan1026, 15:52:34 tag:0 O 10.10.255.16/30 [110/2] via 10.10.255.21, Vlan1021, 15:18:41 tag:0 O E2 10.10.255.24/30 [110/100] via 10.10.255.21, Vlan1021, 11:53:38 tag:0 O 10.10.255.28/30 [110/2] via 10.10.255.21, Vlan1021, 15:08:47 tag:0 O IA 10.10.255.40/30 [110/3] via 10.10.255.21, Vlan1021, 14:00:11 tag:0 O E2 10.16.110.0/24 [110/100] via 10.10.255.21, Vlan1021, 11:56:32 tag:0 O IA 10.17.110.0/24 [110/4] via 10.10.255.21, Vlan1021, 14:00:19 tag:0 O IA 10.17.120.0/24 [110/4] via 10.10.255.21, Vlan1021, 14:00:19 tag:0 Total routes are : 24 item(s) SW3:\nSW3(config)#sho ip route ospf O*E2 0.0.0.0/0 [110/10] via 10.10.255.5, Vlan1021, 12:38:54 tag:0 O 10.10.1.1/32 [110/2] via 10.10.255.5, Vlan1021, 15:47:43 tag:0 O 10.10.2.1/32 [110/2] via 10.10.255.9, Vlan1022, 15:48:13 tag:0 O E2 10.10.3.2/32 [110/100] via 10.10.255.9, Vlan1022, 11:57:27 tag:0 O 10.10.4.1/32 [110/3] via 10.10.255.9, Vlan1022, 15:19:09 tag:0 O 10.10.5.1/32 [110/4] via 10.10.255.9, Vlan1022, 15:04:17 tag:0 O 10.10.6.1/32 [110/3] via 10.10.255.5, Vlan1021, 14:43:28 tag:0 O E2 10.10.7.1/32 [110/100] via 10.10.255.9, Vlan1022, 12:03:16 tag:0 O IA 10.10.8.1/32 [110/5] via 10.10.255.9, Vlan1022, 14:00:47 tag:0 O E2 10.10.8.3/32 [110/20] via 10.10.255.9, Vlan1022, 12:33:08 tag:0 O 10.10.11.0/24 [110/2] via 10.10.255.5, Vlan1021, 15:47:43 tag:0 O 10.10.21.0/24 [110/2] via 10.10.255.9, Vlan1022, 15:48:13 tag:0 O 10.10.255.0/30 [110/2] via 10.10.255.5, Vlan1021, 15:47:43 tag:0 [110/2] via 10.10.255.9, Vlan1022, 15:47:43 tag:0 O 10.10.255.12/30 [110/2] via 10.10.255.5, Vlan1021, 15:47:43 tag:0 O 10.10.255.16/30 [110/3] via 10.10.255.5, Vlan1021, 14:42:17 tag:0 [110/3] via 10.10.255.9, Vlan1022, 14:42:17 tag:0 O 10.10.255.20/30 [110/2] via 10.10.255.9, Vlan1022, 15:48:13 tag:0 O E2 10.10.255.24/30 [110/100] via 10.10.255.9, Vlan1022, 11:54:06 tag:0 O 10.10.255.28/30 [110/3] via 10.10.255.9, Vlan1022, 15:09:14 tag:0 O IA 10.10.255.40/30 [110/4] via 10.10.255.9, Vlan1022, 14:00:39 tag:0 O E2 10.16.110.0/24 [110/100] via 10.10.255.9, Vlan1022, 11:57:00 tag:0 O IA 10.17.110.0/24 [110/5] via 10.10.255.9, Vlan1022, 14:00:47 tag:0 O IA 10.17.120.0/24 [110/5] via 10.10.255.9, Vlan1022, 14:00:47 tag:0 Total routes are : 24 item(s) SW3(config)#sho ip route vrf Guangdong ospf O*E1 0.0.0.0/0 [110/102] via 10.10.255.45, Vlan1015, 12:10:12 tag:0 O 10.10.4.4/32 [110/3] via 10.10.255.45, Vlan1015, 12:10:13 tag:0 O 10.10.7.1/32 [110/2] via 10.10.255.45, Vlan1015, 12:19:31 tag:0 O 10.10.255.24/30 [110/2] via 10.10.255.45, Vlan1015, 12:10:33 tag:0 Total routes are : 4 item(s) RT1:\nRT1_config#sho ip route ospf VRF ID: 0 O E2 0.0.0.0/0 [150,10] via 10.10.255.17(on GigaEthernet0/2) O 10.10.1.1/32 [110,3] via 10.10.255.17(on GigaEthernet0/2) [110,3] via 10.10.255.22(on GigaEthernet0/1) O 10.10.2.1/32 [110,2] via 10.10.255.22(on GigaEthernet0/1) O 10.10.3.1/32 [110,3] via 10.10.255.22(on GigaEthernet0/1) O 10.10.3.2/32 [110,3] via 10.10.255.26(on GigaEthernet0/3) O 10.10.5.1/32 [110,2] via 10.10.255.30(on GigaEthernet0/0) O 10.10.6.1/32 [110,2] via 10.10.255.17(on GigaEthernet0/2) O 10.10.7.1/32 [110,2] via 10.10.255.26(on GigaEthernet0/3) O IA 10.10.8.1/32 [110,3] via 10.10.255.30(on GigaEthernet0/0) O E2 10.10.8.3/32 [150,20] via 10.10.255.30(on GigaEthernet0/0) O 10.10.11.0/24 [110,3] via 10.10.255.17(on GigaEthernet0/2) [110,3] via 10.10.255.22(on GigaEthernet0/1) O 10.10.21.0/24 [110,2] via 10.10.255.22(on GigaEthernet0/1) O 10.10.31.0/24 [110,3] via 10.10.255.22(on GigaEthernet0/1) O 10.10.255.0/30 [110,2] via 10.10.255.22(on GigaEthernet0/1) O 10.10.255.4/30 [110,3] via 10.10.255.17(on GigaEthernet0/2) [110,3] via 10.10.255.22(on GigaEthernet0/1) O 10.10.255.8/30 [110,2] via 10.10.255.22(on GigaEthernet0/1) O 10.10.255.12/30 [110,2] via 10.10.255.17(on GigaEthernet0/2) O IA 10.10.255.40/30 [110,2] via 10.10.255.30(on GigaEthernet0/0) O 10.10.255.44/30 [110,2] via 10.10.255.26(on GigaEthernet0/3) O 10.16.110.0/24 [110,3] via 10.10.255.26(on GigaEthernet0/3) O 10.16.120.0/24 [110,3] via 10.10.255.26(on GigaEthernet0/3) O IA 10.17.110.0/24 [110,3] via 10.10.255.30(on GigaEthernet0/0) O IA 10.17.120.0/24 [110,3] via 10.10.255.30(on GigaEthernet0/0) RT2:\nRT2_config#sho ip route ospf VRF ID: 0 O E2 0.0.0.0/0 [150,10] via 10.10.255.29(on GigaEthernet0/0) O 10.10.1.1/32 [110,4] via 10.10.255.29(on GigaEthernet0/0) O 10.10.2.1/32 [110,3] via 10.10.255.29(on GigaEthernet0/0) O 10.10.3.1/32 [110,4] via 10.10.255.29(on GigaEthernet0/0) O E2 10.10.3.2/32 [150,100] via 10.10.255.29(on GigaEthernet0/0) O 10.10.4.1/32 [110,2] via 10.10.255.29(on GigaEthernet0/0) O 10.10.6.1/32 [110,3] via 10.10.255.29(on GigaEthernet0/0) O E2 10.10.7.1/32 [150,100] via 10.10.255.29(on GigaEthernet0/0) O 10.10.8.1/32 [110,2] via 10.10.255.42(on GigaEthernet0/1) O N2 10.10.8.3/32 [150,20] via 10.10.255.42(on GigaEthernet0/1) O 10.10.11.0/24 [110,4] via 10.10.255.29(on GigaEthernet0/0) O 10.10.21.0/24 [110,3] via 10.10.255.29(on GigaEthernet0/0) O 10.10.31.0/24 [110,4] via 10.10.255.29(on GigaEthernet0/0) O 10.10.255.0/30 [110,3] via 10.10.255.29(on GigaEthernet0/0) O 10.10.255.4/30 [110,4] via 10.10.255.29(on GigaEthernet0/0) O 10.10.255.8/30 [110,3] via 10.10.255.29(on GigaEthernet0/0) O 10.10.255.12/30 [110,3] via 10.10.255.29(on GigaEthernet0/0) O 10.10.255.16/30 [110,2] via 10.10.255.29(on GigaEthernet0/0) O 10.10.255.20/30 [110,2] via 10.10.255.29(on GigaEthernet0/0) O E2 10.10.255.24/30 [150,100] via 10.10.255.29(on GigaEthernet0/0) O E2 10.16.110.0/24 [150,100] via 10.10.255.29(on GigaEthernet0/0) O 10.17.110.0/24 [110,2] via 10.10.255.42(on GigaEthernet0/1) O 10.17.120.0/24 [110,2] via 10.10.255.42(on GigaEthernet0/1) AC1:\nAC1(config)#sho ip route os O*IA 0.0.0.0/0 [110/101] via 10.10.255.41, Vlan1001, 14:02:54 tag:0 Total routes are : 1 item(s) FW1:\nFW1(config)# sho ip route ospf Codes: K - kernel route, C - connected, S - static, Z - ISP, R - RIP, O - OSPF, B - BGP, D - DHCP, P - PPPoE, W - wireless, H - HOST, G - SCVPN, V - VPN, M - IMPORT, I - ISIS, Y - SYNC, L - llb outbound, \u003e - selected first nexthop, * - FIB route, b - BFD enable Routing Table for Virtual Router ============================================================================== O\u003e* 10.10.1.1/32 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08 O\u003e* 10.10.2.1/32 [110/3/1] via 10.10.255.14, ethernet0/1, 14:44:57 * [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57 O\u003e* 10.10.3.1/32 [110/3/1] via 10.10.255.14, ethernet0/1, 14:46:08 O\u003e* 10.10.3.2/32 [110/100/1] via 10.10.255.18, ethernet0/2, 12:00:17 O\u003e* 10.10.4.1/32 [110/2/1] via 10.10.255.18, ethernet0/2, 14:44:57 O\u003e* 10.10.5.1/32 [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57 O\u003e* 10.10.7.1/32 [110/100/1] via 10.10.255.18, ethernet0/2, 12:06:06 O\u003e* 10.10.8.1/32 [110/4/1] via 10.10.255.18, ethernet0/2, 14:03:32 O\u003e* 10.10.8.3/32 [110/20/1] via 10.10.255.18, ethernet0/2, 12:35:58 O\u003e* 10.10.11.0/24 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08 O\u003e* 10.10.21.0/24 [110/3/1] via 10.10.255.14, ethernet0/1, 14:44:57 * [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57 O\u003e* 10.10.31.0/24 [110/3/1] via 10.10.255.14, ethernet0/1, 14:46:08 O\u003e* 10.10.255.0/30 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08 O\u003e* 10.10.255.4/30 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08 O\u003e* 10.10.255.8/30 [110/3/1] via 10.10.255.14, ethernet0/1, 14:44:57 * [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57 O\u003e* 10.10.255.20/30 [110/2/1] via 10.10.255.18, ethernet0/2, 14:44:59 O\u003e* 10.10.255.24/30 [110/100/1] via 10.10.255.18, ethernet0/2, 11:56:58 O\u003e* 10.10.255.28/30 [110/2/1] via 10.10.255.18, ethernet0/2, 14:44:59 O\u003e* 10.10.255.40/30 [110/3/1] via 10.10.255.18, ethernet0/2, 14:03:24 O\u003e* 10.16.110.0/24 [110/100/1] via 10.10.255.18, ethernet0/2, 11:59:52 O\u003e* 10.17.110.0/24 [110/4/1] via 10.10.255.18, ethernet0/2, 14:03:34 O\u003e* 10.17.120.0/24 [110/4/1] via 10.10.255.18, ethernet0/2, 14:03:34 ============================================================================== Routing Table for Virtual Router ============================================================================== ============================================================================== FW2:\nFW2(config)# sho ip route os | Output modifiers vrouter Virtual router FW2(config)# sho ip route os Codes: K - kernel route, C - connected, S - static, Z - ISP, R - RIP, O - OSPF, B - BGP, D - DHCP, P - PPPoE, W - wireless, H - HOST, G - SCVPN, V - VPN, M - IMPORT, I - ISIS, Y - SYNC, L - llb outbound, \u003e - selected first nexthop, * - FIB route, b - BFD enable Routing Table for Virtual Router ============================================================================== O\u003e* 0.0.0.0/0 [110/101/1] via 10.10.255.25, ethernet0/2, 12:12:31 O\u003e* 10.10.3.2/32 [110/2/1] via 10.10.255.46, ethernet0/1, 12:23:29 O\u003e* 10.10.4.4/32 [110/2/1] via 10.10.255.25, ethernet0/2, 12:12:32 O\u003e* 10.16.110.0/24 [110/2/1] via 10.10.255.46, ethernet0/1, 12:23:29 O\u003e* 10.16.120.0/24 [110/2/1] via 10.10.255.46, ethernet0/1, 12:23:29 ============================================================================== Routing Table for Virtual Router ============================================================================== ============================================================================== OSPFv3 (1) SW1ã€SW2ã€SW3ã€RT1ã€RT2ã€FW1 ä¹‹é—´ OSPFv3 ï¼Œè¿›ç¨‹ 1ï¼ŒåŒºåŸŸ 0ï¼Œåˆ†åˆ«å‘å¸ƒ loopback1 åœ°å€è·¯ç”±å’Œäº§å“è·¯ç”±ï¼ŒFW1 é€šå‘Š type2 é»˜è®¤è·¯ç”±ã€‚\nSW1:\nrouter ipv6 ospf 1 router-id 10.10.1.1 interface Loopback1 ipv6 router ospf area 0 tag 1 ! interface Vlan10 ipv6 router ospf area 0 tag 1 ! interface Vlan1021 ipv6 router ospf area 0 tag 1 ! interface Vlan1022 ipv6 router ospf area 0 tag 1 ! interface Vlan1026 ipv6 router ospf area 0 tag 1 SW2:\nrouter ipv6 ospf 1 router-id 10.10.2.1 interface Loopback1 ipv6 router ospf area 0 tag 1 ! interface Vlan10 ipv6 router ospf area 0 tag 1 ! interface Vlan1021 ipv6 router ospf area 0 tag 1 ! interface Vlan1022 ipv6 router ospf area 0 tag 1 ! interface Vlan1026 ipv6 router ospf area 0 tag 1 SW3:\nrouter ipv6 ospf 1 router-id 10.10.3.1 interface Loopback1 ipv6 router ospf area 0 tag 1 ! interface Vlan10 ipv6 router ospf area 0 tag 1 ! interface Vlan1021 ipv6 router ospf area 0 tag 1 ! interface Vlan1022 ipv6 router ospf area 0 tag 1 RT1:\nrouter ospfv3 1 router-id 10.10.4.1 interface Loopback1 ipv6 enable ipv6 ospf 1 area 0 ! interface GigaEthernet0/0 ipv6 enable ipv6 ospf 1 area 0 ! interface GigaEthernet0/1 ipv6 enable ipv6 ospf 1 area 0 ! interface GigaEthernet0/2 ipv6 ospf 1 area 0 RT2:\nrouter ospfv3 1 router-id 10.10.5.1 interface Loopback1 ipv6 enable ipv6 ospf 1 area 0 ! interface GigaEthernet0/0 ipv6 enable ipv6 ospf 1 area 0 FW1:\nipv6 route ::/0 \"ethernet0/3\" FE80::203:FFF:FEE0:F9B8 ipv6 router ospf 1 router-id 10.10.6.1 default-information originate exit ! interface loopback1 ipv6 enable ipv6 ospf 1 area 0 ! interface ethernet0/1 ipv6 enable ipv6 ospf 1 area 0 ! interface ethernet0/2 ipv6 enable ipv6 ospf 1 area 0 (3)RT2 ä¸ AC1 ä¹‹é—´è¿è¡Œ OSPFv3 åè®®ï¼Œè¿›ç¨‹ 1ï¼Œstub no-summary åŒºåŸŸ 1ï¼›AC1 å‘å¸ƒ loopback1 åœ°å€è·¯ç”±ã€äº§å“å’Œè¥é”€ã€‚\nRT2:\nrouter ospfv3 1 router-id 10.10.5.1 area 1 stub no-summary interface GigaEthernet0/1 ipv6 enable ipv6 ospf 1 area 1 AC1:\nrouter ipv6 ospf 1 router-id 10.10.8.1 area 1 stub no-summary interface Loopback1 ipv6 router ospf area 1 tag 1 ! interface Vlan110 ipv6 router ospf area 1 tag 1 ! interface Vlan120 ipv6 router ospf area 1 tag 1 ! interface Vlan1001 ipv6 router ospf area 1 tag 1 (4)SW3 æ¨¡æ‹ŸåŠäº‹å¤„é…ç½® ipv6 é»˜è®¤è·¯ç”±ï¼›FW2 åˆ†åˆ«é…ç½®åˆ° SW3 æ¨¡æ‹ŸåŠäº‹å¤„ loopback2ã€äº§å“å’Œè¥é”€çš„ ipv6 æ˜ç»†é™æ€è·¯ç”±ï¼ŒFW2 é‡å‘å¸ƒé™æ€ è·¯ç”±åˆ° OSPFv3 åè®®ã€‚\nSW3:\nipv6 route vrf Guangdong ::/0 fe80::203:fff:fea6:8341 Vlan1015 FW2:\nip vrouter \"trust-vr\" ipv6 route 2001:10:10:3::1/128 \"ethernet0/1\" FE80::203:FFF:FEE0:F9B8 ipv6 route 2001:10:16:110::/64 \"ethernet0/1\" FE80::203:FFF:FEE0:F9B8 ipv6 route 2001:10:16:120::/64 \"ethernet0/1\" FE80::203:FFF:FEE0:F9B8 exit ipv6 router ospf 2 router-id 10.10.7.1 redistribute static exit (5)RT1ã€FW2 ä¹‹é—´OSPFv3 åè®®ï¼Œè¿›ç¨‹ 2ï¼ŒåŒºåŸŸ 2ï¼›RT1 å‘å¸ƒ loopback4è·¯ç”±ï¼Œå‘è¯¥åŒºåŸŸé€šå‘Š type1 é»˜è®¤è·¯ç”±ï¼›\nRT1:\nrouter ospfv3 2 router-id 10.10.4.4 default-information originate always metric-type 1 interface Loopback4 ipv6 enable ipv6 ospf 2 area 2 FW2 å‘å¸ƒ loopback1 è·¯ç”±ï¼ŒFW2 ç¦æ­¢å­¦ä¹ åˆ°é›†å›¢å’Œåˆ†å…¬å¸çš„æ‰€æœ‰è·¯ç”±ã€‚\nFW2:\ninterface loopback1 ipv6 enable ipv6 ospf 2 area 2 interface ethernet0/1 ipv6 enable ipv6 ospf 2 area 2 exit interface ethernet0/2 ipv6 enable ipv6 ospf 2 area 2 exit RT1 ç”¨ prefix-list åŒ¹é… FW2 loopback1 è·¯ç”±ã€SW3æ¨¡æ‹ŸåŠäº‹å¤„ loopback2 å’Œäº§å“è·¯ç”±ã€RT1 ä¸ FW2 ç›´è¿ ipv4 è·¯ç”±ï¼Œå°†è¿™äº›è·¯ç”±é‡å‘å¸ƒåˆ°åŒºåŸŸ 0ã€‚\nrouter ospfv3 1 router-id 10.10.4.1 redistribute ospf 2 route-map BSCV6Â· ! route-map BSCV6 10 permit match ipv6 address prefix-list BSCV6 ! ipv6 prefix-list BSCV6 seq 5 permit 2001:10:10:3::2/128 ipv6 prefix-list BSCV6 seq 10 permit 2001:10:16:110::/64 (6)ä¿®æ”¹ospf costä¸º100ï¼Œå®ç°SW1åˆ†åˆ«ä¸RT2ã€FW2ä¹‹é—´ipv4å’Œipv6äº’è®¿æµé‡ä¼˜å…ˆé€šè¿‡SW1_SW2_RT1é“¾è·¯è½¬å‘ï¼ŒSW2è®¿é—®Internet ipv4å’Œipv6æµé‡ä¼˜å…ˆé€šè¿‡SW2_SW1_FW1é“¾è·¯è½¬å‘ã€‚\nFW1:\ninterface ethernet0/2 ip ospf cost 100 ipv6 ospf cost 100 RT1:\ninterface GigaEthernet0/2 ip ospf cost 100 ipv6 ospf cost 100 IPV6è·¯ç”±è¡¨ï¼š\nSW1ï¼š\nSW1(config)#sho ipv route nsm ospf IPv6 Routing Table Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF, I - IS-IS, B - BGP Timers: Uptime O ::/0 [110/21] via fe80::203:fff:fea6:72c1, Vlan1021, 12:00:39 tag:0 O 2001:10:10:2::1/128 [110/1] via fe80::203:fff:fee0:f9b5, Vlan1026, 12:24:12 tag:0 O 2001:10:10:3::1/128 [110/1] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:16:43 tag:0 O 2001:10:10:3::2/128 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:20 tag:0 O 2001:10:10:4::1/128 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21 tag:0 O 2001:10:10:5::1/128 [110/3] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21 tag:0 O 2001:10:10:6::1/128 [110/2] via fe80::203:fff:fea6:72c1, Vlan1021, 12:05:24 tag:0 O 2001:10:10:8::1/128 [110/4] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21 tag:0 O 2001:10:10:21::/64 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1026, 12:24:12 tag:0 O 2001:10:10:31::/64 [110/2] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:16:43 tag:0 O 2001:10:16:110::/64 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:20 tag:0 O 2001:10:17:110::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21 tag:0 O 2001:10:17:120::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21 tag:0 SW2:\nSW2(config)#sho ipv route nsm ospf IPv6 Routing Table Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF, I - IS-IS, B - BGP Timers: Uptime O ::/0 [110/22] via fe80::203:fff:fee0:f9b2, Vlan1026, 11:31:37 tag:0 O 2001:10:10:1::1/128 [110/1] via fe80::203:fff:fee0:f9b2, Vlan1026, 12:24:52 tag:0 O 2001:10:10:3::1/128 [110/1] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:17:33 tag:0 O 2001:10:10:3::2/128 [110/150] via fe80::203:fff:fedc:c392, Vlan1021, 11:36:13 tag:0 O 2001:10:10:4::1/128 [110/1] via fe80::203:fff:fedc:c392, Vlan1021, 12:14:02 tag:0 O 2001:10:10:5::1/128 [110/2] via fe80::203:fff:fedc:c392, Vlan1021, 12:11:48 tag:0 O 2001:10:10:6::1/128 [110/3] via fe80::203:fff:fee0:f9b2, Vlan1026, 11:31:38 tag:0 O 2001:10:10:8::1/128 [110/3] via fe80::203:fff:fedc:c392, Vlan1021, 11:59:02 tag:0 O 2001:10:10:11::/64 [110/2] via fe80::203:fff:fee0:f9b2, Vlan1026, 12:24:52 tag:0 O 2001:10:10:31::/64 [110/2] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:17:33 tag:0 O 2001:10:16:110::/64 [110/150] via fe80::203:fff:fedc:c392, Vlan1021, 11:36:13 tag:0 O 2001:10:17:110::/64 [110/4] via fe80::203:fff:fedc:c392, Vlan1021, 11:59:02 tag:0 O 2001:10:17:120::/64 [110/4] via fe80::203:fff:fedc:c392, Vlan1021, 11:59:02 tag:0 SW3:\nSW3#sho ipv route nsm ospf IPv6 Routing Table Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF, I - IS-IS, B - BGP Timers: Uptime O ::/0 [110/22] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:01:49 tag:0 O 2001:10:10:1::1/128 [110/1] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:17:56 tag:0 O 2001:10:10:2::1/128 [110/1] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:17:56 tag:0 O 2001:10:10:3::2/128 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:36:44 tag:0 O 2001:10:10:4::1/128 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:14:33 tag:0 O 2001:10:10:5::1/128 [110/3] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:12:19 tag:0 O 2001:10:10:6::1/128 [110/3] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:06:35 tag:0 O 2001:10:10:8::1/128 [110/4] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:59:33 tag:0 O 2001:10:10:11::/64 [110/2] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:17:56 tag:0 O 2001:10:10:21::/64 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:17:56 tag:0 O 2001:10:16:110::/64 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:36:44 tag:0 O 2001:10:17:110::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:59:33 tag:0 O 2001:10:17:120::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:59:33 tag:0 RT1:\nRT1_config#sho ipv route ospf OE1 ::/0[1] [110,23] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) O 2001:10:10:1::1/128[1] [110,2] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) O 2001:10:10:2::1/128[1] [110,1] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) O 2001:10:10:3::1/128[1] [110,2] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) OE2 2001:10:10:3::2/128[1] [110,20] via fe80::203:fff:fea6:8342(on GigaEthernet0/3) O 2001:10:10:5::1/128[1] [110,1] via fe80::203:fff:fedc:c389(on GigaEthernet0/0) O 2001:10:10:6::1/128[1] [110,4] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) O 2001:10:10:7::1/128[1] [110,2] via fe80::203:fff:fea6:8342(on GigaEthernet0/3) OIA 2001:10:10:8::1/128[1] [110,2] via fe80::203:fff:fedc:c389(on GigaEthernet0/0) O 2001:10:10:11::/64[1] [110,3] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) O 2001:10:10:21::/64[1] [110,2] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) O 2001:10:10:31::/64[1] [110,3] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) OE2 2001:10:16:110::/64[1] [110,20] via fe80::203:fff:fea6:8342(on GigaEthernet0/3) OE2 2001:10:16:120::/64[1] [110,20] via fe80::203:fff:fea6:8342(on GigaEthernet0/3) OIA 2001:10:17:110::/64[1] [110,3] via fe80::203:fff:fedc:c389(on GigaEthernet0/0) OIA 2001:10:17:120::/64[1] [110,3] via fe80::203:fff:fedc:c389(on GigaEthernet0/0) RT2:\nRT2_config#sho ipv route ospf OE1 ::/0[1] [110,24] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:1::1/128[1] [110,3] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:2::1/128[1] [110,2] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:3::1/128[1] [110,3] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) OE2 2001:10:10:3::2/128[1] [110,150] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:4::1/128[1] [110,1] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:6::1/128[1] [110,5] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:8::1/128[1] [110,1] via fe80::203:fff:fed4:28b2(on GigaEthernet0/1) O 2001:10:10:11::/64[1] [110,4] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:21::/64[1] [110,3] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:10:31::/64[1] [110,4] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) OE2 2001:10:16:110::/64[1] [110,150] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) O 2001:10:17:110::/64[1] [110,2] via fe80::203:fff:fed4:28b2(on GigaEthernet0/1) O 2001:10:17:120::/64[1] [110,2] via fe80::203:fff:fed4:28b2(on GigaEthernet0/1) AC1:\nAC1(config)#sho ipv route nsm ospf IPv6 Routing Table Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF, I - IS-IS, B - BGP Timers: Uptime O ::/0 [110/2] via fe80::203:fff:fedc:c38a, Vlan1001, 12:01:37 tag:0 FW1:\nFW1(config)# sho ipv route ospf ? | Output modifiers vrouter Virtual router FW1(config)# sho ipv route ospf Codes: K - kernel route, C - connected, S - static, R - RIPng, O - OSPFv3, B - BGP, I - ISIS, A - AUTOCONF, H - HOST, \u003e - selected route, * - FIB route, Routing Table for Virtual Router ============================================================================== O\u003e 2001:10:10:1::1/128 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/1/1] O\u003e 2001:10:10:2::1/128 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/2/1] O\u003e 2001:10:10:3::1/128 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/2/1] O\u003e 2001:10:10:3::2/128 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/150/1] O\u003e 2001:10:10:4::1/128 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/3/1] O\u003e 2001:10:10:5::1/128 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/4/1] O\u003e 2001:10:10:8::1/128 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/5/1] O\u003e 2001:10:10:11::/64 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/2/1] O\u003e 2001:10:10:21::/64 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/3/1] O\u003e 2001:10:10:31::/64 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/3/1] O\u003e 2001:10:16:110::/64 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/150/1] O\u003e 2001:10:17:110::/64 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/6/1] O\u003e 2001:10:17:120::/64 * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/6/1] ============================================================================== Routing Table for Virtual Router ============================================================================== ============================================================================== FW2:\nFW2(config)# sho ipv route ospf Codes: K - kernel route, C - connected, S - static, R - RIPng, O - OSPFv3, B - BGP, I - ISIS, A - AUTOCONF, H - HOST, \u003e - selected route, * - FIB route, Routing Table for Virtual Router ============================================================================== O\u003e ::/0 * via FE80::203:FFF:FEDC:C394, ethernet0/2 [110/151/1] O\u003e 2001:10:10:4::4/128 * via FE80::203:FFF:FEDC:C394, ethernet0/2 [110/1/1] ============================================================================== Routing Table for Virtual Router ============================================================================== ============================================================================== 6ã€RIP RT1ä¸²è¡Œé“¾è·¯ã€RT2ä¸²è¡Œé“¾è·¯ã€FW1ã€AC1ä¹‹é—´åˆ†åˆ«è¿è¡ŒRIPå’ŒRIPngåè®®ï¼Œ FW1ã€RT1ã€RT2çš„RIPå’ŒRIPngå‘å¸ƒloopback2åœ°å€è·¯ç”±ï¼ŒAC1 RIPå‘å¸ƒloopback2 åœ°å€è·¯ç”±ï¼ŒAC1 RIPngé‡‡ç”¨route-mapåŒ¹é…prefix-listé‡å‘å¸ƒloopback2åœ°å€è·¯ç”±ã€‚\nIPV4:\nFW1:\nrouter rip network 10.10.6.2/32 network 10.10.255.16/30 RT1:\nrouter rip 1 version 2 no auto-summary interface Loopback2 ip rip 1 enable ! interface Serial1/0 ip rip 1 enable ! interface Serial1/1 ip rip 1 enable ! interface GigaEthernet0/2 ip rip 1 enable ! RT2:\nrouter rip 1 version 2 no auto-summary interface Loopback2 ip rip 1 enable ! interface Serial1/0 ip rip 1 enable ! interface Serial1/1 ip rip 1 enable ! interface GigaEthernet0/1 ip rip 1 enable AC1:\nrouter rip network Loopback2 network Vlan1001 RT1é…ç½®offsetå€¼ä¸º3çš„è·¯ç”±ç­–ç•¥ï¼Œå®ç°RT1-S1/0_RT2-S1/1ä¸ºä¸»é“¾è·¯ï¼Œ RT1-1/1_RT2-S1/0ä¸ºå¤‡ä»½é“¾è·¯ï¼Œipv4çš„ACLåç§°ä¸ºAclRIPï¼Œipv6çš„ACLåç§°ä¸ºAclRIPngã€‚\nrouter rip 1 version 2 no auto-summary offset Serial1/1 in AclRIP 3 offset Serial1/1 out AclRIP 3 ! ip access-list standard AclRIP permit any sequence 10 RIPng RT1ä¸²è¡Œé“¾è·¯ã€RT2ä¸²è¡Œé“¾è·¯ã€FW1ã€AC1ä¹‹é—´è¿è¡ŒRIPngåè®®ï¼Œ FW1ã€RT1ã€RT2çš„RIPngå‘å¸ƒloopback2åœ°å€è·¯ç”±ï¼ŒAC1 RIPå‘å¸ƒloopback2 åœ°å€è·¯ç”±ï¼ŒAC1 RIPngé‡‡ç”¨route-mapåŒ¹é…prefix-listé‡å‘å¸ƒloopback2åœ°å€è·¯ç”±ã€‚\nFW1:\nipv6 router rip network loopback2 network ethernet0/2 RT1:\nrouter ripng 1 interface Loopback2 ipv6 rip 1 enable ! interface Serial1/0 ipv6 rip 1 enable ! interface Serial1/1 ipv6 rip 1 enable ! interface GigaEthernet0/2 ipv6 rip 1 enable RT2:\nrouter ripng 1 interface Loopback2 ipv6 rip 1 enable ! interface Serial1/0 ipv6 rip 1 enable ! interface Serial1/1 ipv6 rip 1 enable ! interface GigaEthernet0/1 ipv6 rip 1 enable AC1ï¼š\nrouter ipv6 rip redistribute connected route-map L2V6 ! route-map L2V6 permit 10 match ipv6 address prefix-list L2V6 ! ipv6 prefix-list L2V6 seq 5 permit 2001:10:10:8::2/128 ! interface Vlan1001 ipv6 router rip RT1é…ç½®offsetå€¼ä¸º3çš„è·¯ç”±ç­–ç•¥ï¼Œå®ç°RT1-S1/0_RT2-S1/1ä¸ºä¸»é“¾è·¯ï¼Œ RT1-1/1_RT2-S1/0ä¸ºå¤‡ä»½é“¾è·¯ï¼Œipv4çš„ACLåç§°ä¸ºAclRIPï¼Œipv6çš„ACLåç§°ä¸ºAclRIPngã€‚\nRT1:\nrouter ripng 1 offset Serial1/1 in AclRIPng 3 offset Serial1/1 out AclRIPng 3 ! ipv6 access-list AclRIPng massive permit ipv6 any any sequence 10 chapåŒå‘è®¤è¯ RT1çš„S1/0ä¸RT2çš„S1/1ä¹‹é—´é‡‡ç”¨chapåŒå‘è®¤è¯ï¼Œç”¨æˆ·åä¸ºå¯¹ç«¯è®¾å¤‡åç§°ï¼Œå¯†ç ä¸ºPass-1234ã€‚\nRT1:\naaa authentication ppp default local ! username RT2 password 0 Pass-1234 ! interface Serial1/0 ppp authentication chap ppp chap hostname RT1 ppp chap password 0 Pass-1234 RT2:\naaa authentication ppp default local ! username RT1 password 0 Pass-1234 ! interface Serial1/1 ppp authentication chap ppp chap hostname RT2 ppp chap password 0 Pass-1234 è·¯ç”±è¡¨ï¼š\nFW1:\nFW1(config)# sho ip route rip Codes: K - kernel route, C - connected, S - static, Z - ISP, R - RIP, O - OSPF, B - BGP, D - DHCP, P - PPPoE, W - wireless, H - HOST, G - SCVPN, V - VPN, M - IMPORT, I - ISIS, Y - SYNC, L - llb outbound, \u003e - selected first nexthop, * - FIB route, b - BFD enable Routing Table for Virtual Router ============================================================================== R\u003e* 10.10.4.2/32 [120/2/1] via 10.10.255.18, ethernet0/2, 09:01:13 R\u003e* 10.10.5.2/32 [120/3/1] via 10.10.255.18, ethernet0/2, 07:44:32 R\u003e* 10.10.8.2/32 [120/4/1] via 10.10.255.18, ethernet0/2, 07:44:32 R\u003e* 10.10.255.32/30 [120/2/1] via 10.10.255.18, ethernet0/2, 07:44:43 R\u003e* 10.10.255.36/30 [120/2/1] via 10.10.255.18, ethernet0/2, 07:44:43 R 10.10.255.40/30 [120/3/1] via 10.10.255.18, ethernet0/2, 07:44:32 ============================================================================== Routing Table for Virtual Router ============================================================================== ============================================================================== RT1:\nRT1_config#sho ip route rip VRF ID: 0 R 10.10.5.2/32 [120,1] via 10.10.255.34(on Serial1/0) R 10.10.6.2/32 [120,1] via 10.10.255.17(on GigaEthernet0/2) R 10.10.8.2/32 [120,2] via 10.10.255.34(on Serial1/0) RT2:\nRT2_config#sho ip route rip VRF ID: 0 R 10.10.4.2/32 [120,1] via 10.10.255.33(on Serial1/1) R 10.10.6.2/32 [120,2] via 10.10.255.33(on Serial1/1) R 10.10.8.2/32 [120,1] via 10.10.255.42(on GigaEthernet0/1) AC1:\nAC1(config)#sho ip route rip R 10.10.4.2/32 [120/3] via 10.10.255.41, Vlan1001, 00:00:25 tag:1 R 10.10.5.2/32 [120/2] via 10.10.255.41, Vlan1001, 00:00:25 tag:1 R 10.10.6.2/32 [120/4] via 10.10.255.41, Vlan1001, 07:47:32 tag:0 R 10.10.255.16/30 [120/3] via 10.10.255.41, Vlan1001, 00:00:25 tag:1 R 10.10.255.32/30 [120/2] via 10.10.255.41, Vlan1001, 00:00:25 tag:1 R 10.10.255.36/30 [120/2] via 10.10.255.41, Vlan1001, 00:00:25 tag:1 Total routes are : 6 item(s) 7ã€ISIS RT1 ä»¥å¤ªé“¾è·¯ã€RT2 ä»¥å¤ªé“¾è·¯ä¹‹é—´è¿è¡Œ ISIS åè®®ï¼Œè¿›ç¨‹ 1ï¼Œåˆ†åˆ«å®ç° loopback3 ä¹‹é—´ ipv4 äº’é€šå’Œ ipv6 äº’é€šã€‚RT1ã€RT2 çš„ NET åˆ†åˆ«ä¸º10.0000.0000.0001.00ã€10.0000.0000.0002.00ï¼Œè·¯ç”±å™¨ç±»å‹æ˜¯Level-2ï¼Œæ¥å£ç½‘ç»œç±»å‹ä¸ºç‚¹åˆ°ç‚¹ã€‚\nRT1:\nrouter isis 1 is-type level-2 net 10.0000.0000.0001.00 ! interface Loopback3 ip router isis 1 ipv6 router isis 1 ! interface GigaEthernet0/0 ip router isis 1 ipv6 router isis 1 isis network point-to-point isis circuit-type level-2 RT2:\nrouter isis 1 is-type level-2 net 10.0000.0000.0002.00 ! interface Loopback3 ip router isis 1 ipv6 router isis 1 ! interface GigaEthernet0/0 ip router isis 1 ipv6 router isis 1 isis network point-to-point isis circuit-type level-2 isis network point-to-point é…ç½®åŸŸmd5è®¤è¯å’Œæ¥å£md5è®¤è¯ï¼Œå¯†ç å‡ä¸ºPass-1234ã€‚\nRT1:\nrouter isis 1 authentication mode md5 level-2 authentication key 0 Pass-1234 level-2 ! interface GigaEthernet0/0 isis authentication mode md5 level-2 isis authentication key 0 Pass-1234 RT2:\nrouter isis 1 authentication mode md5 level-2 authentication key 0 Pass-1234 level-2 ! interface GigaEthernet0/0 isis authentication mode md5 level-2 isis authentication key 0 Pass-1234 level-2 8ã€nat RT2é…ç½®ipv4 natï¼Œå®ç°AC1 ipv4äº§å“éƒ¨é—¨ç”¨RT2å¤–ç½‘æ¥å£ipv4åœ°å€è®¿é—®Internetã€‚RT2é…ç½®nat64ï¼Œå®ç°AC1 ipv6äº§å“éƒ¨é—¨ç”¨RT2å¤–ç½‘æ¥å£ipv4åœ°å€è®¿é—®Internetï¼Œipv4åœ°å€è½¬ipv6åœ°å€å‰ç¼€ä¸º64:ff9b::/96ã€‚\nIPV4:\nRT2:\nip route default 200.200.200.5 ! ip access-list standard NAT permit 10.17.110.0 255.255.255.0 sequence 10 ! ip nat inside source list NAT interface GigaEthernet0/3 ! interface GigaEthernet0/1 ip nat inside ! interface GigaEthernet0/3 ip nat outside ! router ospf 1 default-information originate ç»“æœéªŒè¯ï¼š\nAC1:\nAC1#ping src 10.17.110.1 200.200.200.5 Type ^c to abort. Sending 5 56-byte ICMP Echos to 200.200.200.5, using source address 10.17.110.1, timeout is 2 seconds. !!!!! Success rate is 100 percent (5/5), round-trip min/avg/max = 0/14/20 ms RT2:\nRT2_config#sho ip nat translations Pro. Dir Inside local Inside global Outside local Outside global ICMP OUT 10.17.110.1:4660 200.200.200.6:4660 200.200.200.5:4660 200.200.200.5:4660 IPV6:\nipv6 access-list NATV6 massive permit ipv6 2001:10:17:110::/64 any sequence 10 ! ipv6 nat v6v4 source list NATV6 interface GigaEthernet0/3 ipv6 nat prefix 64:FF9B::/96 v4-mapped NATV6 ! interface GigaEthernet0/3 ipv6 nat ! interface GigaEthernet0/1 ipv6 nat ç»“æœéªŒè¯ï¼š\nAC1:\nAC1#ping6 src 2001:10:17:110::1 64:ff9b::200.200.200.5 Type ^c to abort. Sending 5 56-byte ICMP Echos to 64:ff9b::200.200.200.5, using src address 2001:10:17:110::1, timeout is 2 seconds. !!!!! Success rate is 100 percent (5/5), round-trip min/avg/max = 0/6/20 ms RT2:\nRT2_config#sho ipv nat translations Prot V6Src V6Dst V4Src V4Dst ICMP 2001:10:17:110::1-466064:FF9B::C8C8:C805-4660200.200.200.6-4660200.200.200.5-4660 9ã€BGP SW1ã€SW2ã€SW3ã€RT1ã€RT2 ä¹‹é—´è¿è¡Œ BGP åè®®ï¼ŒSW1ã€SW2ã€RT1 AS å· 65001ã€ RT2 AS å· 65002ã€SW3 AS å· 65003ã€‚\nipv4 BGP (1)SW1ã€SW2ã€SW3ã€RT1ã€RT2 ä¹‹é—´é€šè¿‡ loopback1 å»ºç«‹ ipv4BGP é‚» å±…ã€‚SW1 å’Œ SW2 ä¹‹é—´è´¢åŠ¡é€šè¿‡ loopback2 å»ºç«‹ ipv4 BGP é‚»å±…ï¼ŒSW1 å’Œ SW2 çš„ loopback2 äº’é€šé‡‡ç”¨é™æ€è·¯ç”±ã€‚\nSW1:\nrouter bgp 65001 bgp router-id 10.10.1.1 neighbor 10.10.2.1 remote-as 65001 neighbor 10.10.2.1 update-source 10.10.1.1 neighbor 10.10.2.1 next-hop-self neighbor 10.10.3.1 remote-as 65003 neighbor 10.10.3.1 ebgp-multihop 255 neighbor 10.10.3.1 update-source 10.10.1.1 neighbor 10.10.4.1 remote-as 65001 neighbor 10.10.4.1 update-source 10.10.1.1 neighbor 10.10.4.1 next-hop-self ip route vrf CW 10.10.2.2/32 10.10.255.2 router bgp 65001 address-family ipv4 vrf CW network 10.10.14.0/24 neighbor 10.10.2.2 remote-as 65001 neighbor 10.10.2.2 update-source 10.10.1.2 exit-address-family SW2:\nrouter bgp 65001 bgp router-id 10.10.2.1 neighbor 10.10.1.1 remote-as 65001 neighbor 10.10.1.1 update-source 10.10.2.1 neighbor 10.10.1.1 next-hop-self neighbor 10.10.3.1 remote-as 65003 neighbor 10.10.3.1 ebgp-multihop 255 neighbor 10.10.3.1 update-source 10.10.2.1 neighbor 10.10.4.1 remote-as 65001 neighbor 10.10.4.1 update-source 10.10.2.1 neighbor 10.10.4.1 next-hop-self ip route vrf CW 10.10.1.2/32 10.10.255.1 router bgp 65001 address-family ipv4 vrf CW network 10.10.24.0/24 neighbor 10.10.1.2 remote-as 65001 neighbor 10.10.1.2 update-source 10.10.2.2 exit-address-familys SW3:\nrouter bgp 65003 bgp router-id 10.10.3.1 neighbor 10.10.1.1 remote-as 65001 neighbor 10.10.1.1 ebgp-multihop 255 neighbor 10.10.1.1 update-source 10.10.3.1 neighbor 10.10.2.1 remote-as 65001 neighbor 10.10.2.1 ebgp-multihop 255 neighbor 10.10.2.1 update-source 10.10.3.1 RT1:\nrouter bgp 65001 bgp router-id 10.10.4.1 neighbor 10.10.1.1 remote-as 65001 neighbor 10.10.1.1 update-source Loopback1 neighbor 10.10.1.1 next-hop-self neighbor 10.10.2.1 remote-as 65001 neighbor 10.10.2.1 update-source Loopback1 neighbor 10.10.2.1 next-hop-self neighbor 10.10.5.1 remote-as 65002 neighbor 10.10.5.1 ebgp-multihop 255 neighbor 10.10.5.1 update-source Loopback1 RT2:\nrouter bgp 65002 bgp router-id 10.10.5.1 neighbor 10.10.4.1 remote-as 65001 neighbor 10.10.4.1 ebgp-multihop 255 neighbor 10.10.4.1 update-source Loopback1 (2)SW1ã€SW2ã€SW3ã€RT2 åˆ†åˆ«åªå‘å¸ƒè¥é”€ã€æ³•åŠ¡ã€è´¢åŠ¡ã€äººåŠ›ç­‰ ipv4è·¯ç”±ï¼›RT1 å‘å¸ƒåŠäº‹å¤„è¥é”€ ipv4è·¯ç”±åˆ° BGPã€‚\nSW1:\nrouter bgp 65001 network 10.10.12.0/24 network 10.10.13.0/24 network 10.10.15.0/24 SW2:\nrouter bgp 65001 network 10.10.22.0/24 network 10.10.23.0/24 network 10.10.25.0/24 SW3:\nrouter bgp 65003 network 10.10.32.0/24 network 10.10.33.0/24 network 10.10.35.0/24 RT2:\nrouter bgp 65002 network 10.17.120.0/24 RT1:\nrouter bgp 65001 redistribute ospf 2 route-map BGP ! route-map BGP 10 permit match ip address prefix-list BGP ! ip prefix-list BGP seq 5 permit 10.16.120.0/24 (3)SW3 è¥é”€åˆ†åˆ«ä¸ SW1 å’Œ SW2 è¥é”€ ipv4äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW1 é“¾è·¯ è½¬å‘ï¼›SW3 æ³•åŠ¡åŠäººåŠ›åˆ†åˆ«ä¸ SW1 å’Œ SW2 æ³•åŠ¡åŠäººåŠ› ipv4äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW2 é“¾è·¯è½¬å‘ï¼Œä¸»å¤‡é“¾è·¯ç›¸äº’å¤‡ä»½ï¼›ç”¨ prefix-listã€route-map å’Œ BGP è·¯ å¾„å±æ€§è¿›è¡Œé€‰è·¯ï¼Œæ–°å¢ AS 65000ã€‚\nSW1:\nrouter bgp 65001 neighbor 10.10.3.1 route-map R\u0026F in ! route-map R\u0026F permit 10 match ip address prefix-list R\u0026F set as-path prepend 65000 ! route-map R\u0026F permit 20 ! ip prefix-list R\u0026F seq 5 permit 10.10.35.0/24 ip prefix-list R\u0026F seq 10 permit 10.10.33.0/24 SW2:\nrouter bgp 65001 neighbor 10.10.3.1 route-map R\u0026F in ! route-map R\u0026F permit 10 match ip address prefix-list R\u0026F set as-path prepend 65000 ! route-map R\u0026F permit 20 ! ip prefix-list R\u0026F seq 5 permit 10.10.32.0/24 SW3:\nrouter bgp 65003 neighbor 10.10.1.1 route-map R\u0026F in neighbor 10.10.2.1 route-map YX in ! route-map R\u0026F permit 10 match ip address prefix-list R\u0026F set as-path prepend 65000 ! route-map R\u0026F permit 20 ! route-map YX permit 10 match ip address prefix-list YX set as-path prepend 65000 ! route-map YX permit 20 ! ip prefix-list R\u0026F seq 5 permit 10.10.13.0/24 ip prefix-list R\u0026F seq 10 permit 10.10.23.0/24 ip prefix-list R\u0026F seq 15 permit 10.10.15.0/24 ip prefix-list R\u0026F seq 20 permit 10.10.25.0/24 ip prefix-list YX seq 5 permit 10.10.12.0/24 ip prefix-list YX seq 10 permit 10.10.22.0/24 ip prefix-list YX seq 15 permit 10.16.120.0/24 ip prefix-list YX seq 20 permit 10.17.120.0/24 è·¯ç”±è¡¨ï¼š\nSW1:\nSW1(config)#sho ip route bgp B 10.10.22.0/24 [200/0] via 10.10.2.1 (recursive via 10.10.255.2, Vlan1026), 01:01:28 tag:0 B 10.10.23.0/24 [200/0] via 10.10.2.1 (recursive via 10.10.255.2, Vlan1026), 01:01:28 tag:0 B 10.10.25.0/24 [200/0] via 10.10.2.1 (recursive via 10.10.255.2, Vlan1026), 01:01:28 tag:0 B 10.10.32.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.6, Vlan1022), 01:00:34 tag:0 B 10.10.33.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.6, Vlan1022), 01:00:34 tag:0 B 10.10.35.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.6, Vlan1022), 01:00:34 tag:0 B 10.16.120.0/24 [200/3] via 10.10.4.1 (recursive via 10.10.255.2, Vlan1026), 01:00:43 tag:0 Total routes are : 7 item(s) SW2:\nSW2#sho ip route bgp B 10.10.12.0/24 [200/0] via 10.10.1.1 (recursive via 10.10.255.1, Vlan1026), 01:01:42 tag:0 B 10.10.13.0/24 [200/0] via 10.10.1.1 (recursive via 10.10.255.1, Vlan1026), 01:01:42 tag:0 B 10.10.15.0/24 [200/0] via 10.10.1.1 (recursive via 10.10.255.1, Vlan1026), 01:01:42 tag:0 B 10.10.32.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.10, Vlan1022), 01:01:00 tag:0 B 10.10.33.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.10, Vlan1022), 01:01:00 tag:0 B 10.10.35.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.10, Vlan1022), 01:01:00 tag:0 B 10.16.120.0/24 [200/3] via 10.10.4.1 (recursive via 10.10.255.21, Vlan1021), 01:00:55 tag:0 Total routes are : 7 item(s) SW3:\nSW3#sho ip bgp BGP table version is 4, local router ID is 10.10.3.1 Status codes: s suppressed, d damped, h history, * valid, \u003e best, i - internal, S Stale Origin codes: i - IGP, e - EGP, ? - incomplete Network Next Hop Metric LocPrf Weight Path * 10.10.12.0/24 10.10.1.1 0 65001 i * 10.10.2.1 0 65001 i * 10.10.2.1 0 65000 65001 i *\u003e 10.10.1.1 0 65001 i * 10.10.13.0/24 10.10.1.1 0 65001 i * 10.10.2.1 0 65001 i *\u003e 10.10.2.1 0 65001 i * 10.10.1.1 0 65000 65001 i * 10.10.15.0/24 10.10.1.1 0 65001 i * 10.10.2.1 0 65001 i *\u003e 10.10.2.1 0 65001 i * 10.10.1.1 0 65000 65001 i * 10.10.22.0/24 10.10.2.1 0 65001 i * 10.10.2.1 0 65000 65001 i * 10.10.1.1 0 65001 i *\u003e 10.10.1.1 0 65001 i * 10.10.23.0/24 10.10.2.1 0 65001 i * 10.10.2.1 0 65001 i * 10.10.1.1 0 65000 65001 i *\u003e 10.10.1.1 0 65001 i * 10.10.25.0/24 10.10.2.1 0 65001 i * 10.10.2.1 0 65001 i * 10.10.1.1 0 65000 65001 i *\u003e 10.10.1.1 0 65001 i *\u003e 10.10.32.0/24 0.0.0.0 32768 i *\u003e 10.10.33.0/24 0.0.0.0 32768 i *\u003e 10.10.35.0/24 0.0.0.0 32768 i * 10.16.120.0/24 10.10.2.1 0 65001 ? * 10.10.2.1 0 65000 65001 ? * 10.10.1.1 0 65001 ? *\u003e 10.10.1.1 0 65001 ? * 10.17.120.0/24 10.10.2.1 0 65001 65002 i * 10.10.2.1 0 65000 65001 65002 i * 10.10.1.1 0 65001 65002 i *\u003e 10.10.1.1 0 65001 65002 i Total number of prefixes 11 RT1:\nRT1#sho ip route bgp VRF ID: 0 B 10.10.12.0/24 [200,0] via 10.10.1.1 B 10.10.13.0/24 [200,0] via 10.10.1.1 B 10.10.15.0/24 [200,0] via 10.10.1.1 B 10.10.22.0/24 [200,0] via 10.10.2.1 B 10.10.23.0/24 [200,0] via 10.10.2.1 B 10.10.25.0/24 [200,0] via 10.10.2.1 B 10.10.32.0/24 [200,0] via 10.10.2.1 B 10.10.33.0/24 [200,0] via 10.10.2.1 B 10.10.35.0/24 [200,0] via 10.10.2.1 B 10.17.120.0/24 [20,2] via 10.10.5.1 RT2:\nRT2#sho ip route bgp VRF ID: 0 B 10.10.12.0/24 [20,0] via 10.10.4.1 B 10.10.13.0/24 [20,0] via 10.10.4.1 B 10.10.15.0/24 [20,0] via 10.10.4.1 B 10.10.22.0/24 [20,0] via 10.10.4.1 B 10.10.23.0/24 [20,0] via 10.10.4.1 B 10.10.25.0/24 [20,0] via 10.10.4.1 B 10.10.32.0/24 [20,0] via 10.10.4.1 B 10.10.33.0/24 [20,0] via 10.10.4.1 B 10.10.35.0/24 [20,0] via 10.10.4.1 B 10.16.120.0/24 [20,3] via 10.10.4.1 ipv6 BGP (1)SW1ã€SW2ã€SW3ã€RT1ã€RT2 ä¹‹é—´é€šè¿‡ loopback1 å»ºç«‹ipv6 BGP é‚» å±…ã€‚SW1 å’Œ SW2 ä¹‹é—´è´¢åŠ¡é€šè¿‡ loopback2 å»ºç«‹ ipv4 BGP é‚»å±…ï¼ŒSW1 å’Œ SW2 çš„ loopback2 äº’é€šé‡‡ç”¨é™æ€è·¯ç”±ã€‚\nSW1:\nrouter bgp 65001 neighbor 2001:10:10:2::1 remote-as 65001 neighbor 2001:10:10:2::1 update-source 2001:10:10:1::1 neighbor 2001:10:10:3::1 remote-as 65003 neighbor 2001:10:10:3::1 ebgp-multihop 255 neighbor 2001:10:10:3::1 update-source 2001:10:10:1::1 neighbor 2001:10:10:4::1 remote-as 65001 neighbor 2001:10:10:4::1 update-source 2001:10:10:1::1 address-family ipv6 unicast neighbor 2001:10:10:2::1 activate neighbor 2001:10:10:2::1 next-hop-self neighbor 2001:10:10:3::1 activate neighbor 2001:10:10:4::1 activate neighbor 2001:10:10:4::1 next-hop-self SW2:\nrouter bgp 65001 neighbor 2001:10:10:1::1 remote-as 65001 neighbor 2001:10:10:1::1 update-source 2001:10:10:2::1 neighbor 2001:10:10:3::1 remote-as 65003 neighbor 2001:10:10:3::1 ebgp-multihop 255 neighbor 2001:10:10:3::1 update-source 2001:10:10:2::1 neighbor 2001:10:10:4::1 remote-as 65001 neighbor 2001:10:10:4::1 update-source 2001:10:10:2::1 address-family ipv6 unicast neighbor 2001:10:10:1::1 activate neighbor 2001:10:10:1::1 next-hop-self neighbor 2001:10:10:3::1 activate neighbor 2001:10:10:4::1 activate neighbor 2001:10:10:4::1 next-hop-self SW3:\nrouter bgp 65003 neighbor 2001:10:10:1::1 remote-as 65001 neighbor 2001:10:10:1::1 ebgp-multihop 255 neighbor 2001:10:10:1::1 update-source 2001:10:10:3::1 neighbor 2001:10:10:2::1 remote-as 65001 neighbor 2001:10:10:2::1 ebgp-multihop 255 neighbor 2001:10:10:2::1 update-source 2001:10:10:3::1 address-family ipv6 unicast neighbor 2001:10:10:1::1 activate neighbor 2001:10:10:2::1 activate RT1:\nrouter bgp 65001 neighbor 2001:10:10:1::1 remote-as 65001 neighbor 2001:10:10:1::1 update-source Loopback1 neighbor 2001:10:10:1::1 next-hop-self neighbor 2001:10:10:2::1 remote-as 65001 neighbor 2001:10:10:2::1 update-source Loopback1 neighbor 2001:10:10:2::1 next-hop-self neighbor 2001:10:10:5::1 remote-as 65002 neighbor 2001:10:10:5::1 ebgp-multihop 255 neighbor 2001:10:10:5::1 update-source Loopback1 address-family ipv6 neighbor 2001:10:10:1::1 activate neighbor 2001:10:10:1::1 next-hop-self neighbor 2001:10:10:2::1 activate neighbor 2001:10:10:2::1 next-hop-self neighbor 2001:10:10:5::1 activate RT2:\nrouter bgp 65002 neighbor 2001:10:10:4::1 remote-as 65001 neighbor 2001:10:10:4::1 ebgp-multihop 255 neighbor 2001:10:10:4::1 update-source Loopback1 address-family ipv6 (2)SW1ã€SW2ã€SW3ã€RT2 åˆ†åˆ«åªå‘å¸ƒè¥é”€ã€æ³•åŠ¡ã€è´¢åŠ¡ã€äººåŠ›ç­‰ipv6 è·¯ç”±ï¼›RT1 å‘å¸ƒåŠäº‹å¤„è¥é”€å’Œ ipv6 è·¯ç”±åˆ° BGPã€‚\nSW1:\nrouter bgp 65001 address-family ipv6 unicast network 2001:10:10:12::/64 network 2001:10:10:13::/64 network 2001:10:10:15::/64 SW2:\nrouter bgp 65001 address-family ipv6 unicast network 2001:10:10:22::/64 network 2001:10:10:23::/64 network 2001:10:10:25::/64 SW3:\nrouter bgp 65003 address-family ipv6 unicast network 2001:10:10:32::/64 network 2001:10:10:33::/64 network 2001:10:10:35::/64 RT2:\nrouter bgp 65002 address-family ipv6 network 2001:10:17:120::/64 RT1:\nrouter bgp 65001 address-family ipv6 redistribute ospf 2 match external 2 route-map BGPV6 ! route-map BGPV6 10 permit match ipv6 address prefix-list BGPV6 ! ipv6 prefix-list BGPV6 seq 5 permit 2001:10:16:120::/64 (3)SW3 è¥é”€åˆ†åˆ«ä¸ SW1 å’Œ SW2 è¥é”€ipv6 äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW1 é“¾è·¯ è½¬å‘ï¼›SW3 æ³•åŠ¡åŠäººåŠ›åˆ†åˆ«ä¸ SW1 å’Œ SW2 æ³•åŠ¡åŠäººåŠ›ipv6 äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW2 é“¾è·¯è½¬å‘ï¼Œä¸»å¤‡é“¾è·¯ç›¸äº’å¤‡ä»½ï¼›ç”¨ prefix-listã€route-map å’Œ BGP è·¯ å¾„å±æ€§è¿›è¡Œé€‰è·¯ï¼Œæ–°å¢ AS 65000ã€‚\nSW1:\nrouter bgp 65001 address-family ipv6 unicast neighbor 2001:10:10:3::1 route-map R\u0026FV6 in ! route-map R\u0026FV6 permit 10 match ipv6 address prefix-list R\u0026FV6 set as-path prepend 65000 ! route-map R\u0026FV6 permit 20 ! ipv6 prefix-list R\u0026FV6 seq 5 permit 2001:10:10:33::/64 ipv6 prefix-list R\u0026FV6 seq 10 permit 2001:10:10:35::/64 SW2:\nrouter bgp 65001 address-family ipv6 unicast neighbor 2001:10:10:3::1 route-map R\u0026FV6 in ! route-map R\u0026FV6 permit 10 match ipv6 address prefix-list R\u0026FV6 set as-path prepend 65000 ! route-map R\u0026FV6 permit 20 ! ipv6 prefix-list R\u0026FV6 seq 5 permit 2001:10:10:32::/64 SW3:\nrouter bgp 65003 address-family ipv6 unicast neighbor 2001:10:10:1::1 route-map R\u0026FV6 in neighbor 2001:10:10:2::1 route-map YXV6 in ! route-map R\u0026FV6 permit 10 match ipv6 address prefix-list R\u0026FV6 set as-path prepend 65000 ! route-map R\u0026FV6 permit 20 ! route-map YXV6 permit 10 match ipv6 address prefix-list YXV6 set as-path prepend 65000 ! route-map YXV6 permit 20 ! ipv6 prefix-list R\u0026FV6 seq 5 permit 2001:10:10:13::/64 ipv6 prefix-list R\u0026FV6 seq 10 permit 2001:10:10:23::/64 ipv6 prefix-list R\u0026FV6 seq 15 permit 2001:10:10:15::/64 ipv6 prefix-list R\u0026FV6 seq 20 permit 2001:10:10:25::/64 ipv6 prefix-list YXV6 seq 5 permit 2001:10:10:12::/64 ipv6 prefix-list YXV6 seq 10 permit 2001:10:10:22::/64 ipv6 prefix-list YXV6 seq 15 permit 2001:10:16:120::/64 ipv6 prefix-list YXV6 seq 20 permit 2001:10:17:120::/64 è·¯ç”±è¡¨ï¼š\nSW1:\nSW1(config)#sho ipv route nsm bgp IPv6 Routing Table Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF, I - IS-IS, B - BGP Timers: Uptime B 2001:10:10:22::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:07:05 tag:0 B 2001:10:10:23::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:07:05 tag:0 B 2001:10:10:25::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:07:05 tag:0 B 2001:10:10:32::/64 [20/0] via 2001:10:10:3::1 (recursive via fe80::203:fff:fee0:f9b8, Vlan10), 01:06:02 tag:0 B 2001:10:10:33::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:06:17 tag:0 B 2001:10:10:35::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:06:17 tag:0 B 2001:10:16:120::/64 [200/20] via 2001:10:10:4::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:05:18 tag:0 SW2:\nSW2#sho ipv route nsm bgp IPv6 Routing Table Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF, I - IS-IS, B - BGP Timers: Uptime B 2001:10:10:12::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:07:22 tag:0 B 2001:10:10:13::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:07:22 tag:0 B 2001:10:10:15::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:07:22 tag:0 B 2001:10:10:32::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:06:17 tag:0 B 2001:10:10:33::/64 [20/0] via 2001:10:10:3::1 (recursive via fe80::203:fff:fee0:f9b8, Vlan1022), 01:06:34 tag:0 B 2001:10:10:35::/64 [20/0] via 2001:10:10:3::1 (recursive via fe80::203:fff:fee0:f9b8, Vlan1022), 01:06:34 tag:0 B 2001:10:16:120::/64 [200/20] via 2001:10:10:4::1 (recursive via fe80::203:fff:fedc:c392, Vlan1021), 01:06:37 tag:0 SW3:\nSW3#sho ipv route nsm bgp IPv6 Routing Table Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF, I - IS-IS, B - BGP Timers: Uptime B 2001:10:10:12::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:04:16 tag:0 B 2001:10:10:13::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43 tag:0 B 2001:10:10:15::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43 tag:0 B 2001:10:10:22::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:04:43 tag:0 B 2001:10:10:23::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43 tag:0 B 2001:10:10:25::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43 tag:0 B 2001:10:16:120::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:03:47 tag:0 B 2001:10:17:120::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:03:47 tag:0 RT1:\nRT1#sho ipv route bgp B 2001:10:10:12::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:1::1 B 2001:10:10:13::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:1::1 B 2001:10:10:15::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:1::1 B 2001:10:10:22::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:2::1 B 2001:10:10:23::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:2::1 B 2001:10:10:25::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:2::1 B 2001:10:10:32::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:1::1 B 2001:10:10:33::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:2::1 B 2001:10:10:35::/64[1] [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1) gate 2001:10:10:2::1 B 2001:10:17:120::/64[1] [20,2] via fe80::203:fff:fedc:c389(on GigaEthernet0/0) gate 2001:10:10:5::1 RT2:\nRT2#sho ipv route bgp B 2001:10:10:12::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:13::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:15::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:22::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:23::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:25::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:32::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:33::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:10:35::/64[1] [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 B 2001:10:16:120::/64[1] [20,20] via fe80::203:fff:fedc:c391(on GigaEthernet0/0) gate 2001:10:10:4::1 10ã€BGPã€MPLSã€VPN åˆ©ç”¨ BGP MPLS VPN æŠ€æœ¯ï¼ŒRT1 ä¸ RT2 ä»¥å¤ªé“¾è·¯é—´è¿è¡Œå¤šåè®®æ ‡ç­¾äº¤æ¢ã€ æ ‡ç­¾åˆ†å‘åè®®ã€‚RT1 ä¸ RT2 é—´åˆ›å»ºè´¢åŠ¡ VPN å®ä¾‹ï¼Œåç§°ä¸º CWï¼ŒRT1 çš„ RD å€¼ä¸º 1:1ï¼Œexport rt å€¼ä¸º 1:2ï¼Œimport rt å€¼ä¸º 2:1ï¼›RT2 çš„ RD å€¼ä¸º 2:2ã€‚é€šè¿‡ä¸¤ç«¯ loopback1 å»ºç«‹ VPN é‚»å±…ï¼Œåˆ†åˆ«å®ç°ä¸¤ç«¯ loopback5 ipv4 äº’é€šå’Œ ipv6 äº’é€šã€‚\nipv4 MPLS RT1:\nRT1_config#sho run ip vrf CW rd 1:1 route-target export 1:2 route-target import 2:1 interface Loopback5 ip vrf forwarding CW RT1_config#mpls ip RT1_config#mpls ldp router-id 10.10.4.1 RT1_config#int g0/0 RT1_config_g0/0#mpls ip RT1_config_g0/0#mpls ldp enable router bgp 65001 address-family vpnv4 neighbor 10.10.5.1 activate neighbor 10.10.5.1 send-community extended exit-address-family address-family ipv4 vrf CW no synchronization network 10.10.4.5/32 exit-address-family é…ç½®ç»“æœï¼š\nRT1_config#sho ip route vrf CW bgp VRF ID: 1 B 10.10.5.5/32 [20,0] via 10.10.5.1 RT2:\nRT2_config#sho run ip vrf CW rd 2:2 route-target export 2:1 route-target import 1:2 interface Loopback5 ip vrf forwarding CW RT2_config#mpls ip RT2_config#mpls ldp router-id 10.10.5.1 RT2_config#int g0/0 RT2_config_g0/0#mpls ip RT2_config_g0/0#mpls ldp enable router bgp 65002 address-family vpnv4 neighbor 10.10.4.1 activate neighbor 10.10.4.1 send-community extended exit-address-family address-family ipv4 vrf CW no synchronization network 10.10.5.5/32 exit-address-family é…ç½®ç»“æœï¼š\nRT2_config#sho ip route vr CW bgp VRF ID: 1 B 10.10.4.5/32 [20,0] via 10.10.4.1 ipv6 MPLS RT1:\nRT1_config#sho run ipv6 unicast-routing ipv6 vrf CW rd 1:1 route-target import 2:1 route-target export 1:2 interface Loopback5 ipv6 vrf forwarding CW router bgp 65001 address-family vpnv6 neighbor 10.10.5.1 activate neighbor 10.10.5.1 send-community extended exit-address-family address-family ipv6 vrf CW no synchronization network 2001:10:10:4::5/128 exit-address-family é…ç½®ç»“æœï¼š\nRT1_config#sho ipv route vrf CW bgp B 2001:10:10:5::5/128[1] [20,0] via ::ffff:10.10.255.30(on GigaEthernet0/0) gate ::ffff:10.10.5.1 (vrf_id: 0) RT2:\nRT2_config#sho run ipv6 unicast-routing ipv6 vrf CW rd 1:1 route-target import 1:2 route-target export 2:1 interface Loopback5 ipv6 vrf forwarding CW router bgp 65002 address-family vpnv6 neighbor 10.10.4.1 activate neighbor 10.10.4.1 send-community extended exit-address-family address-family ipv6 vrf CW no synchronization network 2001:10:10:5::5/128 exit-address-family é…ç½®ç»“æœï¼š\nRT2_config#sho ipv route vrf CW bgp B 2001:10:10:4::5/128[1] [20,0] via ::ffff:10.10.255.29(on GigaEthernet0/0) gate ::ffff:10.10.4.1 (vrf_id: 0) 11ã€PIM-SM ç»„æ’­ SW1ã€SW2ã€RT1ã€RT2ã€AC1 è¿è¡Œ PIM-SMï¼ŒRT1 loopback1 ä¸º c-bsr å’Œ crpï¼ŒRT2 è¿è¡Œ IGMPv3ï¼›SW1 äº§å“éƒ¨é—¨ï¼ˆPC1 æµ‹è¯•ï¼‰ç»ˆç«¯å¯ç”¨ç»„æ’­ï¼Œç”¨ VLC å·¥å…·ä¸² æµæ’­æ”¾è§†é¢‘æ–‡ä»¶â€œ1.mp4â€ï¼Œæ¨¡æ‹Ÿç»„æ’­æºï¼Œè®¾ç½®æ­¤è§†é¢‘å¾ªç¯æ’­æ”¾ï¼Œç»„åœ°å€232.1.1.1ï¼Œ ç«¯å£ 1234ï¼Œå®ç°åˆ†å…¬å¸äº§å“éƒ¨é—¨ï¼ˆPC2 æµ‹è¯•ï¼‰æ”¶çœ‹è§†é¢‘ã€‚\nSW1:\nSW1(config)#ip pim multicast-routing Interface Ethernet1/0/21 ip dhcp snooping trust ipv6 dhcp snooping trust Interface Ethernet1/0/22 ip dhcp snooping trust ipv6 dhcp snooping trust Interface Ethernet1/0/26 ip dhcp snooping trust ipv6 dhcp snooping trust interface Vlan10 ip pim sparse-mode interface Vlan1026 ip pim sparse-mode SW2:\nSW2(config)#ip pim multicast-routing interface Vlan1021 ip pim sparse-mode interface Vlan1026 ip pim sparse-mode RT1:\nip multicast-routing router pim-sm reg-rate-limit 1 c-bsr l1 c-rp l1 interface Loopback1 ip pim-sm interface GigaEthernet0/0 ip pim-sm interface GigaEthernet0/1 ip pim-sm RT2:\nip multicast-routing router pim-sm reg-rate-limit 1 interface GigaEthernet0/0 ip pim-sm interface GigaEthernet0/1 ip pim-sm ip igmp enable AC1:\nip pim multicast-routing interface Vlan1001 ip pim sparse-mode interface Vlan110 ip pim sparse-mode ä¸‰ã€æ— çº¿é…ç½® 1ã€APä¸Šçº¿ï¼š wireless auto-ip-assign ap authentication mac discovery vlan-list 100 ap database 00-03-0f-8a-f8-b0 AC1(config-wireless)#sho wireless ap status MAC Address Configuration (*) Peer Managed IP Address Profile Status Status Age ------------------ --------------------------------------- ------- ------- ------------- -------------- 00-03-0f-8a-f8-b0 10.17.100.9 1 Managed Success 0d:00:00:01 Total Access Points............................ 1 2ã€åˆ›å»ºssid AC1 loopback1 ipv4 å’Œ ipv6 åœ°å€åˆ†åˆ«ä½œä¸º AC1 çš„ ipv4 å’Œ ipv6 ç®¡ç†åœ° å€ã€‚AP äºŒå±‚è‡ªåŠ¨æ³¨å†Œï¼ŒAP é‡‡ç”¨ MAC åœ°å€è®¤è¯ã€‚é…ç½® 2 ä¸ª ssidï¼Œåˆ†åˆ«ä¸º SKILLS2.4G å’Œ SKILLS-5Gã€‚SKILLS-2.4G å¯¹åº” vlan110ï¼Œç”¨ network 110 å’Œ radio1ï¼ˆæ¨¡ å¼ä¸º n-only-gï¼‰,ç”¨æˆ·æ¥å…¥æ— çº¿ç½‘ç»œæ—¶éœ€è¦é‡‡ç”¨åŸºäº WPA-personal åŠ å¯†æ–¹å¼ï¼Œ å¯†ç ä¸º Pass-1234ã€‚SKILLS-5G å¯¹åº” vlan120ï¼Œç”¨ network 120 å’Œ radio2ï¼ˆæ¨¡å¼ ä¸º n-only-aï¼‰ï¼Œä¸éœ€è¦è®¤è¯ï¼Œéšè— ssidï¼ŒSKILLS-5G ç”¨å€’æ•°ç¬¬ä¸€ä¸ªå¯ç”¨ VAP å‘é€ 5G ä¿¡å·ã€‚\nnetwork 110 security mode wpa-personal ssid SKILLS-2.4G vlan 110 wpa key Pass-1234 network 120 hide-ssid ssid SKILLS-5G vlan 120 ap profile 1 radio 1 mode n-only-g vap 0 network 110 radio 2 mode n-only-a vap 15 network 120 3ã€APè‡ªåŠ¨å‡çº§ å½“ AP ä¸Šçº¿ï¼Œå¦‚æœ AC ä¸­å‚¨å­˜çš„ Image ç‰ˆæœ¬å’Œ AP çš„ Image ç‰ˆæœ¬å·ä¸åŒæ—¶ï¼Œ ä¼šè§¦å‘ AP è‡ªåŠ¨å‡çº§ã€‚AP å¤±è´¥çŠ¶æ€è¶…æ—¶æ—¶é—´åŠæ¢æµ‹åˆ°çš„å®¢æˆ·ç«¯çŠ¶æ€è¶…æ—¶æ—¶é—´éƒ½ä¸º 2 å°æ—¶ã€‚\nAC1(config-wireless)#ap auto-upgrade AC1(config-wireless)#agetime ap-failure 2 AC1(config-wireless)#agetime detected-clients 4ã€é»‘åå•MACè®¤è¯æ¨¡å¼ MAC è®¤è¯æ¨¡å¼ä¸ºé»‘åå•ï¼ŒMAC åœ°å€ä¸º 80-45-DD-77-CC-48 çš„æ— çº¿ç»ˆç«¯é‡‡ç”¨ å…¨å±€é…ç½® MAC è®¤è¯ã€‚\nmac-authentication-mode black-list known-client 80-45-dd-77-cc-48 action global-action network 110 mac authentication local network 120 mac authentication local 5ã€é˜²æ­¢å¤š AP å’Œ AC ç›¸è¿æ—¶è¿‡å¤šçš„å®‰å…¨è®¤è¯è¿æ¥è€Œæ¶ˆè€— CPU èµ„æºï¼Œæ£€æµ‹åˆ° AP ä¸ AC 10 åˆ†é’Ÿå†…å»ºç«‹è¿æ¥ 5 æ¬¡å°±ä¸å†å…è®¸ç»§ç»­è¿æ¥ï¼Œ2 å°æ—¶åæ¢å¤æ­£å¸¸ã€‚ wireless ap anti-flood interval 10 wireless ap anti-flood max-conn-count 5 wireless ap anti-flood agetime 120 6ã€ç”¨æˆ·è®¿é—® Internet https é…ç½®vlan110æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šç­æ—¶é—´ï¼ˆå·¥ä½œæ—¥09:00-17:00ï¼‰è®¿é—®Internet https ä¸Šä¸‹è¡Œ CIR ä¸º 100Mbpsï¼ŒCBS ä¸º 200Mbpsï¼ŒPBS ä¸º 300Mbpsï¼Œexceed-action å’Œ violate-action å‡ä¸º dropã€‚æ—¶é—´èŒƒå›´åç§°ã€æ§åˆ¶åˆ—è¡¨åç§°ã€åˆ†ç±»åç§°ã€ç­–ç•¥ åç§°å‡ä¸º SKILLSã€‚\ntime-range SKILLS periodic weekdays 09:00:00 to 17:00:00 ip access-list extended SKILLS exit class-map SKILLS match access-group SKILLS policy-map SKILLS class SKILLS policy 100000 200000 300000 exceed-action drop violate-action drop exit network 110 client-qos enable client-qos diffserv-policy down SKILLS client-qos diffserv-policy up SKILLS 7ã€APç»„æ’­çªå‘é™åˆ¶ã€APå‘å°„åŠŸç‡ å¼€å¯ AP ç»„æ’­å¹¿æ’­çªå‘é™åˆ¶åŠŸèƒ½ï¼›AP æ”¶åˆ°é”™è¯¯å¸§æ—¶ï¼Œå°†ä¸å†å‘é€ ACK å¸§ï¼› AP å‘é€å‘æ— çº¿ç»ˆç«¯è¡¨æ˜ AP å­˜åœ¨çš„å¸§æ—¶é—´é—´éš”ä¸º 1 ç§’ã€‚AP å‘å°„åŠŸç‡ä¸º 80%ã€‚\nradio 1 rate-limit beacon-interval 1000 incorrect-frame-no-ack power default 80 radio 2 rate-limit beacon-interval 1000 incorrect-frame-no-ack power default 80 8ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šä¸‹è¡Œæœ€å¤§å¸¦å®½ä¸º8000Mkpsï¼Œarpä¸Šä¸‹è¡Œæœ€å¤§é€Ÿç‡ä¸º6packets/s client-qos bandwidth-limit down 800000 client-qos bandwidth-limit up 800000 client-qos bandwidth-limit arp down 6 client-qos bandwidth-limit arp up 6 9ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ç›¸äº’éš”ç¦»ï¼Œå¼€å¯ARPæŠ‘åˆ¶åŠŸèƒ½ï¼Œé™åˆ¶æ¯å¤©æ—©ä¸Š0ç‚¹åˆ°4ç‚¹ç¦æ­¢ç»ˆç«¯æ¥å…¥ station-isolation arp-suppression time-limit from 00:00 to 04:00 weekday all 10ã€ç‰¹æƒæ¨¡å¼ä¸‹å‘ï¼š AC1#wireless ap profile apply 1 All configurations will be send to the aps associated to this profile and associated clients on these aps will be disconnected. Because of work mode configurations, some aps associated to this profile will reboot. Are you sure you want to apply the profile configuration? [Y/N] y AP Profile apply is in progress. ",
  "wordCount" : "15657",
  "inLanguage": "en",
  "datePublished": "2023-07-14T09:14:15+08:00",
  "dateModified": "2023-07-14T09:14:15+08:00",
  "author":[{
    "@type": "Person",
    "name": "æœªæ·¼"
  }],
  "mainEntityOfPage": {
    "@type": "WebPage",
    "@id": "https://erain.fun/posts/tech/%E7%A5%9E%E5%B7%9E%E6%95%B0%E7%A0%81%E8%AE%BE%E5%A4%87%E7%9F%A5%E8%AF%86%E7%82%B9%E5%A4%87%E4%BB%BD/"
  },
  "publisher": {
    "@type": "Organization",
    "name": "æœªæ·¼çš„åšå®¢",
    "logo": {
      "@type": "ImageObject",
      "url": "https://erain.fun/img/Q.jpg"
    }
  }
}
</script>
    <script src="/css/64336ff59a.js" crossorigin="anonymous"></script>
</head>

<body class=" dark" id="top">

<header class="header">
    <nav class="nav">
        <div class="logo">
            <a href="https://erain.fun" accesskey="h" title="æœªæ·¼&#39;s Blog (Alt + H)">æœªæ·¼&#39;s Blog</a>
            <div class="logo-switches">
            </div>
        </div>
        <ul id="menu">
            <li>
                <a href="https://erain.fun/" title="é¦–é¡µ">
                    <span><i class='fas fa-home'>&nbsp;</i>é¦–é¡µ</span>
                </a>
            </li>
            <li>
                <a href="https://erain.fun/search" title="æœç´¢ (Alt &#43; /)" accesskey=/>
                    <span><i class='fas fa-search'>&nbsp;</i>æœç´¢</span>
                </a>
            </li>
            <li>
                <a href="https://erain.fun/archives/" title="å½’æ¡£">
                    <span><i class='fas fa-clock-rotate-left'>&nbsp;</i>å½’æ¡£</span>
                </a>
            </li>
            <li>
                <a href="https://erain.fun/itools.html" title="å·¥å…·ç«™">
                    <span><i class='fas fa-tools'>&nbsp;</i>å·¥å…·ç«™</span>
                </a>
            </li>
            <li>
                <a href="https://erain.fun/links" title="é“¾æ¥">
                    <span><i class='fas fa-link'></i>é“¾æ¥</span>
                </a>
            </li>
            <li>
                <a href="https://erain.fun/about" title="å…³äº">
                    <span><i class='fas fa-user-plus'>&nbsp;</i>å…³äº</span>
                </a>
            </li>
            <li>
                <a href="https://erain.fun/index.xml" title="RSS">
                    <span><i class='fas fa-rss'>&nbsp;</i>RSS</span>
                </a>
            </li>
        </ul>
    </nav>
</header>
<main class="main">

<article class="post-single">
  <header class="post-header">
    <div class="breadcrumbs"><a href="https://erain.fun">Home</a>&nbsp;Â»&nbsp;<a href="https://erain.fun/posts/">â€œæ–‡ç« â€</a>&nbsp;Â»&nbsp;<a href="https://erain.fun/posts/tech/">â€œæŠ€æœ¯åˆ†äº«â€</a></div>
    <h1 class="post-title entry-hint-parent">
      ç¥å·æ•°ç è®¾å¤‡çŸ¥è¯†ç‚¹å¤‡ä»½
    </h1>
    <div class="post-meta"><span title='2023-07-14 09:14:15 +0800 CST'>2023å¹´7æœˆ14æ—¥</span>&nbsp;|&nbsp;æœªæ·¼





</div>
  </header> <aside id="toc-container" class="toc-container wide">
    <div class="toc">
        <details  open>
            <summary accesskey="c" title="(Alt + C)">
                <span class="details">Table of Contents</span>
            </summary>

            <div class="inner"><ul>
                    <li>
                        <a href="#%e4%b8%80%e4%ba%a4%e6%8d%a2%e6%9c%ba%e9%85%8d%e7%bd%ae" aria-label="ä¸€ã€äº¤æ¢æœºé…ç½®">ä¸€ã€äº¤æ¢æœºé…ç½®</a><ul>
                            
                    <li>
                        <a href="#1%e7%94%9f%e6%88%90%e6%a0%91spanning-tree" aria-label="1ã€ç”Ÿæˆæ ‘spanning-tree">1ã€ç”Ÿæˆæ ‘spanning-tree</a></li>
                    <li>
                        <a href="#2%e9%93%be%e8%b7%af%e8%81%9a%e5%90%88lacp" aria-label="2ã€é“¾è·¯èšåˆLACP">2ã€é“¾è·¯èšåˆLACP</a></li>
                    <li>
                        <a href="#3%e8%b7%af%e7%94%b1%e8%a1%a8%e9%9a%94%e7%a6%bbvpn" aria-label="3ã€è·¯ç”±è¡¨éš”ç¦»VPN">3ã€è·¯ç”±è¡¨éš”ç¦»VPN</a></li>
                    <li>
                        <a href="#4%e7%ab%af%e5%8f%a3%e5%ae%89%e5%85%a8" aria-label="4ã€ç«¯å£å®‰å…¨">4ã€ç«¯å£å®‰å…¨</a></li>
                    <li>
                        <a href="#5%e5%bc%80%e5%90%af%e6%97%a5%e5%bf%97%e8%ae%b0%e5%bd%95%e4%bf%9d%e6%8a%a4%e5%8a%9f%e8%83%bd" aria-label="5ã€å¼€å¯æ—¥å¿—è®°å½•&amp;amp;ä¿æŠ¤åŠŸèƒ½">5ã€å¼€å¯æ—¥å¿—è®°å½•&amp;ä¿æŠ¤åŠŸèƒ½</a></li>
                    <li>
                        <a href="#6snmp" aria-label="6ã€SNMP">6ã€SNMP</a></li>
                    <li>
                        <a href="#7%e4%ba%92%e8%81%94%e6%b5%81%e9%87%8f%e9%95%9c%e5%83%8f" aria-label="7ã€äº’è”æµé‡é•œåƒ">7ã€äº’è”æµé‡é•œåƒ</a></li>
                    <li>
                        <a href="#8uldp" aria-label="8ã€ULDP">8ã€ULDP</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%ba%8c%e8%b7%af%e7%94%b1%e9%85%8d%e7%bd%ae" aria-label="äºŒã€è·¯ç”±é…ç½®">äºŒã€è·¯ç”±é…ç½®</a><ul>
                            
                    <li>
                        <a href="#1ssh%e6%9c%8d%e5%8a%a1" aria-label="1ã€SSHæœåŠ¡">1ã€SSHæœåŠ¡</a></li>
                    <li>
                        <a href="#2%e9%85%8d%e7%bd%ae%e6%97%b6%e5%8c%ba" aria-label="2ã€é…ç½®æ—¶åŒº">2ã€é…ç½®æ—¶åŒº</a></li>
                    <li>
                        <a href="#3vrrp" aria-label="3ã€VRRP">3ã€VRRP</a><ul>
                            
                    <li>
                        <a href="#vrrpv2" aria-label="VRRPv2">VRRPv2</a></li>
                    <li>
                        <a href="#vrrpv3" aria-label="VRRPv3">VRRPv3</a></li></ul>
                    </li>
                    <li>
                        <a href="#4dhcp%e6%9c%8d%e5%8a%a1" aria-label="4ã€DHCPæœåŠ¡">4ã€DHCPæœåŠ¡</a><ul>
                            
                    <li>
                        <a href="#dhcp%e4%b8%ad%e7%bb%a7" aria-label="DHCPä¸­ç»§ï¼š">DHCPä¸­ç»§ï¼š</a></li>
                    <li>
                        <a href="#dhcp-snooping" aria-label="DHCP snooping">DHCP snooping</a></li></ul>
                    </li>
                    <li>
                        <a href="#5ospf" aria-label="5ã€OSPF">5ã€OSPF</a><ul>
                            
                    <li>
                        <a href="#ospfv2" aria-label="OSPFv2">OSPFv2</a></li>
                    <li>
                        <a href="#ospfv3" aria-label="OSPFv3">OSPFv3</a></li></ul>
                    </li>
                    <li>
                        <a href="#6rip" aria-label="6ã€RIP">6ã€RIP</a><ul>
                            
                    <li>
                        <a href="#ripng" aria-label="RIPng">RIPng</a></li>
                    <li>
                        <a href="#chap%e5%8f%8c%e5%90%91%e8%ae%a4%e8%af%81" aria-label="chapåŒå‘è®¤è¯">chapåŒå‘è®¤è¯</a></li></ul>
                    </li>
                    <li>
                        <a href="#7isis" aria-label="7ã€ISIS">7ã€ISIS</a></li>
                    <li>
                        <a href="#8nat" aria-label="8ã€nat">8ã€nat</a></li>
                    <li>
                        <a href="#9bgp" aria-label="9ã€BGP">9ã€BGP</a><ul>
                            
                    <li>
                        <a href="#ipv4-bgp" aria-label="ipv4 BGP"><strong>ipv4 BGP</strong></a></li>
                    <li>
                        <a href="#ipv6-bgp" aria-label="ipv6 BGP"><strong>ipv6 BGP</strong></a></li></ul>
                    </li>
                    <li>
                        <a href="#10bgpmplsvpn" aria-label="10ã€BGPã€MPLSã€VPN">10ã€BGPã€MPLSã€VPN</a><ul>
                            
                    <li>
                        <a href="#ipv4-mpls" aria-label="ipv4 MPLS"><strong>ipv4 MPLS</strong></a></li>
                    <li>
                        <a href="#ipv6-mpls" aria-label="ipv6 MPLS"><strong>ipv6 MPLS</strong></a></li></ul>
                    </li>
                    <li>
                        <a href="#11pim-sm-%e7%bb%84%e6%92%ad" aria-label="11ã€PIM-SM ç»„æ’­">11ã€PIM-SM ç»„æ’­</a></li></ul>
                    </li>
                    <li>
                        <a href="#%e4%b8%89%e6%97%a0%e7%ba%bf%e9%85%8d%e7%bd%ae" aria-label="ä¸‰ã€æ— çº¿é…ç½®">ä¸‰ã€æ— çº¿é…ç½®</a><ul>
                            
                    <li>
                        <a href="#1ap%e4%b8%8a%e7%ba%bf" aria-label="1ã€APä¸Šçº¿ï¼š">1ã€APä¸Šçº¿ï¼š</a></li>
                    <li>
                        <a href="#2%e5%88%9b%e5%bb%bassid" aria-label="2ã€åˆ›å»ºssid">2ã€åˆ›å»ºssid</a></li>
                    <li>
                        <a href="#3ap%e8%87%aa%e5%8a%a8%e5%8d%87%e7%ba%a7" aria-label="3ã€APè‡ªåŠ¨å‡çº§">3ã€APè‡ªåŠ¨å‡çº§</a></li>
                    <li>
                        <a href="#4%e9%bb%91%e5%90%8d%e5%8d%95mac%e8%ae%a4%e8%af%81%e6%a8%a1%e5%bc%8f" aria-label="4ã€é»‘åå•MACè®¤è¯æ¨¡å¼">4ã€é»‘åå•MACè®¤è¯æ¨¡å¼</a></li>
                    <li>
                        <a href="#5%e9%98%b2%e6%ad%a2%e5%a4%9a-ap-%e5%92%8c-ac-%e7%9b%b8%e8%bf%9e%e6%97%b6%e8%bf%87%e5%a4%9a%e7%9a%84%e5%ae%89%e5%85%a8%e8%ae%a4%e8%af%81%e8%bf%9e%e6%8e%a5%e8%80%8c%e6%b6%88%e8%80%97-cpu-%e8%b5%84%e6%ba%90%e6%a3%80%e6%b5%8b%e5%88%b0-ap-%e4%b8%8e-ac-10-%e5%88%86%e9%92%9f%e5%86%85%e5%bb%ba%e7%ab%8b%e8%bf%9e%e6%8e%a5-5-%e6%ac%a1%e5%b0%b1%e4%b8%8d%e5%86%8d%e5%85%81%e8%ae%b8%e7%bb%a7%e7%bb%ad%e8%bf%9e%e6%8e%a52-%e5%b0%8f%e6%97%b6%e5%90%8e%e6%81%a2%e5%a4%8d%e6%ad%a3%e5%b8%b8" aria-label="5ã€é˜²æ­¢å¤š AP å’Œ AC ç›¸è¿æ—¶è¿‡å¤šçš„å®‰å…¨è®¤è¯è¿æ¥è€Œæ¶ˆè€— CPU èµ„æºï¼Œæ£€æµ‹åˆ° AP ä¸ AC 10 åˆ†é’Ÿå†…å»ºç«‹è¿æ¥ 5 æ¬¡å°±ä¸å†å…è®¸ç»§ç»­è¿æ¥ï¼Œ2 å°æ—¶åæ¢å¤æ­£å¸¸ã€‚">5ã€é˜²æ­¢å¤š AP å’Œ AC ç›¸è¿æ—¶è¿‡å¤šçš„å®‰å…¨è®¤è¯è¿æ¥è€Œæ¶ˆè€— CPU èµ„æºï¼Œæ£€æµ‹åˆ° AP ä¸ AC 10 åˆ†é’Ÿå†…å»ºç«‹è¿æ¥ 5 æ¬¡å°±ä¸å†å…è®¸ç»§ç»­è¿æ¥ï¼Œ2 å°æ—¶åæ¢å¤æ­£å¸¸ã€‚</a></li>
                    <li>
                        <a href="#6%e7%94%a8%e6%88%b7%e8%ae%bf%e9%97%ae-internet--https" aria-label="6ã€ç”¨æˆ·è®¿é—® Internet  https">6ã€ç”¨æˆ·è®¿é—® Internet  https</a></li>
                    <li>
                        <a href="#7ap%e7%bb%84%e6%92%ad%e7%aa%81%e5%8f%91%e9%99%90%e5%88%b6ap%e5%8f%91%e5%b0%84%e5%8a%9f%e7%8e%87" aria-label="7ã€APç»„æ’­çªå‘é™åˆ¶ã€APå‘å°„åŠŸç‡">7ã€APç»„æ’­çªå‘é™åˆ¶ã€APå‘å°„åŠŸç‡</a></li>
                    <li>
                        <a href="#8%e9%85%8d%e7%bd%aevlan140%e6%97%a0%e7%ba%bf%e6%8e%a5%e5%85%a5%e7%94%a8%e6%88%b7%e4%b8%8a%e4%b8%8b%e8%a1%8c%e6%9c%80%e5%a4%a7%e5%b8%a6%e5%ae%bd%e4%b8%ba8000mkpsarp%e4%b8%8a%e4%b8%8b%e8%a1%8c%e6%9c%80%e5%a4%a7%e9%80%9f%e7%8e%87%e4%b8%ba6packetss" aria-label="8ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šä¸‹è¡Œæœ€å¤§å¸¦å®½ä¸º8000Mkpsï¼Œarpä¸Šä¸‹è¡Œæœ€å¤§é€Ÿç‡ä¸º6packets/s">8ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šä¸‹è¡Œæœ€å¤§å¸¦å®½ä¸º8000Mkpsï¼Œarpä¸Šä¸‹è¡Œæœ€å¤§é€Ÿç‡ä¸º6packets/s</a></li>
                    <li>
                        <a href="#9%e9%85%8d%e7%bd%aevlan140%e6%97%a0%e7%ba%bf%e6%8e%a5%e5%85%a5%e7%94%a8%e6%88%b7%e7%9b%b8%e4%ba%92%e9%9a%94%e7%a6%bb%e5%bc%80%e5%90%afarp%e6%8a%91%e5%88%b6%e5%8a%9f%e8%83%bd%e9%99%90%e5%88%b6%e6%af%8f%e5%a4%a9%e6%97%a9%e4%b8%8a0%e7%82%b9%e5%88%b04%e7%82%b9%e7%a6%81%e6%ad%a2%e7%bb%88%e7%ab%af%e6%8e%a5%e5%85%a5" aria-label="9ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ç›¸äº’éš”ç¦»ï¼Œå¼€å¯ARPæŠ‘åˆ¶åŠŸèƒ½ï¼Œé™åˆ¶æ¯å¤©æ—©ä¸Š0ç‚¹åˆ°4ç‚¹ç¦æ­¢ç»ˆç«¯æ¥å…¥">9ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ç›¸äº’éš”ç¦»ï¼Œå¼€å¯ARPæŠ‘åˆ¶åŠŸèƒ½ï¼Œé™åˆ¶æ¯å¤©æ—©ä¸Š0ç‚¹åˆ°4ç‚¹ç¦æ­¢ç»ˆç«¯æ¥å…¥</a></li>
                    <li>
                        <a href="#10%e7%89%b9%e6%9d%83%e6%a8%a1%e5%bc%8f%e4%b8%8b%e5%8f%91" aria-label="10ã€ç‰¹æƒæ¨¡å¼ä¸‹å‘ï¼š"><strong>10ã€ç‰¹æƒæ¨¡å¼ä¸‹å‘ï¼š</strong></a>
                    </li>
                </ul>
                </li>
                </ul>
            </div>
        </details>
    </div>
</aside>
<script>
    let activeElement;
    let elements;
    window.addEventListener('DOMContentLoaded', function (event) {
        checkTocPosition();

        elements = document.querySelectorAll('h1[id],h2[id],h3[id],h4[id],h5[id],h6[id]');
         
         activeElement = elements[0];
         const id = encodeURI(activeElement.getAttribute('id')).toLowerCase();
         document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
     }, false);

    window.addEventListener('resize', function(event) {
        checkTocPosition();
    }, false);

    window.addEventListener('scroll', () => {
        
        activeElement = Array.from(elements).find((element) => {
            if ((getOffsetTop(element) - window.pageYOffset) > 0 &&
                (getOffsetTop(element) - window.pageYOffset) < window.innerHeight/2) {
                return element;
            }
        }) || activeElement

        elements.forEach(element => {
             const id = encodeURI(element.getAttribute('id')).toLowerCase();
             if (element === activeElement){
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.add('active');
             } else {
                 document.querySelector(`.inner ul li a[href="#${id}"]`).classList.remove('active');
             }
         })
     }, false);

    const main = parseInt(getComputedStyle(document.body).getPropertyValue('--article-width'), 10);
    const toc = parseInt(getComputedStyle(document.body).getPropertyValue('--toc-width'), 10);
    const gap = parseInt(getComputedStyle(document.body).getPropertyValue('--gap'), 10);

    function checkTocPosition() {
        const width = document.body.scrollWidth;

        if (width - main - (toc * 2) - (gap * 4) > 0) {
            document.getElementById("toc-container").classList.add("wide");
        } else {
            document.getElementById("toc-container").classList.remove("wide");
        }
    }

    function getOffsetTop(element) {
        if (!element.getClientRects().length) {
            return 0;
        }
        let rect = element.getBoundingClientRect();
        let win = element.ownerDocument.defaultView;
        return rect.top + win.pageYOffset;
    }
</script>


  <div class="post-content"><blockquote>
<p>ä»…ä½œä¸ºå¤‡ä»½æ–‡ä»¶
å¤‡ä»½æ—¶é—´ 2023.6.23</p>
</blockquote>
<h2 id="ä¸€äº¤æ¢æœºé…ç½®">ä¸€ã€äº¤æ¢æœºé…ç½®<a hidden class="anchor" aria-hidden="true" href="#ä¸€äº¤æ¢æœºé…ç½®">#</a></h2>
<h3 id="1ç”Ÿæˆæ ‘spanning-tree">1ã€ç”Ÿæˆæ ‘spanning-tree<a hidden class="anchor" aria-hidden="true" href="#1ç”Ÿæˆæ ‘spanning-tree">#</a></h3>
<p>SW1ã€SW2ã€SW3å¯ç”¨MSTPï¼Œå®ç°ç½‘ç»œäºŒå±‚è´Ÿè½½å‡è¡¡å’Œå†—ä½™å¤‡ä»½ï¼Œåˆ›å»ºå®ä¾‹Instance10å’ŒInstance20ï¼Œåç§°ä¸ºSKILLSï¼Œä¿®è®¢ç‰ˆæœ¬ä¸º1ï¼Œå…¶ä¸­Instance10å…³è”vlan60å’Œvlan70ï¼ŒInstance20å…³è”vlan80å’Œvlan90ã€‚SW1ä¸ºInstance0å’ŒInstance10çš„æ ¹äº¤æ¢æœºï¼Œä¸ºInstance20å¤‡ä»½æ ¹äº¤æ¢æœºï¼›SW2ä¸ºInstance20æ ¹äº¤æ¢æœºï¼Œä¸ºInstance0å’ŒInstance10çš„å¤‡ä»½æ ¹äº¤æ¢æœºï¼›æ ¹äº¤æ¢æœºSTPä¼˜å…ˆçº§ä¸º0ï¼Œå¤‡ä»½æ ¹äº¤æ¢æœºSTPä¼˜å…ˆçº§ä¸º4096ã€‚å…³é—­äº¤æ¢æœºä¹‹é—´ä¸‰å±‚äº’è”æ¥å£çš„STPã€‚</p>
<p>SW1:</p>
<pre><code>spanning-tree mst configuration
 name SKILLS
 revision-level 1
 instance 0 vlan 1-59;61-69;71-79;81-89;91-4094
 instance 10 vlan 60;70
 instance 20 vlan 80;90
 exit
!
spanning-tree
spanning-tree mst 0 priority 0
spanning-tree mst 10 priority 0
spanning-tree mst 20 priority 4096
Interface Ethernet1/0/22
 no spanning-tree
Interface Ethernet1/0/26
 no spanning-tree
</code></pre>
<p>SW2:</p>
<pre><code>spanning-tree mst configuration
 name SKILLS
 revision-level 1
 instance 0 vlan 1-59;61-69;71-79;81-89;91-4094
 instance 10 vlan 60;70
 instance 20 vlan 80;90
 exit
!
spanning-tree
spanning-tree mst 0 priority 4096
spanning-tree mst 10 priority 4096
spanning-tree mst 20 priority 0
Interface Ethernet1/0/22
 no spanning-tree
Interface Ethernet1/0/26
 no spanning-tree
</code></pre>
<p>SW3:</p>
<pre><code>spanning-tree mst configuration
 name SKILLS
 revision-level 1
 instance 0 vlan 1-59;61-69;71-79;81-89;91-4094
 instance 10 vlan 60;70
 instance 20 vlan 80;90
 exit
!
spanning-tree
Interface Ethernet1/0/21
 no spanning-tree
Interface Ethernet1/0/22
 no spanning-tree
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW3(config)#show spanning-tree 

*********************************** Process 0 ***********************************
                 -- MSTP Bridge Config Info --

Standard     :  IEEE 802.1s
Bridge MAC   :  00:03:0f:e0:f9:b9
Bridge Times :  Max Age 20, Hello Time 2, Forward Delay 15
Force Version:  3

########################### Instance 0 ###########################
Self Bridge Id   : 32768.00:03:0f:e0:f9:b9
Root Id          : 0.00:03:0f:e0:f9:b3
Ext.RootPathCost : 0
Region Root Id   : 0.00:03:0f:e0:f9:b3
Int.RootPathCost : 20000
Root Port ID     : 128.23
Current port list in Instance 0:  
Ethernet1/0/11 Ethernet1/0/12 Ethernet1/0/15 Ethernet1/0/17 Ethernet1/0/18
Ethernet1/0/23 Ethernet1/0/24 (Total 7)

   PortName           ID      ExtRPC   IntRPC  State Role     DsgBridge          DsgPort
-------------- ------------ --------- --------- ---  ---- ------------------ ------------
 Ethernet1/0/11   128.00011          0     20000 FWD  DSGN 32768.00030fe0f9b9   128.00011
 Ethernet1/0/12   128.00012          0     20000 FWD  DSGN 32768.00030fe0f9b9   128.00012
 Ethernet1/0/15   128.00015          0     20000 FWD  DSGN 32768.00030fe0f9b9   128.00015
 Ethernet1/0/17   128.00017          0     20000 FWD  DSGN 32768.00030fe0f9b9   128.00017
 Ethernet1/0/18   128.00018          0     20000 FWD  DSGN 32768.00030fe0f9b9   128.00018
 Ethernet1/0/23   128.00023          0         0 FWD  ROOT     0.00030fe0f9b3   128.00023
 Ethernet1/0/24   128.00024          0     20000 BLK  ALTR  4096.00030fe0f9b6   128.00023

########################### Instance 10 ###########################
Self Bridge Id   : 32768.00:03:0f:e0:f9:b9
Region Root Id   : 0.00:03:0f:e0:f9:b3
Int.RootPathCost : 20000
Root Port ID     : 128.23
Current port list in Instance 10:  
Ethernet1/0/23 Ethernet1/0/24 (Total 2)

   PortName           ID    IntRPC   State Role     DsgBridge          DsgPort
--------------- ------------ --------- ---  ---- ------------------ ----------
 Ethernet1/0/23   128.00023         0 FWD  ROOT     0.00030fe0f9b3   128.00023
 Ethernet1/0/24   128.00024     20000 BLK  ALTR  4096.00030fe0f9b6   128.00023

########################### Instance 20 ###########################
Self Bridge Id   : 32768.00:03:0f:e0:f9:b9
Region Root Id   : 0.00:03:0f:e0:f9:b6
Int.RootPathCost : 20000
Root Port ID     : 128.24
Current port list in Instance 20:  
Ethernet1/0/23 Ethernet1/0/24 (Total 2)

   PortName           ID    IntRPC   State Role     DsgBridge          DsgPort
--------------- ------------ --------- ---  ---- ------------------ ----------
 Ethernet1/0/23   128.00023     20000 BLK  ALTR  4096.00030fe0f9b3   128.00023
 Ethernet1/0/24   128.00024         0 FWD  ROOT     0.00030fe0f9b6   128.00023
</code></pre>
<h3 id="2é“¾è·¯èšåˆlacp">2ã€é“¾è·¯èšåˆLACP<a hidden class="anchor" aria-hidden="true" href="#2é“¾è·¯èšåˆlacp">#</a></h3>
<p>SW1 å’Œ SW2 ä¹‹é—´åˆ©ç”¨ä¸‰æ¡è£¸å…‰ç¼†å®ç°äº’é€šï¼Œå…¶ä¸­ä¸€æ¡è£¸å…‰ç¼†æ‰¿è½½ä¸‰å±‚ IPä¸šåŠ¡ã€ä¸€æ¡è£¸å…‰ç¼†æ‰¿è½½ VPN ä¸šåŠ¡ã€ä¸€æ¡è£¸å…‰ç¼†æ‰¿è½½äºŒå±‚ä¸šåŠ¡ã€‚ç”¨ç›¸å…³æŠ€æœ¯åˆ†åˆ«å®ç°è´¢åŠ¡ 1 æ®µã€è´¢åŠ¡ 2 æ®µä¸šåŠ¡è·¯ç”±è¡¨ä¸å…¶å®ƒä¸šåŠ¡è·¯ç”±è¡¨éš”ç¦»ï¼Œè´¢åŠ¡ä¸šåŠ¡ VPN å®ä¾‹åç§°ä¸º CWã€‚</p>
<p>SW1ï¼š</p>
<pre><code>SW1#sho ip vrf 
VRF CW, FIB ID 1
Router ID: 10.10.255.2 (automatic)
Interfaces:
  Vlan40
  Vlan1027
!

VRF CW; (id=1); RIP is not enabled

Name             Interfaces
CW               Vlan40 Vlan1027 

Name                    Default RD           Interfaces
CW                                           Vlan40
                                             Vlan1027

</code></pre>
<p>SW2ï¼š</p>
<pre><code>SW2#sho ip vrf 
VRF CW, FIB ID 1
Router ID: 10.10.255.2 (automatic)
Interfaces:
  Vlan40
  Vlan1027
!

VRF CW; (id=1); RIP is not enabled

Name             Interfaces
CW               Vlan40 Vlan1027 

Name                    Default RD           Interfaces
CW                                           Vlan40
                                             Vlan1027
</code></pre>
<p>æ‰¿è½½äºŒå±‚ä¸šåŠ¡çš„åªæœ‰ä¸€æ¡è£¸å…‰ç¼†é€šé“ï¼Œé…ç½®ç›¸å…³æŠ€æœ¯ï¼Œæ–¹ä¾¿åç»­é“¾è·¯æ‰©å®¹ä¸å†—ä½™å¤‡ä»½ï¼Œç¼–å·ä¸º 1ï¼Œç”¨ LACP åè®®ï¼ŒSW1 ä¸º activeï¼ŒSW2 ä¸º activeï¼›é‡‡ç”¨æºã€ç›®çš„ IP è¿›è¡Œå®ç°æµé‡è´Ÿè½½åˆ†æ‹…ã€‚</p>
<p>SW1ï¼š</p>
<pre><code>SW1(config)#port-group 1
SW1(config)#int e1/0/25;28                 
SW1(config-if-port-range)#port-group 1 mode active 
SW1(config-if-port-range)#exit
SW1(config)#load-balance dst-src-ip 
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1#sho port-group 1 detail 
Flags:  A -- LACP_Activity, B -- LACP_timeout, C -- Aggregation,
        D -- Synchronization, E -- Collecting, F -- Distributing,
        G -- Defaulted, H -- Expired

Port-group number: 1,  Mode: active,   Load-balance: dst-src-ip
 Port-group detail information:
 System ID: 0x8000,00-03-0f-e0-f9-b3
 Local:
  Port             Status      Priority  Oper-Key Flag      
  -----------------------------------------------------------
  Ethernet1/0/25   Unselected  32768     1        {ACG}
  Ethernet1/0/28   Selected    32768     1        {ACDEF}

 Remote:
  Actor           Partner  Priority  Oper-Key SystemID                    Flag      
  --------------------------------------------------------------------------------
  Ethernet1/0/28  28       32768     1        0x8000,00-03-0f-e0-f9-b6    {ACDEF}
</code></pre>
<p>SW2ï¼š</p>
<pre><code>SW2(config)#port-group 1
SW1(config)#int e1/0/25;28                 
SW1(config-if-port-range)#port-group 1 mode active 
SW1(config-if-port-range)#exit
SW2(config)#load-balance dst-src-ip 
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW2#sho port-group 1 detail 
Flags:  A -- LACP_Activity, B -- LACP_timeout, C -- Aggregation,
        D -- Synchronization, E -- Collecting, F -- Distributing,
        G -- Defaulted, H -- Expired

Port-group number: 1,  Mode: active,   Load-balance: dst-src-ip
 Port-group detail information:
 System ID: 0x8000,00-03-0f-e0-f9-b6
 Local:
  Port             Status      Priority  Oper-Key Flag      
  -----------------------------------------------------------
  Ethernet1/0/25   Unselected  32768     1        {ACG}
  Ethernet1/0/28   Selected    32768     1        {ACDEF}

 Remote:
  Actor           Partner  Priority  Oper-Key SystemID                    Flag      
  --------------------------------------------------------------------------------
  Ethernet1/0/28  28       32768     1        0x8000,00-03-0f-e0-f9-b3    {ACDEF}
</code></pre>
<h3 id="3è·¯ç”±è¡¨éš”ç¦»vpn">3ã€è·¯ç”±è¡¨éš”ç¦»VPN<a hidden class="anchor" aria-hidden="true" href="#3è·¯ç”±è¡¨éš”ç¦»vpn">#</a></h3>
<p>å°† SW3 æ¨¡æ‹Ÿä¸º Internet äº¤æ¢æœºï¼Œå®ç°ä¸é›†å›¢å…¶å®ƒä¸šåŠ¡è·¯ç”±è¡¨éš”ç¦»ï¼ŒInternet è·¯ç”±è¡¨ VPN å®ä¾‹åç§°ä¸º Internetã€‚å°† SW3 æ¨¡æ‹ŸåŠäº‹å¤„äº¤æ¢æœºï¼Œå®ç°ä¸é›†å›¢å…¶å®ƒä¸šåŠ¡è·¯ç”±è¡¨éš”ç¦»ï¼ŒåŠäº‹å¤„è·¯ç”±è¡¨ VPN å®ä¾‹åç§°ä¸º Guangdongã€‚</p>
<pre><code>ip vrf Guangdong
!
ip vrf Internet
!         
interface Loopback2
 ip vrf forwarding Guangdong
 ipv6 address 2001:10:10:3::2/128
 ip address 10.10.3.2 255.255.255.255
!
interface Loopback3
 ip vrf forwarding Internet
 ipv6 address 2001:200:200:3::3/128
 ip address 200.200.3.3 255.255.255.255
 !
interface Vlan110
 ip vrf forwarding Guangdong
 ipv6 address 2001:10:16:110::1/64
 ip address 10.16.110.1 255.255.255.0
!
interface Vlan120
 ip vrf forwarding Guangdong
 ipv6 address 2001:10:16:120::1/64
 ip address 10.16.120.1 255.255.255.0
!
interface Vlan1015
 ip vrf forwarding Guangdong
 ip address 10.10.255.46 255.255.255.252
!
interface Vlan1017
 ip vrf forwarding Internet
 ip address 200.200.200.1 255.255.255.252
!
interface Vlan1018
 ip vrf forwarding Internet
 ip address 200.200.200.5 255.255.255.252
!
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW3#sho ip vrf 
VRF Guangdong, FIB ID 1
Router ID: 10.10.3.2 (loopback)
Interfaces:
  Vlan110
  Vlan120
  Vlan1015
  Loopback2
!
VRF Internet, FIB ID 2
Router ID: 200.200.3.3 (loopback)
Interfaces:
  Vlan1017
  Vlan1018
  Loopback3
!

VRF Guangdong; (id=1); RIP is not enabled
VRF Internet; (id=2); RIP is not enabled

Name             Interfaces
Guangdong        Vlan110 Vlan120 Vlan1015 Loopback2 
Internet         Vlan1017 Vlan1018 Loopback3 

Name                    Default RD           Interfaces
Guangdong                                    Vlan110
                                             Vlan120
                                             Vlan1015
                                             Loopback2
Internet                                     Vlan1017
                                             Vlan1018
                                             Loopback3
</code></pre>
<h3 id="4ç«¯å£å®‰å…¨">4ã€ç«¯å£å®‰å…¨<a hidden class="anchor" aria-hidden="true" href="#4ç«¯å£å®‰å…¨">#</a></h3>
<p>SW1 æ³•åŠ¡ç‰©ç†æ¥å£é™åˆ¶æ”¶å‘æ•°æ®å ç”¨çš„å¸¦å®½å‡ä¸º 1000Mbpsï¼Œé™åˆ¶æ‰€æœ‰æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡ä¸º 1000packets/sï¼Œå¦‚æœè¶…è¿‡äº†é…ç½®äº¤æ¢æœºç«¯å£çš„æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡åˆ™å…³é—­æ­¤ç«¯å£ï¼Œ1 åˆ†é’Ÿåæ¢å¤æ­¤ç«¯å£ï¼›å¯ç”¨ç«¯å£å®‰å…¨åŠŸèƒ½ï¼Œæœ€å¤§å®‰å…¨ MAC åœ°å€æ•°ä¸º 20ï¼Œå½“è¶…è¿‡è®¾å®š MAC åœ°å€æ•°é‡çš„æœ€å¤§å€¼ï¼Œä¸å­¦ä¹ æ–°çš„ MACã€ä¸¢å¼ƒæ•°æ®åŒ…ã€å‘nmp trapã€åŒæ—¶åœ¨ syslog æ—¥å¿—ä¸­è®°å½•ï¼Œç«¯å£çš„è€åŒ–å®šæ—¶å™¨åˆ°æœŸåï¼Œåœ¨è€åŒ–å‘¨æœŸä¸­æ²¡æœ‰æµé‡çš„éƒ¨åˆ†è¡¨é¡¹è€åŒ–ï¼Œæœ‰æµé‡çš„éƒ¨åˆ†ä¾æ—§ä¿ç•™ï¼Œæ¢å¤æ—¶é—´ä¸º 10 åˆ†é’Ÿï¼›ç¦æ­¢é‡‡ç”¨è®¿æ§åˆ¶åˆ—è¡¨ï¼Œåªå…è®¸ IP ä¸»æœºä½ä¸º 20-50 çš„æ•°æ®åŒ…è¿›è¡Œè½¬å‘ï¼›ç¦æ­¢é…ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨ï¼Œå®ç°ç«¯å£é—´äºŒå±‚æµé‡æ— æ³•äº’é€šï¼Œç»„åç§° FWã€‚</p>
<pre><code>SW1(config)#inter e1/0/3
SW1(config-if-ethernet1/0/3)#rate-violation all 1000 
SW1(config-if-ethernet1/0/3)#bandwidth control 1000000 both 
SW1(config-if-ethernet1/0/3)#rate-violation control shutdown recovery 60 
SW1(config-if-ethernet1/0/3)#switchport port-security         
Mac learning is not in cpu-control mode, please enable it to make port-security work well!
SW1(config-if-ethernet1/0/3)#switchport port-security maximum 20      
SW1(config-if-ethernet1/0/3)#exit   
SW1(config)#mac-address-learning cpu-control 
SW1(config)#inter e1/0/3
SW1(config-if-ethernet1/0/3)#switchport port-security violation restrict recovery 600 
SW1(config-if-ethernet1/0/3)#switchport port-security aging type inactivity 
SW1(config-if-ethernet1/0/3)#exit       
SW1(config)#am enable 
SW1(config)#inter e1/0/3
SW1(config-if-ethernet1/0/3)#am port 
SW1(config-if-ethernet1/0/3)#am ip-pool 10.10.120.20 31 
SW1(config-if-ethernet1/0/3)#exit
SW1(config)#isolate-port group FW switchport interface e1/0/3                      
SW1(config)#isolate-port apply l2
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1(config-if-ethernet1/0/3)#sho run c
 bandwidth control 1000000 both
 rate-violation all 1000
 rate-violation control shutdown recovery 60
 switchport access vlan 30
 switchport port-security
 switchport port-security maximum 20
 switchport port-security violation restrict recovery 600
 switchport port-security aging type inactivity
 am port
 am ip-pool 10.10.120.20 31
 
SW1#sho isolate-port group FW 
 Isolate-port group FW
    The isolate-port Ethernet1/0/3
</code></pre>
<p>SW1 æ³•åŠ¡ç‰©ç†æ¥å£é™åˆ¶æ”¶å‘æ•°æ®å ç”¨çš„å¸¦å®½åˆ†åˆ«ä¸º 100Mbpsã€90Mbps,é™åˆ¶æ‰€æœ‰æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡ä¸º100packets/s,å¦‚æœè¶…è¿‡äº†é…ç½®äº¤æ¢æœºç«¯å£çš„æŠ¥æ–‡æœ€å¤§æ”¶åŒ…é€Ÿç‡åˆ™å…³é—­æ­¤ç«¯å£,10 åˆ†é’Ÿåæ¢å¤æ­¤ç«¯å£;å¯ç”¨ç«¯å£å®‰å…¨åŠŸèƒ½,æœ€å¤§å®‰å…¨ MAC åœ°å€æ•°ä¸º 10,å½“è¶…è¿‡è®¾å®š MAC åœ°å€æ•°é‡çš„æœ€å¤§å€¼,ä¸å­¦ä¹ æ–°çš„ MACã€ä¸¢å¼ƒæ•°æ®åŒ…ã€å‘nmp trapã€åŒæ—¶åœ¨ syslog æ—¥å¿—ä¸­è®°å½•,ç«¯å£çš„è€åŒ–å®šæ—¶å™¨åˆ°æœŸå,åœ¨è€åŒ–å‘¨æœŸä¸­æ²¡æœ‰æµé‡çš„éƒ¨åˆ†è¡¨é¡¹è€åŒ–,æœ‰æµé‡çš„éƒ¨åˆ†ä¾æ—§ä¿ç•™,æ¢å¤æ—¶é—´ä¸º 10 åˆ†é’Ÿ;ç¦æ­¢é‡‡ç”¨è®¿æ§åˆ¶åˆ—è¡¨,åªå…è®¸ IP ä¸»æœºä½ä¸º 20-50 çš„æ•°æ®åŒ…è¿›è¡Œè½¬å‘;ç¦æ­¢é…ç½®è®¿é—®æ§åˆ¶åˆ—è¡¨,å®ç°ç«¯å£é—´äºŒå±‚æµé‡æ— æ³•äº’é€š,ç»„åç§° FWã€‚</p>
<pre><code>bandwidth control 90000 transmit
 bandwidth control 100000 receive
 rate-violation all 100
 rate-violation control shutdown recovery 600
 switchport access vlan 30
 switchport port-security
 switchport port-security maximum 10
 switchport port-security violation restrict recovery 600
 switchport port-security aging type inactivity
 am port
 am ip-pool 10.1.13.20 31
 
 SW1(config)#isolate-port group FW switchport interface e1/0/3                      
 SW1(config)#isolate-port apply l2
</code></pre>
<h3 id="5å¼€å¯æ—¥å¿—è®°å½•ä¿æŠ¤åŠŸèƒ½">5ã€å¼€å¯æ—¥å¿—è®°å½•&amp;ä¿æŠ¤åŠŸèƒ½<a hidden class="anchor" aria-hidden="true" href="#5å¼€å¯æ—¥å¿—è®°å½•ä¿æŠ¤åŠŸèƒ½">#</a></h3>
<p>å¼€å¯ SW1æ—¥å¿—è®°å½•åŠŸèƒ½å’Œä¿æŠ¤åŠŸèƒ½ï¼Œé‡‡æ ·å‘¨æœŸ5sä¸€æ¬¡ï¼Œæ¢å¤å‘¨æœŸä¸º100sï¼Œä»è€Œä¿éšœ CPU ç¨³å®šè¿è¡Œã€‚</p>
<pre><code>SW1(config)#cpu-protect log enable 
SW1(config)#cpu-protect enable 
SW1(config)#cpu-protect interval 5
SW1(config)#cpu-protect recovery-time 100 
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1#sho cpu-protect running-config 
Cpu-Protect Globle:          enable 
Cpu-Protect trap :           disable 
Cpu-Protect Log:             enable 
Cpu-Protect Interval:        5 
Cpu-Protect Recovery-Time:   100 
Cap-Num   Ip-Num   Mac-Num   Protocal-Num 
 0          0        0        0  

Stream         Threshould     Limit-Speed    Action
IP             300            150            Speed-Limit
DHCP           150            80             Speed-Limit
IGMP           150            80             Speed-Limit
ARP            300            150            Speed-Limit
ICMP           80             50             Speed-Limit
PER-IP         400            200            Speed-Limit
PER-MAC        400            200            Speed-Limit
</code></pre>
<h3 id="6snmp">6ã€SNMP<a hidden class="anchor" aria-hidden="true" href="#6snmp">#</a></h3>
<p>.SW1 é…ç½® SNMPï¼Œå¼•æ“ id åˆ†åˆ«ä¸º 1ï¼›åˆ›å»ºç»„ GROUP2022ï¼Œé‡‡ç”¨æœ€é«˜å®‰å…¨çº§åˆ«ï¼Œé…ç½®ç»„çš„è¯»ã€å†™è§†å›¾åˆ†åˆ«ä¸ºï¼šSKILLS_Rã€SKILLS_Wï¼›åˆ›å»ºè®¤è¯ç”¨æˆ·ä¸ºSER2022ï¼Œé‡‡ç”¨ aes ç®—æ³•è¿›è¡ŒåŠ å¯†ï¼Œå¯†é’¥ä¸º Pass-1234ï¼Œå“ˆå¸Œç®—æ³•ä¸º shaï¼Œå¯†é’¥ä¸º Pass-1234ï¼›å½“è®¾å¤‡æœ‰å¼‚å¸¸æ—¶ï¼Œéœ€è¦ç”¨æœ¬åœ°çš„ç¯å›åœ°å€ loopback1 å‘é€ v3 Trap æ¶ˆæ¯è‡³é›†å›¢ç½‘ç®¡æœåŠ¡å™¨ 10.10.11.99ã€2001:10:10:11::99ï¼Œé‡‡ç”¨æœ€é«˜å®‰å…¨çº§åˆ«ï¼›</p>
<pre><code>snmp-server enable
snmp-server securityip 10.1.15.120
snmp-server securityip 2001:10:1:15::120
snmp-server trap-source 10.1.1.1
snmp-server trap-source 2001:10:1:1::1
snmp-server engineid 1000
snmp-server user UserSkills GroupSkills authPriv aes Key-1122 auth sha Key-1122
snmp-server group GroupSkills authpriv read Skills_R write Skills_W
snmp-server host 10.1.1.1 v3 authpriv UserSkills
snmp-server host 2001:10:1:1::1 v3 authpriv UserSkills
snmp-server enable traps
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1(config)#sho snmp engineid 
SNMP engineID:1
        Engine Boots is:1


SW1(config)#sho snmp group   
Group Name:GROUP2022
            Security Level:AuthPriv
Read View:SKILLS_R
Write View:SKILLS_W
Notify View:&lt;no notifyview specified&gt;


SW1(config)#sho snmp status 
System Name : DC YunKe Networks Co.,Ltd.
System Contact : 400-810-9119
System Location : China
Trap enable
RMON enable
Community Information:
V1/V2c Trap Host Information:
V3 Trap Host Information:
        Trap-rec-address: 2001:10:10:11::99
        User-name :USER2022
        Security Level:AuthPriv
        Trap-rec-address: 10.10.11.99
        User-name :USER2022
        Security Level:AuthPriv
Security IP is Enabled. 
        Security IP: 10.10.11.99
        Security IP: 2001:10:10:11::99


SW1(config)#sho snmp user  
User name: USER2022
Engine ID: 0x31
Auth Protocol:SHA    Priv Protocol:AES-CFB-128
Row status:active
</code></pre>
<p>å½“æ³•åŠ¡éƒ¨é—¨å¯¹åº”çš„ç”¨æˆ·æ¥å£å‘ç”Ÿ UP DOWN äº‹ä»¶æ—¶ï¼Œç¦æ­¢å‘é€ trap æ¶ˆæ¯è‡³ä¸Šè¿°é›†å›¢ç½‘ç®¡æœåŠ¡å™¨ã€‚</p>
<pre><code>SW1(config-if-ethernet1/0/3)#sho run c 
 no switchport updown notification enable
</code></pre>
<h3 id="7äº’è”æµé‡é•œåƒ">7ã€äº’è”æµé‡é•œåƒ<a hidden class="anchor" aria-hidden="true" href="#7äº’è”æµé‡é•œåƒ">#</a></h3>
<p>å°† W1 ä¸ FW1 äº’è¿æµé‡é•œåƒåˆ° SW1 E1/0/1ï¼Œä¼šè¯åˆ—è¡¨ä¸º 1ã€‚</p>
<pre><code>monitor session 1 source interface Ethernet1/0/21 tx
monitor session 1 source interface Ethernet1/0/21 rx
monitor session 1 destination interface Ethernet1/0/1
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1(config)#sho monitor 
monitor session 1:
Destination Ethernet1/0/1

Card: slot 1
source ports:
  RX port: 21 
  TX port: 21 
--------------------------------------------------------
No monitor in session 2
--------------------------------------------------------
No monitor in session 3
--------------------------------------------------------
No monitor in session 4
--------------------------------------------------------
No monitor in session 5
--------------------------------------------------------
No monitor in session 6
--------------------------------------------------------
No monitor in session 7
--------------------------------------------------------
</code></pre>
<h3 id="8uldp">8ã€ULDP<a hidden class="anchor" aria-hidden="true" href="#8uldp">#</a></h3>
<p>SW1 å’Œ SW2 E1/0/21-28 å¯ç”¨å•å‘é“¾è·¯æ•…éšœæ£€æµ‹ï¼Œå½“å‘ç”Ÿè¯¥æ•…éšœæ—¶ï¼Œç«¯å£æ ‡è®°ä¸º errdisable çŠ¶æ€ï¼Œè‡ªåŠ¨å…³é—­ç«¯å£ï¼Œç»è¿‡ 1 åˆ†é’Ÿåï¼Œç«¯å£è‡ªåŠ¨é‡å¯ï¼›å‘é€ã€ã€</p>
<p>Hello æŠ¥æ–‡æ—¶é—´é—´éš”ä¸º 15sï¼›</p>
<p>SW1ï¼š</p>
<pre><code>SW1(config)#uldp enable
SW1(config)#uldp aggressive-mode
SW1(config)#inter e1/0/21-28
SW1(config-if-port-range)#uldp enable
SW1(config-if-port-range)#uldp aggressive-mode
SW1(config)#uldp recovery-time 60
SW1(config)#uldp hello-interval 15
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1(config)#sho uldp 
uldp enable
uldp hello interval is              15
uldp recovery time is               60
uldp shut down mode is              AUTO
uldp global work mode is            AGGRESSIVE
the total number of the port is     8 

---------------------------------------------------------------------------
   PortName     PhyLink   LineProto   WorkMode      PortState  NeighborNum
---------------------------------------------------------------------------
 Ethernet1/0/21    UP         UP        AGGRESSIVE    BIDIRECTION    0
 Ethernet1/0/22    UP         UP        AGGRESSIVE    BIDIRECTION    0
 Ethernet1/0/23    UP         UP        AGGRESSIVE    BIDIRECTION    0
 Ethernet1/0/24    UP         DOWN      AGGRESSIVE    INACTIVE       0
 Ethernet1/0/25    UP         DOWN      AGGRESSIVE    INACTIVE       0
 Ethernet1/0/26    UP         UP        AGGRESSIVE    BIDIRECTION    1
 Ethernet1/0/27    UP         UP        AGGRESSIVE    BIDIRECTION    1
 Ethernet1/0/28    UP         UP        AGGRESSIVE    BIDIRECTION    1
---------------------------------------------------------------------------
</code></pre>
<p>SW2ï¼š</p>
<pre><code>SW2(config)#uldp enable
SW2(config)#uldp aggressive-mode
SW2(config)#inter e1/0/21-28
SW2(config-if-port-range)#uldp enable
SW2(config-if-port-range)#uldp aggressive-mode
SW2(config)#uldp recovery-time 60
SW2(config)#uldp hello-interval 15
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW2(config)#sho uldp 
uldp enable
uldp hello interval is              15
uldp recovery time is               60
uldp shut down mode is              AUTO
uldp global work mode is            AGGRESSIVE
the total number of the port is     8 

---------------------------------------------------------------------------
   PortName     PhyLink   LineProto   WorkMode      PortState  NeighborNum
---------------------------------------------------------------------------
 Ethernet1/0/21    UP         UP        AGGRESSIVE    BIDIRECTION    0
 Ethernet1/0/22    UP         UP        AGGRESSIVE    BIDIRECTION    0
 Ethernet1/0/23    UP         UP        AGGRESSIVE    BIDIRECTION    0
 Ethernet1/0/24    UP         DOWN      AGGRESSIVE    INACTIVE       0
 Ethernet1/0/25    UP         DOWN      AGGRESSIVE    INACTIVE       0
 Ethernet1/0/26    UP         UP        AGGRESSIVE    BIDIRECTION    1
 Ethernet1/0/27    UP         UP        AGGRESSIVE    BIDIRECTION    1
 Ethernet1/0/28    UP         UP        AGGRESSIVE    BIDIRECTION    1
---------------------------------------------------------------------------
</code></pre>
<p>9ã€LLDP</p>
<p>SW1å’ŒSW2æ‰€æœ‰ç«¯å£å¯ç”¨é“¾è·¯å±‚å‘ç°åè®®ï¼Œæ›´æ–°æŠ¥æ–‡å‘é€æ—¶é—´é—´éš”ä¸º20sï¼Œè€åŒ–æ—¶é—´ä¹˜æ³•å™¨å€¼ä¸º 5ï¼ŒTrap æŠ¥æ–‡å‘é€é—´éš”ä¸º 10sï¼Œé…ç½®ä¸‰æ¡è£¸å…‰ç¼†ç«¯å£ä½¿èƒ½Trap åŠŸèƒ½ã€‚</p>
<p>SW1ï¼š</p>
<pre><code>!
lldp enable
lldp msgTxHold 5
lldp tx-interval 10
!
Interface Ethernet1/0/26
 lldp trap enable
!
Interface Ethernet1/0/27
 lldp trap enable
!
Interface Ethernet1/0/28
 lldp trap enable
!
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1#sho lldp 
-----LLDP GLOBAL INFORMATIONS-----
LLDP has been enabled globally.
LLDP enabled port : Ethernet1/0/21 Ethernet1/0/22 Ethernet1/0/23 Ethernet1/0/26 Ethernet1/0/27 Ethernet1/0/28
LLDP interval :10
LLDP txTTL :50
LLDP NotificationInterval :5
LLDP txDelay :2
LLDP-MED FastStart Repeat Count :4
-------------END------------------
</code></pre>
<pre><code>SW1(config)#inter e1/0/26-28
SW1(config-if-port-range)#sho run c 
Interface Ethernet1/0/26
 lldp trap enable
!
Interface Ethernet1/0/27
 lldp trap enable
!
Interface Ethernet1/0/28
 lldp trap enable
</code></pre>
<p>SW2ï¼š</p>
<pre><code>!
lldp enable
lldp msgTxHold 5
lldp tx-interval 10
!
Interface Ethernet1/0/26
 lldp trap enable
!
Interface Ethernet1/0/27
 lldp trap enable
!
Interface Ethernet1/0/28
 lldp trap enable
!
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW2#sho lldp 
-----LLDP GLOBAL INFORMATIONS-----
LLDP has been enabled globally.
LLDP enabled port : Ethernet1/0/21 Ethernet1/0/22 Ethernet1/0/23 Ethernet1/0/26 Ethernet1/0/27 Ethernet1/0/28
LLDP interval :10
LLDP txTTL :50
LLDP NotificationInterval :5
LLDP txDelay :2
LLDP-MED FastStart Repeat Count :4
-------------END------------------
</code></pre>
<pre><code>SW2(config)#inter e1/0/26-28
SW2(config-if-port-range)#sho run c 
Interface Ethernet1/0/26
 lldp trap enable
!
Interface Ethernet1/0/27
 lldp trap enable
!
Interface Ethernet1/0/28
 lldp trap enable
</code></pre>
<h2 id="äºŒè·¯ç”±é…ç½®">äºŒã€è·¯ç”±é…ç½®<a hidden class="anchor" aria-hidden="true" href="#äºŒè·¯ç”±é…ç½®">#</a></h2>
<h3 id="1sshæœåŠ¡">1ã€SSHæœåŠ¡<a hidden class="anchor" aria-hidden="true" href="#1sshæœåŠ¡">#</a></h3>
<p>å¯ç”¨æ‰€æœ‰è®¾å¤‡çš„ ssh æœåŠ¡ï¼Œé˜²ç«å¢™ç”¨æˆ·å adminï¼Œæ˜æ–‡å¯†ç  Pass-1234ï¼Œå…¶ä½™è®¾å¤‡ç”¨æˆ·åå’Œæ˜æ–‡å¯†ç å‡ä¸º adminã€‚</p>
<p>äº¤æ¢æœº&amp;ACï¼š</p>
<pre><code>SW(config)#ssh-server enable 
SW(config)#username admin password 0 admin 
</code></pre>
<p>è·¯ç”±å™¨ï¼š</p>
<pre><code>RT1_config#username admin password 0 admin 
RT1_config#aaa authentication login default local
RT1_config#aaa authentication enable default none
RT1_config#ip sshd enable
</code></pre>
<p>é˜²ç«å¢™ï¼šin</p>
<p><img loading="lazy" src="C:%5cUsers%5cAdministrator%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230425101522616.png" alt="image-20230425101522616"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cAdministrator%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230425101326922.png" alt="image-20230425101326922"  />
</p>
<p><img loading="lazy" src="C:%5cUsers%5cAdministrator%5cAppData%5cRoaming%5cTypora%5ctypora-user-images%5cimage-20230425101140355.png" alt="image-20230425101140355"  />
</p>
<p>åœ¨æ‰€éœ€ç«¯å£ä¸Šå¼€å¯SSHæœåŠ¡</p>
<pre><code>ä¾‹å¦‚ï¼š
FW1(config)# interface e0/0
FW1(config-if-eth0/0)# manage ssh 
</code></pre>
<h3 id="2é…ç½®æ—¶åŒº">2ã€é…ç½®æ—¶åŒº<a hidden class="anchor" aria-hidden="true" href="#2é…ç½®æ—¶åŒº">#</a></h3>
<p>é…ç½®æ‰€æœ‰è®¾å¤‡çš„æ—¶åŒºä¸º GMT+08:00ï¼Œè°ƒæ•´ SW1 æ—¶é—´ä¸ºå®é™…æ—¶é—´ï¼ŒSW1 é…ç½®ä¸º ntp serverï¼Œå…¶ä»–è®¾å¤‡ç”¨ SW1 loopback1 ipv4 åœ°å€ä½œä¸º ntp server åœ°å€ï¼Œntp client è¯·æ±‚æŠ¥æ–‡æ—¶é—´é—´éš” 1 åˆ†é’Ÿã€‚</p>
<p>SW1ï¼š</p>
<pre><code>SW1#clock set 14:41:30 2023.4.24
SW1#config
SW1(config)#clock timezone GMT add 8 0
SW1(config)#ntp enable
SW1(config)#ntp-service refclock-master 1  
SW1(config)#ntp server 10.10.1.1
SW1(config)#ntp syn-interval 60 
</code></pre>
<p>SW2ã€SW3ã€ACï¼š</p>
<pre><code>clock timezone GMT add 8 0
ntp enable
ntp syn-interval 60
ntp server 10.10.1.1
</code></pre>
<p>è·¯ç”±å™¨ï¼š</p>
<pre><code>time-zone GMT 8 0
ntp query-interval 60
ntp server 10.10.1.1
</code></pre>
<p>é˜²ç«å¢™ï¼š</p>
<pre><code>FW1(config)# clock zone GMT 8 0
FW1(config)# ntp enable 
FW1(config)# ntp server 10.10.1.1
FW1(config)# ntp query-interval 1
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1(config)#sho clock 
Current time is Mon Apr 24 15:13:30 2023 [GMT+08:00]


SW1(config)#sho ntp status
ntp clock status: synchronized
Clock stratum:4
Reference clock server:10.10.1.1
Clock offset:0.0   s
Root delay:0.000 ms
Root dispersion:0.000 ms
Reference time:Mon Apr 24 07:06:3.203 2023
Syn-interval:60s  
</code></pre>
<h3 id="3vrrp">3ã€VRRP<a hidden class="anchor" aria-hidden="true" href="#3vrrp">#</a></h3>
<p>åˆ©ç”¨ vrrpv2 å’Œ vrrpv3 æŠ€æœ¯å®ç° vlan60ã€vlan70ã€vlan80ã€vlan90 ç½‘å…³å†—ä½™å¤‡ä»½ï¼Œvrrp id ä¸ vlan id ç›¸åŒã€‚vrrpv2 vip ä¸º 10.10.vlanid.9ï¼ˆå¦‚ vlan60çš„ vrrpv2 vip ä¸º 10.10.60.9ï¼‰ï¼Œvrrpv3 vip ä¸º FE80:vlanid::9ï¼ˆå¦‚ vlan60 çš„vrrpv3 vip ä¸º FE80:60::9ï¼‰ã€‚é…ç½® SW1 ä¸º vlan60ã€vlan70 çš„ Masterï¼ŒSW2 ä¸ºvlan80ã€vlan90 çš„ asterã€‚è¦æ±‚ vrrp ç»„ä¸­é«˜ä¼˜å…ˆçº§ä¸º 120ï¼Œä½ä¼˜å…ˆçº§ä¸ºé»˜è®¤å€¼ï¼ŒæŠ¢å æ¨¡å¼ä¸ºé»˜è®¤å€¼ï¼Œvrrpv2 å’Œ vrrpv3 å‘é€é€šå‘ŠæŠ¥æ–‡æ—¶é—´é—´éš”ä¸ºé»˜è®¤å€¼ã€‚å½“ SW1æˆ– SW2 ä¸Šè”é“¾è·¯å‘ç”Ÿæ•…éšœï¼ŒMaster ä¼˜å…ˆçº§é™ä½ 50ã€‚</p>
<h4 id="vrrpv2">VRRPv2<a hidden class="anchor" aria-hidden="true" href="#vrrpv2">#</a></h4>
<p>SW1ï¼š</p>
<pre><code>!
router vrrp 60
 virtual-ip 10.10.60.9
 interface Vlan60
 circuit-failover Vlan1021 50
 priority 120
 enable
!
router vrrp 70
 virtual-ip 10.10.70.9
 interface Vlan70
 circuit-failover Vlan1021 50
 priority 120
 enable
!
router vrrp 80
 virtual-ip 10.10.80.9
 interface Vlan80
 enable
!
router vrrp 90
 virtual-ip 10.10.90.9
 interface Vlan90
 enable
!
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1(config)#sho vrrp 
VrId 60
 State is Master
 Virtual IP is 10.10.60.9 (Not IP owner)
 Interface is Vlan60
 Configured priority is 120, Current priority is 120
 Advertisement interval is 1 sec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP
VrId 70
 State is Master
 Virtual IP is 10.10.70.9 (Not IP owner)
 Interface is Vlan70
 Configured priority is 120, Current priority is 120
 Advertisement interval is 1 sec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP
VrId 80
 State is Backup
 Virtual IP is 10.10.80.9 (Not IP owner)
 Interface is Vlan80
 Priority is 100(config priority is 100)
 Advertisement interval is 1 sec
 Preempt mode is TRUE
VrId 90   
 State is Backup
 Virtual IP is 10.10.90.9 (Not IP owner)
 Interface is Vlan90
 Priority is 100(config priority is 100)
 Advertisement interval is 1 sec
 Preempt mode is TRUE
</code></pre>
<p>SW2ï¼š</p>
<pre><code>!
router vrrp 60
 virtual-ip 10.10.60.9
 interface Vlan60
 enable
!
router vrrp 70
 virtual-ip 10.10.70.9
 interface Vlan70
 enable
!
router vrrp 80
 virtual-ip 10.10.80.9
 interface Vlan80
 circuit-failover Vlan1021 50
 priority 120
 enable
!
router vrrp 90
 virtual-ip 10.10.90.9
 interface Vlan90
 circuit-failover Vlan1021 50
 priority 120
 enable
!
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW2(config)#sho vrrp 
VrId 60
 State is Backup
 Virtual IP is 10.10.60.9 (Not IP owner)
 Interface is Vlan60
 Priority is 100(config priority is 100)
 Advertisement interval is 1 sec
 Preempt mode is TRUE
VrId 70
 State is Backup
 Virtual IP is 10.10.70.9 (Not IP owner)
 Interface is Vlan70
 Priority is 100(config priority is 100)
 Advertisement interval is 1 sec
 Preempt mode is TRUE
VrId 80
 State is Master
 Virtual IP is 10.10.80.9 (Not IP owner)
 Interface is Vlan80
 Configured priority is 120, Current priority is 120
 Advertisement interval is 1 sec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP
VrId 90
 State is Master
 Virtual IP is 10.10.90.9 (Not IP owner)
 Interface is Vlan90
 Configured priority is 120, Current priority is 120
 Advertisement interval is 1 sec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP

</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW2(config)#sho ipv6 vrrp 
VrId 60
 State is Backup
 Virtual IPv6 is fe80:60::9 (Not IPv6 owner)
 Interface is Vlan60
 Priority is 100(config priority is 100)
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
VrId 70
 State is Backup
 Virtual IPv6 is fe80:70::9 (Not IPv6 owner)
 Interface is Vlan70
 Priority is 100(config priority is 100)
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
VrId 80
 State is Master
 Virtual IPv6 is fe80:80::9 (Not IPv6 owner)
 Interface is Vlan80
 Configured priority is 120, Current priority is 120
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP
VrId 90
 State is Master
 Virtual IPv6 is fe80:90::9 (Not IPv6 owner)
 Interface is Vlan90
 Configured priority is 120, Current priority is 120
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP
</code></pre>
<h4 id="vrrpv3">VRRPv3<a hidden class="anchor" aria-hidden="true" href="#vrrpv3">#</a></h4>
<p>SW1:</p>
<pre><code>!
router ipv6 vrrp 60
 virtual-ipv6 fe80:60::9 interface Vlan60
 circuit-failover Vlan1021 50
 priority 120
 enable
!
router ipv6 vrrp 70
 virtual-ipv6 fe80:70::9 interface Vlan70
 circuit-failover Vlan1021 50
 priority 120
 enable   
!
router ipv6 vrrp 80
 virtual-ipv6 fe80:80::9 interface Vlan80
 enable
!
router ipv6 vrrp 90
 virtual-ipv6 fe80:90::9 interface Vlan90
 enable
!
</code></pre>
<p>SW2:</p>
<pre><code>!
router ipv6 vrrp 60
 virtual-ipv6 fe80:60::9 interface Vlan60
 enable
!
router ipv6 vrrp 70
 virtual-ipv6 fe80:70::9 interface Vlan70
 enable
!
router ipv6 vrrp 80
 virtual-ipv6 fe80:80::9 interface Vlan80
 circuit-failover Vlan1021 50
 priority 120
 enable
!
router ipv6 vrrp 90
 virtual-ipv6 fe80:90::9 interface Vlan90
 circuit-failover Vlan1021 50
 priority 120
 enable   
!
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>SW1(config)#sho ipv6 vrrp 
VrId 60
 State is Master
 Virtual IPv6 is fe80:60::9 (Not IPv6 owner)
 Interface is Vlan60
 Configured priority is 120, Current priority is 120
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP
VrId 70
 State is Master
 Virtual IPv6 is fe80:70::9 (Not IPv6 owner)
 Interface is Vlan70
 Configured priority is 120, Current priority is 120
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
 Circuit failover interface Vlan1021, Priority Delta 50, Status UP
VrId 80
 State is Backup
 Virtual IPv6 is fe80:80::9 (Not IPv6 owner)
 Interface is Vlan80
 Priority is 100(config priority is 100)
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
VrId 90   
 State is Backup
 Virtual IPv6 is fe80:90::9 (Not IPv6 owner)
 Interface is Vlan90
 Priority is 100(config priority is 100)
 Advertisement interval is 100 centisec
 Preempt mode is TRUE
</code></pre>
<h3 id="4dhcpæœåŠ¡">4ã€DHCPæœåŠ¡<a hidden class="anchor" aria-hidden="true" href="#4dhcpæœåŠ¡">#</a></h3>
<p>AC1é…ç½®dhcpv4å’Œdhcpv6ï¼Œåˆ†åˆ«ä¸ºSW1äº§å“1æ®µvlan10å’Œåˆ†å…¬å¸vlan100ã€vlan110 å’Œ vlan120 åˆ†é…åœ°å€ï¼›ipv4 åœ°å€æ± åç§°åˆ†åˆ«ä¸º POOLv4-10ã€POOLv4-100ã€POOLv4-110ã€POOLv4-120</p>
<pre><code>service dhcp
!
 ip dhcp pool POOLv4-10
 network-address 10.10.11.0 255.255.255.0
 default-router 10.10.11.1
 dns-server 114.114.114.114
!
ip dhcp pool POOLv4-100
 network-address 10.17.100.0 255.255.255.0
 default-router 10.17.100.1
 dns-server 114.114.114.114
!
ip dhcp pool POOLv4-110
 network-address 10.17.110.0 255.255.255.0
 default-router 10.17.110.1
 dns-server 114.114.114.114
!
ip dhcp pool POOLv4-120
 network-address 10.17.120.0 255.255.255.0
 default-router 10.17.120.1
 dns-server 114.114.114.114
</code></pre>
<p>ipv6 åœ°å€æ± åç§°åˆ†åˆ«ä¸º POOLv6-10ã€POOLv6-100ã€POOLv6-110ã€POOLv6-120ï¼›ipv6 åœ°å€æ± ç”¨ç½‘ç»œå‰ç¼€è¡¨ç¤ºï¼›</p>
<pre><code>service dhcpv6
!
ipv6 dhcp pool POOLv6-120
 network-address 2001:10:17:120:: 64
 static-binding 2001:10:17:120::9 24-69-8e-1e-b9-5e
 excluded-address 2001:10:17:120::1
!
ipv6 dhcp pool POOLv6-110
 network-address 2001:10:17:110:: 64
 static-binding 2001:10:17:110::9 8c-16-45-78-8d-98
 excluded-address 2001:10:17:110::1
!
ipv6 dhcp pool POOLv6-100
 network-address 2001:10:17:100:: 64
 static-binding 2001:10:17:100::9 00-03-0f-8a-f8-b0
 excluded-address 2001:10:17:100::1
!
ipv6 dhcp pool POOLv6-10
 network-address 2001:10:10:11:: 64
 excluded-address 2001:10:10:11::1
 dns-server 2400:3200::1
!
</code></pre>
<p>æ’é™¤ç½‘å…³ï¼›</p>
<p>IPv4:</p>
<pre><code>ip dhcp excluded-address 10.10.11.1
ip dhcp excluded-address 10.17.100.1
ip dhcp excluded-address 10.17.110.1
ip dhcp excluded-address 10.17.120.1
</code></pre>
<p>IPv6:</p>
<pre><code>ipv6 dhcp pool POOLv6-120
 excluded-address 2001:10:17:120::1
!
ipv6 dhcp pool POOLv6-110
 excluded-address 2001:10:17:110::1
!
ipv6 dhcp pool POOLv6-100
 excluded-address 2001:10:17:100::1
!
ipv6 dhcp pool POOLv6-10
 dns-server 2400:3200::1
!
</code></pre>
<p>DNS åˆ†åˆ«ä¸º114.114.114.114 å’Œ 2400:3200::1 ï¼› ä¸º PC1 ä¿ ç•™ åœ° å€ 10.10.11.9 å’Œ2001:10:10:11::9ï¼Œä¸º AP1 ä¿ç•™åœ°å€ 10.17.100.9 å’Œ 2001:10:17&#x1f4af;9ï¼Œä¸º PC2ä¿ç•™åœ°å€ 10.17.110.9 å’Œ 2001:10:17:110::9ã€‚</p>
<pre><code>ip dhcp pool AP1
 host 10.17.100.9 255.255.255.0
 hardware-address 00-03-0F-8A-F8-B0
 default-router 10.17.100.1
!
ip dhcp pool PC1
 host 10.10.11.9 255.255.255.0
 hardware-address 8C-16-45-78-8D-98
 default-router 10.10.11.1
 dns-server 114.114.114.114
!
ip dhcp pool PC2
 host 10.17.110.9 255.255.255.0
 hardware-address 24-69-8E-1E-B9-5E
 default-router 10.17.110.1
 dns-server 114.114.114.114
</code></pre>
<pre><code>!
interface Vlan1000
 no ipv6 nd suppress-ra
 ipv6 nd managed-config-flag
 ipv6 nd other-config-flag
 ipv6 dhcp server POOLv6-100
!
interface Vlan110
 no ipv6 nd suppress-ra
 ipv6 nd managed-config-flag
 ipv6 nd other-config-flag
 ipv6 dhcp server POOLv6-110
!
interface Vlan120
 no ipv6 nd suppress-ra
 ipv6 nd managed-config-flag
 ipv6 nd other-config-flag
 ipv6 dhcp server POOLv6-120
!
</code></pre>
<h4 id="dhcpä¸­ç»§">DHCPä¸­ç»§ï¼š<a hidden class="anchor" aria-hidden="true" href="#dhcpä¸­ç»§">#</a></h4>
<p>SW1 ä¸Šä¸­ç»§åœ°å€ä¸º AC1 loopback1åœ°å€ã€‚</p>
<p>IPV4:</p>
<p>SW1ï¼š</p>
<pre><code>SW1(config)#service dhcp
SW1(config)#ip forward-protocol udp bootps
interface Vlan10
  ip helper-address 10.10.8.1
</code></pre>
<p>IPV6:</p>
<pre><code>SW1(config)#service dhcpv6
interface Vlan10
 no ipv6 nd suppress-ra
 ipv6 nd managed-config-flag
 ipv6 nd other-config-flag
 ipv6 dhcp relay destination 2001:10:10:8::1

</code></pre>
<h4 id="dhcp-snooping">DHCP snooping<a hidden class="anchor" aria-hidden="true" href="#dhcp-snooping">#</a></h4>
<p>SW1 å¯ç”¨ dhcpv4 å’Œ dhcpv6 snoopingï¼Œå¦‚æœ E1/0/1 è¿æ¥ dhcpv4 æœåŠ¡å™¨ï¼Œåˆ™å…³é—­è¯¥ç«¯å£ï¼Œæ¢å¤æ—¶é—´ä¸º 1 åˆ†é’Ÿã€‚</p>
<p><strong>IPV4:</strong></p>
<pre><code>ip dhcp snooping enable
!
Interface Ethernet1/0/1
 ip dhcp snooping action shutdown recovery 60
Interface Ethernet1/0/21;26;22
 ip dhcp snooping trust
 
</code></pre>
<p><strong>IPV6:</strong></p>
<pre><code>SW1(config)#savi enable
SW1(config)#savi ipv6 dhcp-only enable 
Interface Ethernet1/0/21;26;22
 ipv dhcp snooping trust
</code></pre>
<h3 id="5ospf">5ã€OSPF<a hidden class="anchor" aria-hidden="true" href="#5ospf">#</a></h3>
<p>SW1ã€SW2ã€SW3ã€RT1 ä»¥å¤ªé“¾è·¯ã€RT2 ä»¥å¤ªé“¾è·¯ã€FW1ã€FW2ã€AC1 ä¹‹é—´è¿è¡ŒOSPFv2 å’Œ OSPFv3 åè®®ï¼ˆè·¯ç”±æ¨¡å¼å‘å¸ƒç½‘ç»œç”¨æ¥å£åœ°å€ï¼Œ-	BGP åè®®é™¤å¤–ï¼‰ã€‚</p>
<h4 id="ospfv2">OSPFv2<a hidden class="anchor" aria-hidden="true" href="#ospfv2">#</a></h4>
<p>(1) SW1ã€SW2ã€SW3ã€RT1ã€RT2ã€FW1 ä¹‹é—´ OSPFv2 ï¼Œè¿›ç¨‹ 1ï¼ŒåŒºåŸŸ 0ï¼Œåˆ†åˆ«å‘å¸ƒ loopback1 åœ°å€è·¯ç”±å’Œäº§å“è·¯ç”±ï¼ŒFW1 é€šå‘Š type2 é»˜è®¤è·¯ç”±ã€‚</p>
<p>SW1:</p>
<pre><code>router ospf 1
 ospf router-id 10.10.1.1
 network 10.10.1.1/32 area 0
 network 10.10.11.1/32 area 0
 network 10.10.255.1/32 area 0
 network 10.10.255.5/32 area 0
 network 10.10.255.14/32 area 0
</code></pre>
<p>SW2:</p>
<pre><code>router ospf 1
 ospf router-id 10.10.2.1
 network 10.10.2.1/32 area 0
 network 10.10.21.1/32 area 0
 network 10.10.255.2/32 area 0
 network 10.10.255.9/32 area 0
 network 10.10.255.22/32 area 0
</code></pre>
<p>SW3:</p>
<pre><code>router ospf 1
 ospf router-id 10.10.3.1
 network 10.10.3.1/32 area 0
 network 10.10.31.1/32 area 0
 network 10.10.255.6/32 area 0
 network 10.10.255.10/32 area 0
</code></pre>
<p>RT1:</p>
<pre><code>router ospf 1
 router-id 10.10.4.1
 network 10.10.4.1 255.255.255.255 area 0
 network 10.10.255.29 255.255.255.255 area 0
 network 10.10.255.21 255.255.255.255 area 0
 network 10.10.255.18 255.255.255.255 area 0
</code></pre>
<p>RT2:</p>
<pre><code>router ospf 1
 router-id 10.10.5.1
 network 10.10.5.1 255.255.255.255 area 0
 network 10.10.255.30 255.255.255.255 area 0
</code></pre>
<p>FW1:</p>
<pre><code>ip vrouter &quot;trust-vr&quot;
  ip route 0.0.0.0/0 200.200.200.1
  router ospf 1
    router-id 10.10.6.1
    default-information originate
    network 10.10.6.1/32 area 0
    network 10.10.255.13/32 area 0
    network 10.10.255.17/32 area 0
  exit
</code></pre>
<p>(2) RT2 ä¸ AC1 ä¹‹é—´è¿è¡Œ OSPFv2 åè®®ï¼Œè¿›ç¨‹ 1ï¼Œnssa no-summary åŒºåŸŸ 1ï¼›AC1 å‘å¸ƒ loopback1 åœ°å€è·¯ç”±ã€äº§å“å’Œè¥é”€è·¯ç”±ï¼Œç”¨ prefix-list é‡å‘å¸ƒloopback3ã€‚</p>
<p>RT2:</p>
<pre><code>router ospf 1
 network 10.10.255.41 255.255.255.255 area 1
 area 1 nssa no-summary

</code></pre>
<p>AC1:</p>
<pre><code>router ospf 1
 ospf router-id 10.10.8.1
 area 1 nssa no-summary
 network 10.10.8.1/32 area 1
 network 10.10.255.42/32 area 1
 network 10.17.110.1/32 area 1
 network 10.17.120.1/32 area 1
 redistribute connected route-map L3
!
ip prefix-list L3 seq 5 permit 10.10.8.3/32
!
route-map L3 permit 10
 match ip address prefix-list L3
</code></pre>
<p>(4)SW3 æ¨¡æ‹ŸåŠäº‹å¤„äº§å“å’Œè¥é”€æ¥å£é…ç½®ä¸º loopbackï¼Œæ¨¡æ‹Ÿæ¥å£ upã€‚SW3 æ¨¡æ‹ŸåŠäº‹å¤„ä¸ FW2 ä¹‹é—´è¿è¡Œ OSPFv2 åè®®ï¼Œè¿›ç¨‹ 2ï¼ŒåŒºåŸŸ 2ï¼ŒSW3 æ¨¡æ‹ŸåŠäº‹å¤„å‘å¸ƒloopback2ã€äº§å“å’Œè¥é”€ã€‚</p>
<p>SW3ï¼š</p>
<pre><code>Interface Ethernet1/0/11
 loopback
 switchport access vlan 110
!
Interface Ethernet1/0/12
 loopback
 switchport access vlan 120
</code></pre>
<pre><code>router ospf 2 Guangdong
 ospf router-id 10.10.3.2
 network 10.10.3.2/32 area 2
 network 10.10.255.46/32 area 2
 network 10.16.110.1/32 area 2
 network 10.16.120.1/32 area 2
</code></pre>
<p>FW2:</p>
<pre><code>ip vrouter &quot;trust-vr&quot;
  router ospf 2
    router-id 10.10.7.1
    network 10.10.255.45/32 area 2
    network 10.10.255.26/32 area 2
    network 10.10.7.1/32 area 2
  exit
</code></pre>
<p>(5)RT1ã€FW2 ä¹‹é—´ OSPFv2  åè®®ï¼Œè¿›ç¨‹ 2ï¼ŒåŒºåŸŸ 2ï¼›RT1 å‘å¸ƒ loopback4è·¯ç”±ï¼Œå‘è¯¥åŒºåŸŸé€šå‘Š type1 é»˜è®¤è·¯ç”±ï¼›</p>
<p>RT1:</p>
<pre><code>router ospf 2
 router-id 10.10.4.4
 network 10.10.4.4 255.255.255.255 area 2
 network 10.10.255.25 255.255.255.255 area 2
 default-information originate always metric-type 1
</code></pre>
<p>FW2 å‘å¸ƒ loopback1 è·¯ç”±ï¼ŒFW2 ç¦æ­¢å­¦ä¹ åˆ°é›†å›¢å’Œåˆ†å…¬å¸çš„æ‰€æœ‰è·¯ç”±ã€‚</p>
<pre><code>ip vrouter &quot;trust-vr&quot;
  router ospf 2
    router-id 10.10.7.1
    network 10.10.255.45/32 area 2
    network 10.10.255.26/32 area 2
    network 10.10.7.1/32 area 2
  exit
</code></pre>
<p>RT1 ç”¨ prefix-list åŒ¹é… FW2 loopback1 è·¯ç”±ã€SW3æ¨¡æ‹ŸåŠäº‹å¤„ loopback2 å’Œäº§å“è·¯ç”±ã€RT1 ä¸ FW2 ç›´è¿ ipv4 è·¯ç”±ï¼Œå°†è¿™äº›è·¯ç”±é‡å‘å¸ƒåˆ°åŒºåŸŸ 0ã€‚</p>
<pre><code>router ospf 1
 router-id 10.10.4.1
 network 10.10.4.1 255.255.255.255 area 0
 network 10.10.255.29 255.255.255.255 area 0
 network 10.10.255.21 255.255.255.255 area 0
 network 10.10.255.18 255.255.255.255 area 0
 redistribute ospf 2 route-map BSC
 redistribute connect route-map ZL
</code></pre>
<pre><code>route-map BSC 10 permit
 match ip address prefix-list BSC
ip prefix-list BSC seq 5 permit 10.10.7.1/32
ip prefix-list BSC seq 10 permit 10.10.3.2/32
ip prefix-list BSC seq 15 permit 10.16.110.0/24
</code></pre>
<pre><code>route-map ZL 10 permit
 match ip address prefix-list ZL
ip prefix-list ZL seq 5 permit 10.10.255.24/30
</code></pre>
<p>è·¯ç”±è¡¨ï¼š</p>
<p>SW1:</p>
<pre><code>SW1(config)#sho ip route ospf 
O*E2    0.0.0.0/0 [110/10] via 10.10.255.13, Vlan1021, 12:37:46  tag:0
O       10.10.2.1/32 [110/2] via 10.10.255.2, Vlan1026, 15:51:53  tag:0
O       10.10.3.1/32 [110/2] via 10.10.255.6, Vlan1022, 15:46:35  tag:0
O E2    10.10.3.2/32 [110/100] via 10.10.255.13, Vlan1021, 11:56:19  tag:0
                     [110/100] via 10.10.255.2, Vlan1026, 11:56:19  tag:0
O       10.10.4.1/32 [110/3] via 10.10.255.13, Vlan1021, 14:40:59  tag:0
                     [110/3] via 10.10.255.2, Vlan1026, 14:40:59  tag:0
O       10.10.5.1/32 [110/4] via 10.10.255.13, Vlan1021, 14:40:59  tag:0
                     [110/4] via 10.10.255.2, Vlan1026, 14:40:59  tag:0
O       10.10.6.1/32 [110/2] via 10.10.255.13, Vlan1021, 14:42:20  tag:0
O E2    10.10.7.1/32 [110/100] via 10.10.255.13, Vlan1021, 12:02:08  tag:0
                     [110/100] via 10.10.255.2, Vlan1026, 12:02:08  tag:0
O IA    10.10.8.1/32 [110/5] via 10.10.255.13, Vlan1021, 13:59:39  tag:0
                     [110/5] via 10.10.255.2, Vlan1026, 13:59:39  tag:0
O E2    10.10.8.3/32 [110/20] via 10.10.255.13, Vlan1021, 12:32:00  tag:0
                     [110/20] via 10.10.255.2, Vlan1026, 12:32:00  tag:0
O       10.10.21.0/24 [110/2] via 10.10.255.2, Vlan1026, 15:51:53  tag:0
O       10.10.31.0/24 [110/2] via 10.10.255.6, Vlan1022, 15:46:35  tag:0
O       10.10.255.8/30 [110/2] via 10.10.255.6, Vlan1022, 15:46:35  tag:0
                       [110/2] via 10.10.255.2, Vlan1026, 15:46:35  tag:0
O       10.10.255.16/30 [110/2] via 10.10.255.13, Vlan1021, 14:41:09  tag:0
O       10.10.255.20/30 [110/2] via 10.10.255.2, Vlan1026, 15:51:53  tag:0
O E2    10.10.255.24/30 [110/100] via 10.10.255.13, Vlan1021, 11:52:58  tag:0
                        [110/100] via 10.10.255.2, Vlan1026, 11:52:58  tag:0
O       10.10.255.28/30 [110/3] via 10.10.255.13, Vlan1021, 14:40:59  tag:0
                        [110/3] via 10.10.255.2, Vlan1026, 14:40:59  tag:0
O IA    10.10.255.40/30 [110/4] via 10.10.255.13, Vlan1021, 13:59:30  tag:0
                        [110/4] via 10.10.255.2, Vlan1026, 13:59:30  tag:0
O E2    10.16.110.0/24 [110/100] via 10.10.255.13, Vlan1021, 11:55:52  tag:0
                       [110/100] via 10.10.255.2, Vlan1026, 11:55:52  tag:0
O IA    10.17.110.0/24 [110/5] via 10.10.255.13, Vlan1021, 13:59:39  tag:0
                       [110/5] via 10.10.255.2, Vlan1026, 13:59:39  tag:0
O IA    10.17.120.0/24 [110/5] via 10.10.255.13, Vlan1021, 13:59:39  tag:0
                       [110/5] via 10.10.255.2, Vlan1026, 13:59:39  tag:0
Total routes are : 34 item(s)
</code></pre>
<p>SW2:</p>
<pre><code>SW2(config)#sho ip rout ospf 
O*E2    0.0.0.0/0 [110/10] via 10.10.255.1, Vlan1026, 12:38:26  tag:0
                  [110/10] via 10.10.255.21, Vlan1021, 12:38:26  tag:0
O       10.10.1.1/32 [110/2] via 10.10.255.1, Vlan1026, 15:52:34  tag:0
O       10.10.3.1/32 [110/2] via 10.10.255.10, Vlan1022, 15:47:42  tag:0
O E2    10.10.3.2/32 [110/100] via 10.10.255.21, Vlan1021, 11:57:00  tag:0
O       10.10.4.1/32 [110/2] via 10.10.255.21, Vlan1021, 15:18:41  tag:0
O       10.10.5.1/32 [110/3] via 10.10.255.21, Vlan1021, 15:03:50  tag:0
O       10.10.6.1/32 [110/3] via 10.10.255.1, Vlan1026, 14:41:39  tag:0
                     [110/3] via 10.10.255.21, Vlan1021, 14:41:39  tag:0
O E2    10.10.7.1/32 [110/100] via 10.10.255.21, Vlan1021, 12:02:49  tag:0
O IA    10.10.8.1/32 [110/4] via 10.10.255.21, Vlan1021, 14:00:19  tag:0
O E2    10.10.8.3/32 [110/20] via 10.10.255.21, Vlan1021, 12:32:40  tag:0
O       10.10.11.0/24 [110/2] via 10.10.255.1, Vlan1026, 15:52:34  tag:0
O       10.10.31.0/24 [110/2] via 10.10.255.10, Vlan1022, 15:47:42  tag:0
O       10.10.255.4/30 [110/2] via 10.10.255.1, Vlan1026, 15:47:42  tag:0
                       [110/2] via 10.10.255.10, Vlan1022, 15:47:42  tag:0
O       10.10.255.12/30 [110/2] via 10.10.255.1, Vlan1026, 15:52:34  tag:0
O       10.10.255.16/30 [110/2] via 10.10.255.21, Vlan1021, 15:18:41  tag:0
O E2    10.10.255.24/30 [110/100] via 10.10.255.21, Vlan1021, 11:53:38  tag:0

O       10.10.255.28/30 [110/2] via 10.10.255.21, Vlan1021, 15:08:47  tag:0
O IA    10.10.255.40/30 [110/3] via 10.10.255.21, Vlan1021, 14:00:11  tag:0
O E2    10.16.110.0/24 [110/100] via 10.10.255.21, Vlan1021, 11:56:32  tag:0
O IA    10.17.110.0/24 [110/4] via 10.10.255.21, Vlan1021, 14:00:19  tag:0
O IA    10.17.120.0/24 [110/4] via 10.10.255.21, Vlan1021, 14:00:19  tag:0
Total routes are : 24 item(s)
</code></pre>
<p>SW3:</p>
<pre><code>SW3(config)#sho ip route ospf 
O*E2    0.0.0.0/0 [110/10] via 10.10.255.5, Vlan1021, 12:38:54  tag:0
O       10.10.1.1/32 [110/2] via 10.10.255.5, Vlan1021, 15:47:43  tag:0
O       10.10.2.1/32 [110/2] via 10.10.255.9, Vlan1022, 15:48:13  tag:0
O E2    10.10.3.2/32 [110/100] via 10.10.255.9, Vlan1022, 11:57:27  tag:0
O       10.10.4.1/32 [110/3] via 10.10.255.9, Vlan1022, 15:19:09  tag:0
O       10.10.5.1/32 [110/4] via 10.10.255.9, Vlan1022, 15:04:17  tag:0
O       10.10.6.1/32 [110/3] via 10.10.255.5, Vlan1021, 14:43:28  tag:0
O E2    10.10.7.1/32 [110/100] via 10.10.255.9, Vlan1022, 12:03:16  tag:0
O IA    10.10.8.1/32 [110/5] via 10.10.255.9, Vlan1022, 14:00:47  tag:0
O E2    10.10.8.3/32 [110/20] via 10.10.255.9, Vlan1022, 12:33:08  tag:0
O       10.10.11.0/24 [110/2] via 10.10.255.5, Vlan1021, 15:47:43  tag:0
O       10.10.21.0/24 [110/2] via 10.10.255.9, Vlan1022, 15:48:13  tag:0
O       10.10.255.0/30 [110/2] via 10.10.255.5, Vlan1021, 15:47:43  tag:0
                       [110/2] via 10.10.255.9, Vlan1022, 15:47:43  tag:0
O       10.10.255.12/30 [110/2] via 10.10.255.5, Vlan1021, 15:47:43  tag:0
O       10.10.255.16/30 [110/3] via 10.10.255.5, Vlan1021, 14:42:17  tag:0
                        [110/3] via 10.10.255.9, Vlan1022, 14:42:17  tag:0
O       10.10.255.20/30 [110/2] via 10.10.255.9, Vlan1022, 15:48:13  tag:0
O E2    10.10.255.24/30 [110/100] via 10.10.255.9, Vlan1022, 11:54:06  tag:0

O       10.10.255.28/30 [110/3] via 10.10.255.9, Vlan1022, 15:09:14  tag:0
O IA    10.10.255.40/30 [110/4] via 10.10.255.9, Vlan1022, 14:00:39  tag:0
O E2    10.16.110.0/24 [110/100] via 10.10.255.9, Vlan1022, 11:57:00  tag:0
O IA    10.17.110.0/24 [110/5] via 10.10.255.9, Vlan1022, 14:00:47  tag:0
O IA    10.17.120.0/24 [110/5] via 10.10.255.9, Vlan1022, 14:00:47  tag:0
Total routes are : 24 item(s)
</code></pre>
<pre><code>SW3(config)#sho ip route vrf Guangdong ospf 
O*E1    0.0.0.0/0 [110/102] via 10.10.255.45, Vlan1015, 12:10:12  tag:0
O       10.10.4.4/32 [110/3] via 10.10.255.45, Vlan1015, 12:10:13  tag:0
O       10.10.7.1/32 [110/2] via 10.10.255.45, Vlan1015, 12:19:31  tag:0
O       10.10.255.24/30 [110/2] via 10.10.255.45, Vlan1015, 12:10:33  tag:0
Total routes are : 4 item(s)
</code></pre>
<p>RT1:</p>
<pre><code>RT1_config#sho ip route ospf 
VRF ID: 0

O E2   0.0.0.0/0            [150,10] via 10.10.255.17(on GigaEthernet0/2)
O      10.10.1.1/32         [110,3] via 10.10.255.17(on GigaEthernet0/2)
                            [110,3] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.2.1/32         [110,2] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.3.1/32         [110,3] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.3.2/32         [110,3] via 10.10.255.26(on GigaEthernet0/3)
O      10.10.5.1/32         [110,2] via 10.10.255.30(on GigaEthernet0/0)
O      10.10.6.1/32         [110,2] via 10.10.255.17(on GigaEthernet0/2)
O      10.10.7.1/32         [110,2] via 10.10.255.26(on GigaEthernet0/3)
O IA   10.10.8.1/32         [110,3] via 10.10.255.30(on GigaEthernet0/0)
O E2   10.10.8.3/32         [150,20] via 10.10.255.30(on GigaEthernet0/0)
O      10.10.11.0/24        [110,3] via 10.10.255.17(on GigaEthernet0/2)
                            [110,3] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.21.0/24        [110,2] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.31.0/24        [110,3] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.255.0/30       [110,2] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.255.4/30       [110,3] via 10.10.255.17(on GigaEthernet0/2)
                            [110,3] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.255.8/30       [110,2] via 10.10.255.22(on GigaEthernet0/1)
O      10.10.255.12/30      [110,2] via 10.10.255.17(on GigaEthernet0/2)
O IA   10.10.255.40/30      [110,2] via 10.10.255.30(on GigaEthernet0/0)
O      10.10.255.44/30      [110,2] via 10.10.255.26(on GigaEthernet0/3)
O      10.16.110.0/24       [110,3] via 10.10.255.26(on GigaEthernet0/3)
O      10.16.120.0/24       [110,3] via 10.10.255.26(on GigaEthernet0/3)
O IA   10.17.110.0/24       [110,3] via 10.10.255.30(on GigaEthernet0/0)
O IA   10.17.120.0/24       [110,3] via 10.10.255.30(on GigaEthernet0/0)
</code></pre>
<p>RT2:</p>
<pre><code>RT2_config#sho ip route ospf 
VRF ID: 0

O E2   0.0.0.0/0            [150,10] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.1.1/32         [110,4] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.2.1/32         [110,3] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.3.1/32         [110,4] via 10.10.255.29(on GigaEthernet0/0)
O E2   10.10.3.2/32         [150,100] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.4.1/32         [110,2] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.6.1/32         [110,3] via 10.10.255.29(on GigaEthernet0/0)
O E2   10.10.7.1/32         [150,100] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.8.1/32         [110,2] via 10.10.255.42(on GigaEthernet0/1)
O N2   10.10.8.3/32         [150,20] via 10.10.255.42(on GigaEthernet0/1)
O      10.10.11.0/24        [110,4] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.21.0/24        [110,3] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.31.0/24        [110,4] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.255.0/30       [110,3] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.255.4/30       [110,4] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.255.8/30       [110,3] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.255.12/30      [110,3] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.255.16/30      [110,2] via 10.10.255.29(on GigaEthernet0/0)
O      10.10.255.20/30      [110,2] via 10.10.255.29(on GigaEthernet0/0)
O E2   10.10.255.24/30      [150,100] via 10.10.255.29(on GigaEthernet0/0)
O E2   10.16.110.0/24       [150,100] via 10.10.255.29(on GigaEthernet0/0)
O      10.17.110.0/24       [110,2] via 10.10.255.42(on GigaEthernet0/1)
O      10.17.120.0/24       [110,2] via 10.10.255.42(on GigaEthernet0/1)
</code></pre>
<p>AC1:</p>
<pre><code>AC1(config)#sho ip route os 
O*IA    0.0.0.0/0 [110/101] via 10.10.255.41, Vlan1001, 14:02:54  tag:0
Total routes are : 1 item(s)
</code></pre>
<p>FW1:</p>
<pre><code>FW1(config)# sho ip route ospf 
Codes: K - kernel route, C - connected, S - static, Z - ISP, R - RIP, O - OSPF,
       B - BGP, D - DHCP, P - PPPoE, W - wireless, H - HOST, G - SCVPN, V - VPN, M - IMPORT,
       I - ISIS, Y - SYNC, L - llb outbound, &gt; - selected first nexthop, * - FIB route, b - BFD enable

Routing Table for Virtual Router &lt;trust-vr&gt;
==============================================================================
O&gt;* 10.10.1.1/32 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08
O&gt;* 10.10.2.1/32 [110/3/1] via 10.10.255.14, ethernet0/1, 14:44:57
  *              [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57
O&gt;* 10.10.3.1/32 [110/3/1] via 10.10.255.14, ethernet0/1, 14:46:08
O&gt;* 10.10.3.2/32 [110/100/1] via 10.10.255.18, ethernet0/2, 12:00:17
O&gt;* 10.10.4.1/32 [110/2/1] via 10.10.255.18, ethernet0/2, 14:44:57
O&gt;* 10.10.5.1/32 [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57
O&gt;* 10.10.7.1/32 [110/100/1] via 10.10.255.18, ethernet0/2, 12:06:06
O&gt;* 10.10.8.1/32 [110/4/1] via 10.10.255.18, ethernet0/2, 14:03:32
O&gt;* 10.10.8.3/32 [110/20/1] via 10.10.255.18, ethernet0/2, 12:35:58
O&gt;* 10.10.11.0/24 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08
O&gt;* 10.10.21.0/24 [110/3/1] via 10.10.255.14, ethernet0/1, 14:44:57
  *               [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57
O&gt;* 10.10.31.0/24 [110/3/1] via 10.10.255.14, ethernet0/1, 14:46:08
O&gt;* 10.10.255.0/30 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08
O&gt;* 10.10.255.4/30 [110/2/1] via 10.10.255.14, ethernet0/1, 14:46:08
O&gt;* 10.10.255.8/30 [110/3/1] via 10.10.255.14, ethernet0/1, 14:44:57
  *                [110/3/1] via 10.10.255.18, ethernet0/2, 14:44:57
O&gt;* 10.10.255.20/30 [110/2/1] via 10.10.255.18, ethernet0/2, 14:44:59
O&gt;* 10.10.255.24/30 [110/100/1] via 10.10.255.18, ethernet0/2, 11:56:58
O&gt;* 10.10.255.28/30 [110/2/1] via 10.10.255.18, ethernet0/2, 14:44:59
O&gt;* 10.10.255.40/30 [110/3/1] via 10.10.255.18, ethernet0/2, 14:03:24
O&gt;* 10.16.110.0/24 [110/100/1] via 10.10.255.18, ethernet0/2, 11:59:52
O&gt;* 10.17.110.0/24 [110/4/1] via 10.10.255.18, ethernet0/2, 14:03:34
O&gt;* 10.17.120.0/24 [110/4/1] via 10.10.255.18, ethernet0/2, 14:03:34
==============================================================================

Routing Table for Virtual Router &lt;mgt-vr&gt;
==============================================================================
==============================================================================
</code></pre>
<p>FW2:</p>
<pre><code>FW2(config)# sho ip route os 
  &lt;cr&gt;              
  |                 Output modifiers
  vrouter           Virtual router
FW2(config)# sho ip route os 
Codes: K - kernel route, C - connected, S - static, Z - ISP, R - RIP, O - OSPF,
       B - BGP, D - DHCP, P - PPPoE, W - wireless, H - HOST, G - SCVPN, V - VPN, M - IMPORT,
       I - ISIS, Y - SYNC, L - llb outbound, &gt; - selected first nexthop, * - FIB route, b - BFD enable

Routing Table for Virtual Router &lt;trust-vr&gt;
==============================================================================
O&gt;* 0.0.0.0/0 [110/101/1] via 10.10.255.25, ethernet0/2, 12:12:31
O&gt;* 10.10.3.2/32 [110/2/1] via 10.10.255.46, ethernet0/1, 12:23:29
O&gt;* 10.10.4.4/32 [110/2/1] via 10.10.255.25, ethernet0/2, 12:12:32
O&gt;* 10.16.110.0/24 [110/2/1] via 10.10.255.46, ethernet0/1, 12:23:29
O&gt;* 10.16.120.0/24 [110/2/1] via 10.10.255.46, ethernet0/1, 12:23:29
==============================================================================

Routing Table for Virtual Router &lt;mgt-vr&gt;
==============================================================================
==============================================================================

</code></pre>
<h4 id="ospfv3">OSPFv3<a hidden class="anchor" aria-hidden="true" href="#ospfv3">#</a></h4>
<p>(1) SW1ã€SW2ã€SW3ã€RT1ã€RT2ã€FW1 ä¹‹é—´ OSPFv3 ï¼Œè¿›ç¨‹ 1ï¼ŒåŒºåŸŸ 0ï¼Œåˆ†åˆ«å‘å¸ƒ loopback1 åœ°å€è·¯ç”±å’Œäº§å“è·¯ç”±ï¼ŒFW1 é€šå‘Š type2 é»˜è®¤è·¯ç”±ã€‚</p>
<p>SW1:</p>
<pre><code>router ipv6 ospf 1
 router-id 10.10.1.1
 
 interface Loopback1
 ipv6 router ospf area 0 tag 1
 !
  interface Vlan10
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1021
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1022
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1026
 ipv6 router ospf area 0 tag 1
</code></pre>
<p>SW2:</p>
<pre><code>router ipv6 ospf 1
 router-id 10.10.2.1
 
 interface Loopback1
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan10
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1021
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1022
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1026
 ipv6 router ospf area 0 tag 1
</code></pre>
<p>SW3:</p>
<pre><code>router ipv6 ospf 1
 router-id 10.10.3.1
 
 interface Loopback1
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan10
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1021
 ipv6 router ospf area 0 tag 1
 !
 interface Vlan1022
 ipv6 router ospf area 0 tag 1
</code></pre>
<p>RT1:</p>
<pre><code>router ospfv3 1
 router-id 10.10.4.1
 
 interface Loopback1
 ipv6 enable
 ipv6 ospf 1 area 0 
!
interface GigaEthernet0/0
 ipv6 enable
 ipv6 ospf 1 area 0 
!
interface GigaEthernet0/1
 ipv6 enable
 ipv6 ospf 1 area 0 
!
interface GigaEthernet0/2
 ipv6 ospf 1 area 0 
 
</code></pre>
<p>RT2:</p>
<pre><code>router ospfv3 1
 router-id 10.10.5.1
 
 interface Loopback1
 ipv6 enable
 ipv6 ospf 1 area 0 
 !
 interface GigaEthernet0/0
 ipv6 enable
 ipv6 ospf 1 area 0 
</code></pre>
<p>FW1:</p>
<pre><code> ipv6 route ::/0 &quot;ethernet0/3&quot; FE80::203:FFF:FEE0:F9B8
 ipv6 router ospf 1
    router-id 10.10.6.1
    default-information originate
  exit
 
 !
 interface loopback1
  ipv6 enable
  ipv6 ospf 1 area 0
 !
 interface ethernet0/1
   ipv6 enable
   ipv6 ospf 1 area 0
 !
 interface ethernet0/2
   ipv6 enable
   ipv6 ospf 1 area 0
</code></pre>
<p>(3)RT2 ä¸ AC1 ä¹‹é—´è¿è¡Œ OSPFv3 åè®®ï¼Œè¿›ç¨‹ 1ï¼Œstub no-summary åŒºåŸŸ 1ï¼›AC1 å‘å¸ƒ loopback1 åœ°å€è·¯ç”±ã€äº§å“å’Œè¥é”€ã€‚</p>
<p>RT2:</p>
<pre><code>router ospfv3 1
 router-id 10.10.5.1
 area 1 stub no-summary
 
 interface GigaEthernet0/1
 ipv6 enable
 ipv6 ospf 1 area 1
 
</code></pre>
<p>AC1:</p>
<pre><code>router ipv6 ospf 1
 router-id 10.10.8.1
 area 1 stub no-summary
 
 interface Loopback1
 ipv6 router ospf area 1 tag 1
 !
 interface Vlan110
 ipv6 router ospf area 1 tag 1
 !
 interface Vlan120
 ipv6 router ospf area 1 tag 1
 !
 interface Vlan1001
 ipv6 router ospf area 1 tag 1
</code></pre>
<p>(4)SW3 æ¨¡æ‹ŸåŠäº‹å¤„é…ç½® ipv6 é»˜è®¤è·¯ç”±ï¼›FW2 åˆ†åˆ«é…ç½®åˆ° SW3 æ¨¡æ‹ŸåŠäº‹å¤„ loopback2ã€äº§å“å’Œè¥é”€çš„ ipv6 æ˜ç»†é™æ€è·¯ç”±ï¼ŒFW2 é‡å‘å¸ƒé™æ€ è·¯ç”±åˆ° OSPFv3 åè®®ã€‚</p>
<p>SW3:</p>
<pre><code>ipv6 route vrf Guangdong ::/0 fe80::203:fff:fea6:8341 Vlan1015
</code></pre>
<p>FW2:</p>
<pre><code>ip vrouter &quot;trust-vr&quot;
  ipv6 route 2001:10:10:3::1/128 &quot;ethernet0/1&quot; FE80::203:FFF:FEE0:F9B8
  ipv6 route 2001:10:16:110::/64 &quot;ethernet0/1&quot; FE80::203:FFF:FEE0:F9B8
  ipv6 route 2001:10:16:120::/64 &quot;ethernet0/1&quot; FE80::203:FFF:FEE0:F9B8
  exit
  ipv6 router ospf 2
    router-id 10.10.7.1
    redistribute static
  exit
</code></pre>
<p>(5)RT1ã€FW2 ä¹‹é—´OSPFv3 åè®®ï¼Œè¿›ç¨‹ 2ï¼ŒåŒºåŸŸ 2ï¼›RT1 å‘å¸ƒ loopback4è·¯ç”±ï¼Œå‘è¯¥åŒºåŸŸé€šå‘Š type1 é»˜è®¤è·¯ç”±ï¼›</p>
<p>RT1:</p>
<pre><code>router ospfv3 2
 router-id 10.10.4.4
 default-information originate always metric-type 1
 
 interface Loopback4
 ipv6 enable
 ipv6 ospf 2 area 2 
</code></pre>
<p>FW2 å‘å¸ƒ loopback1 è·¯ç”±ï¼ŒFW2 ç¦æ­¢å­¦ä¹ åˆ°é›†å›¢å’Œåˆ†å…¬å¸çš„æ‰€æœ‰è·¯ç”±ã€‚</p>
<p>FW2:</p>
<pre><code>interface loopback1
  ipv6 enable
  ipv6 ospf 2 area 2
  
  interface ethernet0/1
  ipv6 enable
  ipv6 ospf 2 area 2
exit
interface ethernet0/2
  ipv6 enable
  ipv6 ospf 2 area 2
exit
</code></pre>
<p>RT1 ç”¨ prefix-list åŒ¹é… FW2 loopback1 è·¯ç”±ã€SW3æ¨¡æ‹ŸåŠäº‹å¤„ loopback2 å’Œäº§å“è·¯ç”±ã€RT1 ä¸ FW2 ç›´è¿ ipv4 è·¯ç”±ï¼Œå°†è¿™äº›è·¯ç”±é‡å‘å¸ƒåˆ°åŒºåŸŸ 0ã€‚</p>
<pre><code>router ospfv3 1
 router-id 10.10.4.1
 redistribute ospf 2 route-map BSCV6Â·
 !
route-map BSCV6 10 permit
match ipv6 address prefix-list BSCV6
! 
ipv6 prefix-list BSCV6 seq 5 permit 2001:10:10:3::2/128
ipv6 prefix-list BSCV6 seq 10 permit 2001:10:16:110::/64
</code></pre>
<p>(6)ä¿®æ”¹ospf costä¸º100ï¼Œå®ç°SW1åˆ†åˆ«ä¸RT2ã€FW2ä¹‹é—´ipv4å’Œipv6äº’è®¿æµé‡ä¼˜å…ˆé€šè¿‡SW1_SW2_RT1é“¾è·¯è½¬å‘ï¼ŒSW2è®¿é—®Internet ipv4å’Œipv6æµé‡ä¼˜å…ˆé€šè¿‡SW2_SW1_FW1é“¾è·¯è½¬å‘ã€‚</p>
<p>FW1:</p>
<pre><code>interface ethernet0/2
  ip ospf cost 100
  ipv6 ospf cost 100
</code></pre>
<p>RT1:</p>
<pre><code>interface GigaEthernet0/2
 ip ospf cost 100
 ipv6 ospf cost 100
</code></pre>
<p><strong>IPV6è·¯ç”±è¡¨ï¼š</strong></p>
<p>SW1ï¼š</p>
<pre><code>SW1(config)#sho ipv route nsm ospf 
IPv6 Routing Table
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - IS-IS, B - BGP
Timers: Uptime

O   ::/0 [110/21] via fe80::203:fff:fea6:72c1, Vlan1021, 12:00:39  tag:0
O   2001:10:10:2::1/128 [110/1] via fe80::203:fff:fee0:f9b5, Vlan1026, 12:24:12  tag:0
O   2001:10:10:3::1/128 [110/1] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:16:43  tag:0
O   2001:10:10:3::2/128 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:20  tag:0
O   2001:10:10:4::1/128 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21  tag:0
O   2001:10:10:5::1/128 [110/3] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21  tag:0
O   2001:10:10:6::1/128 [110/2] via fe80::203:fff:fea6:72c1, Vlan1021, 12:05:24  tag:0
O   2001:10:10:8::1/128 [110/4] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21  tag:0
O   2001:10:10:21::/64 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1026, 12:24:12  tag:0
O   2001:10:10:31::/64 [110/2] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:16:43  tag:0
O   2001:10:16:110::/64 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:20  tag:0
O   2001:10:17:110::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21  tag:0
O   2001:10:17:120::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1026, 11:30:21  tag:0
</code></pre>
<p>SW2:</p>
<pre><code>SW2(config)#sho ipv route nsm ospf 
IPv6 Routing Table
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - IS-IS, B - BGP
Timers: Uptime

O   ::/0 [110/22] via fe80::203:fff:fee0:f9b2, Vlan1026, 11:31:37  tag:0
O   2001:10:10:1::1/128 [110/1] via fe80::203:fff:fee0:f9b2, Vlan1026, 12:24:52  tag:0
O   2001:10:10:3::1/128 [110/1] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:17:33  tag:0
O   2001:10:10:3::2/128 [110/150] via fe80::203:fff:fedc:c392, Vlan1021, 11:36:13  tag:0
O   2001:10:10:4::1/128 [110/1] via fe80::203:fff:fedc:c392, Vlan1021, 12:14:02  tag:0
O   2001:10:10:5::1/128 [110/2] via fe80::203:fff:fedc:c392, Vlan1021, 12:11:48  tag:0
O   2001:10:10:6::1/128 [110/3] via fe80::203:fff:fee0:f9b2, Vlan1026, 11:31:38  tag:0
O   2001:10:10:8::1/128 [110/3] via fe80::203:fff:fedc:c392, Vlan1021, 11:59:02  tag:0
O   2001:10:10:11::/64 [110/2] via fe80::203:fff:fee0:f9b2, Vlan1026, 12:24:52  tag:0
O   2001:10:10:31::/64 [110/2] via fe80::203:fff:fee0:f9b8, Vlan1022, 12:17:33  tag:0
O   2001:10:16:110::/64 [110/150] via fe80::203:fff:fedc:c392, Vlan1021, 11:36:13  tag:0
O   2001:10:17:110::/64 [110/4] via fe80::203:fff:fedc:c392, Vlan1021, 11:59:02  tag:0
O   2001:10:17:120::/64 [110/4] via fe80::203:fff:fedc:c392, Vlan1021, 11:59:02  tag:0
</code></pre>
<p>SW3:</p>
<pre><code>SW3#sho ipv route nsm ospf 
IPv6 Routing Table
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - IS-IS, B - BGP
Timers: Uptime

O   ::/0 [110/22] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:01:49  tag:0
O   2001:10:10:1::1/128 [110/1] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:17:56  tag:0
O   2001:10:10:2::1/128 [110/1] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:17:56  tag:0
O   2001:10:10:3::2/128 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:36:44  tag:0
O   2001:10:10:4::1/128 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:14:33  tag:0
O   2001:10:10:5::1/128 [110/3] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:12:19  tag:0
O   2001:10:10:6::1/128 [110/3] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:06:35  tag:0
O   2001:10:10:8::1/128 [110/4] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:59:33  tag:0
O   2001:10:10:11::/64 [110/2] via fe80::203:fff:fee0:f9b2, Vlan1021, 12:17:56  tag:0
O   2001:10:10:21::/64 [110/2] via fe80::203:fff:fee0:f9b5, Vlan1022, 12:17:56  tag:0
O   2001:10:16:110::/64 [110/150] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:36:44  tag:0
O   2001:10:17:110::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:59:33  tag:0
O   2001:10:17:120::/64 [110/5] via fe80::203:fff:fee0:f9b5, Vlan1022, 11:59:33  tag:0
</code></pre>
<p>RT1:</p>
<pre><code>RT1_config#sho ipv route ospf 
OE1    ::/0[1]
        [110,23] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
O      2001:10:10:1::1/128[1]
        [110,2] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
O      2001:10:10:2::1/128[1]
        [110,1] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
O      2001:10:10:3::1/128[1]
        [110,2] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
OE2    2001:10:10:3::2/128[1]
        [110,20] via fe80::203:fff:fea6:8342(on GigaEthernet0/3)
O      2001:10:10:5::1/128[1]
        [110,1] via fe80::203:fff:fedc:c389(on GigaEthernet0/0)
O      2001:10:10:6::1/128[1]
        [110,4] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
O      2001:10:10:7::1/128[1]
        [110,2] via fe80::203:fff:fea6:8342(on GigaEthernet0/3)
OIA    2001:10:10:8::1/128[1]
        [110,2] via fe80::203:fff:fedc:c389(on GigaEthernet0/0)
O      2001:10:10:11::/64[1]
        [110,3] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
O      2001:10:10:21::/64[1]
        [110,2] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
O      2001:10:10:31::/64[1]
        [110,3] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
OE2    2001:10:16:110::/64[1]
        [110,20] via fe80::203:fff:fea6:8342(on GigaEthernet0/3)
OE2    2001:10:16:120::/64[1]
        [110,20] via fe80::203:fff:fea6:8342(on GigaEthernet0/3)
OIA    2001:10:17:110::/64[1]
        [110,3] via fe80::203:fff:fedc:c389(on GigaEthernet0/0)
OIA    2001:10:17:120::/64[1]
        [110,3] via fe80::203:fff:fedc:c389(on GigaEthernet0/0)
</code></pre>
<p>RT2:</p>
<pre><code>RT2_config#sho ipv route ospf 
OE1    ::/0[1]
        [110,24] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:1::1/128[1]
        [110,3] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:2::1/128[1]
        [110,2] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:3::1/128[1]
        [110,3] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
OE2    2001:10:10:3::2/128[1]
        [110,150] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:4::1/128[1]
        [110,1] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:6::1/128[1]
        [110,5] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:8::1/128[1]
        [110,1] via fe80::203:fff:fed4:28b2(on GigaEthernet0/1)
O      2001:10:10:11::/64[1]
        [110,4] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:21::/64[1]
        [110,3] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:10:31::/64[1]
        [110,4] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
OE2    2001:10:16:110::/64[1]
        [110,150] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
O      2001:10:17:110::/64[1]
        [110,2] via fe80::203:fff:fed4:28b2(on GigaEthernet0/1)
O      2001:10:17:120::/64[1]
        [110,2] via fe80::203:fff:fed4:28b2(on GigaEthernet0/1)
</code></pre>
<p>AC1:</p>
<pre><code>AC1(config)#sho ipv route nsm ospf 
IPv6 Routing Table
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - IS-IS, B - BGP
Timers: Uptime

O   ::/0 [110/2] via fe80::203:fff:fedc:c38a, Vlan1001, 12:01:37  tag:0
</code></pre>
<p>FW1:</p>
<pre><code>FW1(config)# sho ipv route ospf ?
  &lt;cr&gt;              
  |                 Output modifiers
  vrouter           Virtual router
FW1(config)# sho ipv route ospf 
Codes: K - kernel route, C - connected, S - static, R - RIPng, O - OSPFv3, 
       B - BGP, I - ISIS, A - AUTOCONF, H - HOST, &gt; - selected route,
       * - FIB route,

Routing Table for Virtual Router &lt;trust-vr&gt;
==============================================================================
O&gt;  2001:10:10:1::1/128
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/1/1]
O&gt;  2001:10:10:2::1/128
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/2/1]
O&gt;  2001:10:10:3::1/128
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/2/1]
O&gt;  2001:10:10:3::2/128
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/150/1]
O&gt;  2001:10:10:4::1/128
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/3/1]
O&gt;  2001:10:10:5::1/128
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/4/1]
O&gt;  2001:10:10:8::1/128
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/5/1]
O&gt;  2001:10:10:11::/64
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/2/1]
O&gt;  2001:10:10:21::/64
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/3/1]
O&gt;  2001:10:10:31::/64
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/3/1]
O&gt;  2001:10:16:110::/64
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/150/1]
O&gt;  2001:10:17:110::/64
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/6/1]
O&gt;  2001:10:17:120::/64
  * via FE80::203:FFF:FEE0:F9B2, ethernet0/1 [110/6/1]
==============================================================================

Routing Table for Virtual Router &lt;mgt-vr&gt;
==============================================================================
==============================================================================
</code></pre>
<p>FW2:</p>
<pre><code>FW2(config)# sho ipv route ospf 
Codes: K - kernel route, C - connected, S - static, R - RIPng, O - OSPFv3, 
       B - BGP, I - ISIS, A - AUTOCONF, H - HOST, &gt; - selected route,
       * - FIB route,

Routing Table for Virtual Router &lt;trust-vr&gt;
==============================================================================
O&gt;  ::/0
  * via FE80::203:FFF:FEDC:C394, ethernet0/2 [110/151/1]
O&gt;  2001:10:10:4::4/128
  * via FE80::203:FFF:FEDC:C394, ethernet0/2 [110/1/1]
==============================================================================

Routing Table for Virtual Router &lt;mgt-vr&gt;
==============================================================================
==============================================================================
</code></pre>
<h3 id="6rip">6ã€RIP<a hidden class="anchor" aria-hidden="true" href="#6rip">#</a></h3>
<p>RT1ä¸²è¡Œé“¾è·¯ã€RT2ä¸²è¡Œé“¾è·¯ã€FW1ã€AC1ä¹‹é—´åˆ†åˆ«è¿è¡ŒRIPå’ŒRIPngåè®®ï¼Œ FW1ã€RT1ã€RT2çš„RIPå’ŒRIPngå‘å¸ƒloopback2åœ°å€è·¯ç”±ï¼ŒAC1 RIPå‘å¸ƒloopback2 åœ°å€è·¯ç”±ï¼ŒAC1 RIPngé‡‡ç”¨route-mapåŒ¹é…prefix-listé‡å‘å¸ƒloopback2åœ°å€è·¯ç”±ã€‚</p>
<p><strong>IPV4:</strong></p>
<p>FW1:</p>
<pre><code> router rip
    network 10.10.6.2/32
    network 10.10.255.16/30
</code></pre>
<p>RT1:</p>
<pre><code>router rip 1 
 version 2
 no auto-summary
 
 interface Loopback2
 ip rip 1 enable
 !
 interface Serial1/0
 ip rip 1 enable
 !
 interface Serial1/1
 ip rip 1 enable
 !
 interface GigaEthernet0/2
 ip rip 1 enable
 !
</code></pre>
<p>RT2:</p>
<pre><code>router rip 1 
 version 2
 no auto-summary
 
 interface Loopback2
 ip rip 1 enable
 !
 interface Serial1/0
 ip rip 1 enable
 !
 interface Serial1/1
 ip rip 1 enable
 !
 interface GigaEthernet0/1
 ip rip 1 enable
</code></pre>
<p>AC1:</p>
<pre><code>router rip
 network Loopback2
 network Vlan1001
</code></pre>
<p>RT1é…ç½®offsetå€¼ä¸º3çš„è·¯ç”±ç­–ç•¥ï¼Œå®ç°RT1-S1/0_RT2-S1/1ä¸ºä¸»é“¾è·¯ï¼Œ RT1-1/1_RT2-S1/0ä¸ºå¤‡ä»½é“¾è·¯ï¼Œipv4çš„ACLåç§°ä¸ºAclRIPï¼Œipv6çš„ACLåç§°ä¸ºAclRIPngã€‚</p>
<pre><code>router rip 1 
 version 2
 no auto-summary
 offset Serial1/1 in AclRIP 3 
 offset Serial1/1 out AclRIP 3 
!
ip access-list standard AclRIP
 permit any sequence 10
</code></pre>
<h4 id="ripng">RIPng<a hidden class="anchor" aria-hidden="true" href="#ripng">#</a></h4>
<p>RT1ä¸²è¡Œé“¾è·¯ã€RT2ä¸²è¡Œé“¾è·¯ã€FW1ã€AC1ä¹‹é—´è¿è¡ŒRIPngåè®®ï¼Œ FW1ã€RT1ã€RT2çš„RIPngå‘å¸ƒloopback2åœ°å€è·¯ç”±ï¼ŒAC1 RIPå‘å¸ƒloopback2 åœ°å€è·¯ç”±ï¼ŒAC1 RIPngé‡‡ç”¨route-mapåŒ¹é…prefix-listé‡å‘å¸ƒloopback2åœ°å€è·¯ç”±ã€‚</p>
<p>FW1:</p>
<pre><code> ipv6 router rip
    network loopback2
    network ethernet0/2
</code></pre>
<p>RT1:</p>
<pre><code>router ripng 1

interface Loopback2
 ipv6 rip 1 enable 
!
interface Serial1/0
 ipv6 rip 1 enable
!
interface Serial1/1
 ipv6 rip 1 enable 
!
interface GigaEthernet0/2
 ipv6 rip 1 enable 
</code></pre>
<p>RT2:</p>
<pre><code>router ripng 1

interface Loopback2
 ipv6 rip 1 enable 
!
interface Serial1/0
 ipv6 rip 1 enable 
!
interface Serial1/1
 ipv6 rip 1 enable 
!
interface GigaEthernet0/1
 ipv6 rip 1 enable 
</code></pre>
<p>AC1ï¼š</p>
<pre><code>router ipv6 rip
 redistribute connected route-map L2V6
!
route-map L2V6 permit 10
 match ipv6 address prefix-list L2V6
!
ipv6 prefix-list L2V6 seq 5 permit 2001:10:10:8::2/128
!
interface Vlan1001
 ipv6 router rip 
</code></pre>
<p>RT1é…ç½®offsetå€¼ä¸º3çš„è·¯ç”±ç­–ç•¥ï¼Œå®ç°RT1-S1/0_RT2-S1/1ä¸ºä¸»é“¾è·¯ï¼Œ RT1-1/1_RT2-S1/0ä¸ºå¤‡ä»½é“¾è·¯ï¼Œipv4çš„ACLåç§°ä¸ºAclRIPï¼Œipv6çš„ACLåç§°ä¸ºAclRIPngã€‚</p>
<p>RT1:</p>
<pre><code>router ripng 1
 offset Serial1/1 in AclRIPng 3 
 offset Serial1/1 out AclRIPng 3 
!
ipv6 access-list AclRIPng massive
 permit ipv6 any any sequence 10
</code></pre>
<h4 id="chapåŒå‘è®¤è¯">chapåŒå‘è®¤è¯<a hidden class="anchor" aria-hidden="true" href="#chapåŒå‘è®¤è¯">#</a></h4>
<p>RT1çš„S1/0ä¸RT2çš„S1/1ä¹‹é—´é‡‡ç”¨chapåŒå‘è®¤è¯ï¼Œç”¨æˆ·åä¸ºå¯¹ç«¯è®¾å¤‡åç§°ï¼Œå¯†ç ä¸ºPass-1234ã€‚</p>
<p>RT1:</p>
<pre><code>aaa authentication ppp default local
!
username RT2 password 0 Pass-1234
!
interface Serial1/0
 ppp authentication chap 
 ppp chap hostname RT1
 ppp chap password 0 Pass-1234
</code></pre>
<p>RT2:</p>
<pre><code>aaa authentication ppp default local
!
username RT1 password 0 Pass-1234
!
interface Serial1/1
 ppp authentication chap 
 ppp chap hostname RT2
 ppp chap password 0 Pass-1234
</code></pre>
<p>è·¯ç”±è¡¨ï¼š</p>
<p>FW1:</p>
<pre><code>FW1(config)# sho ip route rip  
Codes: K - kernel route, C - connected, S - static, Z - ISP, R - RIP, O - OSPF,
       B - BGP, D - DHCP, P - PPPoE, W - wireless, H - HOST, G - SCVPN, V - VPN, M - IMPORT,
       I - ISIS, Y - SYNC, L - llb outbound, &gt; - selected first nexthop, * - FIB route, b - BFD enable

Routing Table for Virtual Router &lt;trust-vr&gt;
==============================================================================
R&gt;* 10.10.4.2/32 [120/2/1] via 10.10.255.18, ethernet0/2, 09:01:13
R&gt;* 10.10.5.2/32 [120/3/1] via 10.10.255.18, ethernet0/2, 07:44:32
R&gt;* 10.10.8.2/32 [120/4/1] via 10.10.255.18, ethernet0/2, 07:44:32
R&gt;* 10.10.255.32/30 [120/2/1] via 10.10.255.18, ethernet0/2, 07:44:43
R&gt;* 10.10.255.36/30 [120/2/1] via 10.10.255.18, ethernet0/2, 07:44:43
R   10.10.255.40/30 [120/3/1] via 10.10.255.18, ethernet0/2, 07:44:32
==============================================================================

Routing Table for Virtual Router &lt;mgt-vr&gt;
==============================================================================
==============================================================================
</code></pre>
<p>RT1:</p>
<pre><code>RT1_config#sho ip route rip  
VRF ID: 0

R      10.10.5.2/32         [120,1] via 10.10.255.34(on Serial1/0)
R      10.10.6.2/32         [120,1] via 10.10.255.17(on GigaEthernet0/2)
R      10.10.8.2/32         [120,2] via 10.10.255.34(on Serial1/0)
</code></pre>
<p>RT2:</p>
<pre><code>RT2_config#sho ip route rip 
VRF ID: 0

R      10.10.4.2/32         [120,1] via 10.10.255.33(on Serial1/1)
R      10.10.6.2/32         [120,2] via 10.10.255.33(on Serial1/1)
R      10.10.8.2/32         [120,1] via 10.10.255.42(on GigaEthernet0/1)
</code></pre>
<p>AC1:</p>
<pre><code>AC1(config)#sho ip route rip 
R       10.10.4.2/32 [120/3] via 10.10.255.41, Vlan1001, 00:00:25  tag:1
R       10.10.5.2/32 [120/2] via 10.10.255.41, Vlan1001, 00:00:25  tag:1
R       10.10.6.2/32 [120/4] via 10.10.255.41, Vlan1001, 07:47:32  tag:0
R       10.10.255.16/30 [120/3] via 10.10.255.41, Vlan1001, 00:00:25  tag:1
R       10.10.255.32/30 [120/2] via 10.10.255.41, Vlan1001, 00:00:25  tag:1
R       10.10.255.36/30 [120/2] via 10.10.255.41, Vlan1001, 00:00:25  tag:1
Total routes are : 6 item(s)
</code></pre>
<h3 id="7isis">7ã€ISIS<a hidden class="anchor" aria-hidden="true" href="#7isis">#</a></h3>
<p>RT1 ä»¥å¤ªé“¾è·¯ã€RT2 ä»¥å¤ªé“¾è·¯ä¹‹é—´è¿è¡Œ ISIS åè®®ï¼Œè¿›ç¨‹ 1ï¼Œåˆ†åˆ«å®ç° loopback3 ä¹‹é—´ ipv4 äº’é€šå’Œ ipv6 äº’é€šã€‚RT1ã€RT2 çš„ NET åˆ†åˆ«ä¸º10.0000.0000.0001.00ã€10.0000.0000.0002.00ï¼Œè·¯ç”±å™¨ç±»å‹æ˜¯Level-2ï¼Œæ¥å£ç½‘ç»œç±»å‹ä¸ºç‚¹åˆ°ç‚¹ã€‚</p>
<p>RT1:</p>
<pre><code>router isis 1
 is-type level-2
 net 10.0000.0000.0001.00
!
interface Loopback3
 ip router isis 1 
 ipv6 router isis 1
!
interface GigaEthernet0/0
 ip router isis 1 
 ipv6 router isis 1
 isis network point-to-point
 isis circuit-type level-2
</code></pre>
<p>RT2:</p>
<pre><code> router isis 1
  is-type level-2
  net 10.0000.0000.0002.00
 !
 interface Loopback3
  ip router isis 1 
  ipv6 router isis 1
 !
 interface GigaEthernet0/0
  ip router isis 1 
  ipv6 router isis 1
  isis network point-to-point
  isis circuit-type level-2
  isis network point-to-point
</code></pre>
<p>é…ç½®åŸŸmd5è®¤è¯å’Œæ¥å£md5è®¤è¯ï¼Œå¯†ç å‡ä¸ºPass-1234ã€‚</p>
<p>RT1:</p>
<pre><code>router isis 1
 authentication mode md5 level-2
 authentication key 0 Pass-1234 level-2
!
interface GigaEthernet0/0
 isis authentication mode md5 level-2
 isis authentication key 0 Pass-1234
</code></pre>
<p>RT2:</p>
<pre><code>router isis 1
 authentication mode md5 level-2
 authentication key 0 Pass-1234 level-2
!
interface GigaEthernet0/0
 isis authentication mode md5 level-2
 isis authentication key 0 Pass-1234 level-2
</code></pre>
<h3 id="8nat">8ã€nat<a hidden class="anchor" aria-hidden="true" href="#8nat">#</a></h3>
<p>RT2é…ç½®ipv4 natï¼Œå®ç°AC1 ipv4äº§å“éƒ¨é—¨ç”¨RT2å¤–ç½‘æ¥å£ipv4åœ°å€è®¿é—®Internetã€‚RT2é…ç½®nat64ï¼Œå®ç°AC1 ipv6äº§å“éƒ¨é—¨ç”¨RT2å¤–ç½‘æ¥å£ipv4åœ°å€è®¿é—®Internetï¼Œipv4åœ°å€è½¬ipv6åœ°å€å‰ç¼€ä¸º64:ff9b::/96ã€‚</p>
<p><strong>IPV4:</strong></p>
<p>RT2:</p>
<pre><code>ip route default 200.200.200.5 
!
ip access-list standard NAT
 permit 10.17.110.0 255.255.255.0 sequence 10
!
ip nat inside source list NAT interface GigaEthernet0/3
!
interface GigaEthernet0/1
  ip nat inside
!
interface GigaEthernet0/3
 ip nat outside
!
router ospf 1
 default-information originate
</code></pre>
<p>ç»“æœéªŒè¯ï¼š</p>
<p>AC1:</p>
<pre><code>AC1#ping src 10.17.110.1 200.200.200.5
Type ^c to abort.
Sending 5 56-byte ICMP Echos to 200.200.200.5, using source address 10.17.110.1, timeout is 2 seconds.
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 0/14/20 ms
</code></pre>
<p>RT2:</p>
<pre><code>RT2_config#sho ip nat translations 
Pro. Dir Inside local       Inside global      Outside local      Outside global
ICMP OUT 10.17.110.1:4660   200.200.200.6:4660 200.200.200.5:4660 200.200.200.5:4660 
</code></pre>
<p><strong>IPV6:</strong></p>
<pre><code>ipv6 access-list NATV6 massive
 permit ipv6 2001:10:17:110::/64 any sequence 10
!
ipv6 nat v6v4 source list NATV6 interface GigaEthernet0/3
ipv6 nat prefix 64:FF9B::/96 v4-mapped NATV6
!
interface GigaEthernet0/3
 ipv6 nat
!
interface GigaEthernet0/1
 ipv6 nat
</code></pre>
<p>ç»“æœéªŒè¯ï¼š</p>
<p>AC1:</p>
<pre><code>AC1#ping6 src 2001:10:17:110::1 64:ff9b::200.200.200.5

Type ^c to abort.
Sending 5 56-byte ICMP Echos to 64:ff9b::200.200.200.5, using src address 2001:10:17:110::1, timeout is 2 seconds.
!!!!!
Success rate is 100 percent (5/5), round-trip min/avg/max = 0/6/20 ms
</code></pre>
<p>RT2:</p>
<pre><code>RT2_config#sho ipv nat translations 
Prot  V6Src             V6Dst             V4Src             V4Dst             
ICMP  2001:10:17:110::1-466064:FF9B::C8C8:C805-4660200.200.200.6-4660200.200.200.5-4660
</code></pre>
<h3 id="9bgp">9ã€BGP<a hidden class="anchor" aria-hidden="true" href="#9bgp">#</a></h3>
<p>SW1ã€SW2ã€SW3ã€RT1ã€RT2 ä¹‹é—´è¿è¡Œ BGP åè®®ï¼ŒSW1ã€SW2ã€RT1 AS å· 65001ã€ RT2 AS å· 65002ã€SW3 AS å· 65003ã€‚</p>
<h4 id="ipv4-bgp"><strong>ipv4 BGP</strong><a hidden class="anchor" aria-hidden="true" href="#ipv4-bgp">#</a></h4>
<p>(1)SW1ã€SW2ã€SW3ã€RT1ã€RT2 ä¹‹é—´é€šè¿‡ loopback1 å»ºç«‹ ipv4BGP é‚» å±…ã€‚SW1 å’Œ SW2 ä¹‹é—´è´¢åŠ¡é€šè¿‡ loopback2 å»ºç«‹ ipv4 BGP é‚»å±…ï¼ŒSW1 å’Œ SW2 çš„ loopback2 äº’é€šé‡‡ç”¨é™æ€è·¯ç”±ã€‚</p>
<p>SW1:</p>
<pre><code>router bgp 65001
 bgp router-id 10.10.1.1
 neighbor 10.10.2.1 remote-as 65001
 neighbor 10.10.2.1 update-source 10.10.1.1
 neighbor 10.10.2.1 next-hop-self
 neighbor 10.10.3.1 remote-as 65003
 neighbor 10.10.3.1 ebgp-multihop 255
 neighbor 10.10.3.1 update-source 10.10.1.1
 neighbor 10.10.4.1 remote-as 65001
 neighbor 10.10.4.1 update-source 10.10.1.1
 neighbor 10.10.4.1 next-hop-self
</code></pre>
<pre><code> ip route vrf CW 10.10.2.2/32 10.10.255.2
 router bgp 65001
  address-family ipv4 vrf CW
  network 10.10.14.0/24
  neighbor 10.10.2.2 remote-as 65001
  neighbor 10.10.2.2 update-source 10.10.1.2
  exit-address-family
</code></pre>
<p>SW2:</p>
<pre><code>router bgp 65001
 bgp router-id 10.10.2.1
 neighbor 10.10.1.1 remote-as 65001
 neighbor 10.10.1.1 update-source 10.10.2.1
 neighbor 10.10.1.1 next-hop-self
 neighbor 10.10.3.1 remote-as 65003
 neighbor 10.10.3.1 ebgp-multihop 255
 neighbor 10.10.3.1 update-source 10.10.2.1
 neighbor 10.10.4.1 remote-as 65001
 neighbor 10.10.4.1 update-source 10.10.2.1
 neighbor 10.10.4.1 next-hop-self
</code></pre>
<pre><code>ip route vrf CW 10.10.1.2/32 10.10.255.1
router bgp 65001
 address-family ipv4 vrf CW
 network 10.10.24.0/24
 neighbor 10.10.1.2 remote-as 65001
 neighbor 10.10.1.2 update-source 10.10.2.2
 exit-address-familys
</code></pre>
<p>SW3:</p>
<pre><code>router bgp 65003
 bgp router-id 10.10.3.1
 neighbor 10.10.1.1 remote-as 65001
 neighbor 10.10.1.1 ebgp-multihop 255
 neighbor 10.10.1.1 update-source 10.10.3.1
 neighbor 10.10.2.1 remote-as 65001
 neighbor 10.10.2.1 ebgp-multihop 255
 neighbor 10.10.2.1 update-source 10.10.3.1
</code></pre>
<p>RT1:</p>
<pre><code>router bgp 65001
 bgp router-id 10.10.4.1
 neighbor 10.10.1.1 remote-as 65001 
 neighbor 10.10.1.1 update-source Loopback1
 neighbor 10.10.1.1 next-hop-self
 neighbor 10.10.2.1 remote-as 65001 
 neighbor 10.10.2.1 update-source Loopback1
 neighbor 10.10.2.1 next-hop-self
 neighbor 10.10.5.1 remote-as 65002 
 neighbor 10.10.5.1 ebgp-multihop 255
 neighbor 10.10.5.1 update-source Loopback1
</code></pre>
<p>RT2:</p>
<pre><code>router bgp 65002
 bgp router-id 10.10.5.1
 neighbor 10.10.4.1 remote-as 65001 
 neighbor 10.10.4.1 ebgp-multihop 255
 neighbor 10.10.4.1 update-source Loopback1
</code></pre>
<p>(2)SW1ã€SW2ã€SW3ã€RT2 åˆ†åˆ«åªå‘å¸ƒè¥é”€ã€æ³•åŠ¡ã€è´¢åŠ¡ã€äººåŠ›ç­‰ ipv4è·¯ç”±ï¼›RT1 å‘å¸ƒåŠäº‹å¤„è¥é”€ ipv4è·¯ç”±åˆ° BGPã€‚</p>
<p>SW1:</p>
<pre><code>router bgp 65001
 network 10.10.12.0/24
 network 10.10.13.0/24
 network 10.10.15.0/24
</code></pre>
<p>SW2:</p>
<pre><code>router bgp 65001
 network 10.10.22.0/24
 network 10.10.23.0/24
 network 10.10.25.0/24
</code></pre>
<p>SW3:</p>
<pre><code>router bgp 65003
 network 10.10.32.0/24
 network 10.10.33.0/24
 network 10.10.35.0/24
</code></pre>
<p>RT2:</p>
<pre><code>router bgp 65002
 network 10.17.120.0/24
</code></pre>
<p>RT1:</p>
<pre><code>router bgp 65001
 redistribute ospf 2 route-map BGP
!
route-map BGP 10 permit
 match ip address prefix-list BGP
!
ip prefix-list BGP seq 5 permit 10.16.120.0/24 	
</code></pre>
<p>(3)SW3 è¥é”€åˆ†åˆ«ä¸ SW1 å’Œ SW2 è¥é”€ ipv4äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW1 é“¾è·¯ è½¬å‘ï¼›SW3 æ³•åŠ¡åŠäººåŠ›åˆ†åˆ«ä¸ SW1 å’Œ SW2 æ³•åŠ¡åŠäººåŠ› ipv4äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW2 é“¾è·¯è½¬å‘ï¼Œä¸»å¤‡é“¾è·¯ç›¸äº’å¤‡ä»½ï¼›ç”¨ prefix-listã€route-map å’Œ BGP è·¯ å¾„å±æ€§è¿›è¡Œé€‰è·¯ï¼Œæ–°å¢ AS 65000ã€‚</p>
<p>SW1:</p>
<pre><code>router bgp 65001
 neighbor 10.10.3.1 route-map R&amp;F in
!
route-map R&amp;F permit 10
 match ip address prefix-list R&amp;F
 set as-path prepend 65000
!
route-map R&amp;F permit 20
!
ip prefix-list R&amp;F seq 5 permit 10.10.35.0/24
ip prefix-list R&amp;F seq 10 permit 10.10.33.0/24
</code></pre>
<p>SW2:</p>
<pre><code>router bgp 65001
 neighbor 10.10.3.1 route-map R&amp;F in
!
route-map R&amp;F permit 10
 match ip address prefix-list R&amp;F
 set as-path prepend 65000
!
route-map R&amp;F permit 20
!
ip prefix-list R&amp;F seq 5 permit 10.10.32.0/24
</code></pre>
<p>SW3:</p>
<pre><code>router bgp 65003
  neighbor 10.10.1.1 route-map R&amp;F in
  neighbor 10.10.2.1 route-map YX in
!
route-map R&amp;F permit 10
 match ip address prefix-list R&amp;F
 set as-path prepend 65000
!
route-map R&amp;F permit 20
!
route-map YX permit 10
 match ip address prefix-list YX
 set as-path prepend 65000
!
route-map YX permit 20
!
ip prefix-list R&amp;F seq 5 permit 10.10.13.0/24
ip prefix-list R&amp;F seq 10 permit 10.10.23.0/24
ip prefix-list R&amp;F seq 15 permit 10.10.15.0/24
ip prefix-list R&amp;F seq 20 permit 10.10.25.0/24
ip prefix-list YX seq 5 permit 10.10.12.0/24
ip prefix-list YX seq 10 permit 10.10.22.0/24
ip prefix-list YX seq 15 permit 10.16.120.0/24
ip prefix-list YX seq 20 permit 10.17.120.0/24
</code></pre>
<p>è·¯ç”±è¡¨ï¼š</p>
<p>SW1:</p>
<pre><code>SW1(config)#sho ip route bgp 
B       10.10.22.0/24 [200/0] via 10.10.2.1 (recursive via 10.10.255.2, Vlan1026), 01:01:28  tag:0
B       10.10.23.0/24 [200/0] via 10.10.2.1 (recursive via 10.10.255.2, Vlan1026), 01:01:28  tag:0
B       10.10.25.0/24 [200/0] via 10.10.2.1 (recursive via 10.10.255.2, Vlan1026), 01:01:28  tag:0
B       10.10.32.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.6, Vlan1022), 01:00:34  tag:0
B       10.10.33.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.6, Vlan1022), 01:00:34  tag:0
B       10.10.35.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.6, Vlan1022), 01:00:34  tag:0
B       10.16.120.0/24 [200/3] via 10.10.4.1 (recursive via 10.10.255.2, Vlan1026), 01:00:43  tag:0
Total routes are : 7 item(s)
</code></pre>
<p>SW2:</p>
<pre><code>SW2#sho ip route bgp 
B       10.10.12.0/24 [200/0] via 10.10.1.1 (recursive via 10.10.255.1, Vlan1026), 01:01:42  tag:0
B       10.10.13.0/24 [200/0] via 10.10.1.1 (recursive via 10.10.255.1, Vlan1026), 01:01:42  tag:0
B       10.10.15.0/24 [200/0] via 10.10.1.1 (recursive via 10.10.255.1, Vlan1026), 01:01:42  tag:0
B       10.10.32.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.10, Vlan1022), 01:01:00  tag:0
B       10.10.33.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.10, Vlan1022), 01:01:00  tag:0
B       10.10.35.0/24 [20/0] via 10.10.3.1 (recursive via 10.10.255.10, Vlan1022), 01:01:00  tag:0
B       10.16.120.0/24 [200/3] via 10.10.4.1 (recursive via 10.10.255.21, Vlan1021), 01:00:55  tag:0
Total routes are : 7 item(s)
</code></pre>
<p>SW3:</p>
<pre><code>SW3#sho ip bgp      
BGP table version is 4, local router ID is 10.10.3.1
Status codes: s suppressed, d damped, h history, * valid, &gt; best, i - internal,
              S Stale
Origin codes: i - IGP, e - EGP, ? - incomplete

   Network          Next Hop            Metric LocPrf Weight Path
*  10.10.12.0/24    10.10.1.1                              0 65001 i
*                   10.10.2.1                              0 65001 i
*                   10.10.2.1                              0 65000 65001 i
*&gt;                  10.10.1.1                              0 65001 i
*  10.10.13.0/24    10.10.1.1                              0 65001 i
*                   10.10.2.1                              0 65001 i
*&gt;                  10.10.2.1                              0 65001 i
*                   10.10.1.1                              0 65000 65001 i
*  10.10.15.0/24    10.10.1.1                              0 65001 i
*                   10.10.2.1                              0 65001 i
*&gt;                  10.10.2.1                              0 65001 i
*                   10.10.1.1                              0 65000 65001 i
*  10.10.22.0/24    10.10.2.1                              0 65001 i
*                   10.10.2.1                              0 65000 65001 i
*                   10.10.1.1                              0 65001 i
*&gt;                  10.10.1.1                              0 65001 i
*  10.10.23.0/24    10.10.2.1                              0 65001 i
*                   10.10.2.1                              0 65001 i
*                   10.10.1.1                              0 65000 65001 i
*&gt;                  10.10.1.1                              0 65001 i
*  10.10.25.0/24    10.10.2.1                              0 65001 i
*                   10.10.2.1                              0 65001 i
*                   10.10.1.1                              0 65000 65001 i
*&gt;                  10.10.1.1                              0 65001 i
*&gt; 10.10.32.0/24    0.0.0.0                            32768 i
*&gt; 10.10.33.0/24    0.0.0.0                            32768 i
*&gt; 10.10.35.0/24    0.0.0.0                            32768 i
*  10.16.120.0/24   10.10.2.1                              0 65001 ?
*                   10.10.2.1                              0 65000 65001 ?
*                   10.10.1.1                              0 65001 ?
*&gt;                  10.10.1.1                              0 65001 ?
*  10.17.120.0/24   10.10.2.1                              0 65001 65002 i
*                   10.10.2.1                              0 65000 65001 65002 i
*                   10.10.1.1                              0 65001 65002 i
*&gt;                  10.10.1.1                              0 65001 65002 i

Total number of prefixes 11
</code></pre>
<p>RT1:</p>
<pre><code>RT1#sho ip route bgp 
VRF ID: 0

B      10.10.12.0/24        [200,0] via 10.10.1.1
B      10.10.13.0/24        [200,0] via 10.10.1.1
B      10.10.15.0/24        [200,0] via 10.10.1.1
B      10.10.22.0/24        [200,0] via 10.10.2.1
B      10.10.23.0/24        [200,0] via 10.10.2.1
B      10.10.25.0/24        [200,0] via 10.10.2.1
B      10.10.32.0/24        [200,0] via 10.10.2.1
B      10.10.33.0/24        [200,0] via 10.10.2.1
B      10.10.35.0/24        [200,0] via 10.10.2.1
B      10.17.120.0/24       [20,2] via 10.10.5.1
</code></pre>
<p>RT2:</p>
<pre><code>RT2#sho ip route bgp 
VRF ID: 0

B      10.10.12.0/24        [20,0] via 10.10.4.1
B      10.10.13.0/24        [20,0] via 10.10.4.1
B      10.10.15.0/24        [20,0] via 10.10.4.1
B      10.10.22.0/24        [20,0] via 10.10.4.1
B      10.10.23.0/24        [20,0] via 10.10.4.1
B      10.10.25.0/24        [20,0] via 10.10.4.1
B      10.10.32.0/24        [20,0] via 10.10.4.1
B      10.10.33.0/24        [20,0] via 10.10.4.1
B      10.10.35.0/24        [20,0] via 10.10.4.1
B      10.16.120.0/24       [20,3] via 10.10.4.1
</code></pre>
<h4 id="ipv6-bgp"><strong>ipv6 BGP</strong><a hidden class="anchor" aria-hidden="true" href="#ipv6-bgp">#</a></h4>
<p>(1)SW1ã€SW2ã€SW3ã€RT1ã€RT2 ä¹‹é—´é€šè¿‡ loopback1 å»ºç«‹ipv6 BGP é‚» å±…ã€‚SW1 å’Œ SW2 ä¹‹é—´è´¢åŠ¡é€šè¿‡ loopback2 å»ºç«‹ ipv4 BGP é‚»å±…ï¼ŒSW1 å’Œ SW2 çš„ loopback2 äº’é€šé‡‡ç”¨é™æ€è·¯ç”±ã€‚</p>
<p>SW1:</p>
<pre><code>router bgp 65001
 neighbor 2001:10:10:2::1 remote-as 65001
 neighbor 2001:10:10:2::1 update-source 2001:10:10:1::1
 neighbor 2001:10:10:3::1 remote-as 65003
 neighbor 2001:10:10:3::1 ebgp-multihop 255
 neighbor 2001:10:10:3::1 update-source 2001:10:10:1::1
 neighbor 2001:10:10:4::1 remote-as 65001
 neighbor 2001:10:10:4::1 update-source 2001:10:10:1::1
 address-family ipv6 unicast
  neighbor 2001:10:10:2::1 activate
  neighbor 2001:10:10:2::1 next-hop-self
  neighbor 2001:10:10:3::1 activate
  neighbor 2001:10:10:4::1 activate
  neighbor 2001:10:10:4::1 next-hop-self
</code></pre>
<p>SW2:</p>
<pre><code>router bgp 65001
 neighbor 2001:10:10:1::1 remote-as 65001
 neighbor 2001:10:10:1::1 update-source 2001:10:10:2::1
 neighbor 2001:10:10:3::1 remote-as 65003
 neighbor 2001:10:10:3::1 ebgp-multihop 255
 neighbor 2001:10:10:3::1 update-source 2001:10:10:2::1
 neighbor 2001:10:10:4::1 remote-as 65001
 neighbor 2001:10:10:4::1 update-source 2001:10:10:2::1
 address-family ipv6 unicast
  neighbor 2001:10:10:1::1 activate
  neighbor 2001:10:10:1::1 next-hop-self
  neighbor 2001:10:10:3::1 activate
  neighbor 2001:10:10:4::1 activate
  neighbor 2001:10:10:4::1 next-hop-self
</code></pre>
<p>SW3:</p>
<pre><code>router bgp 65003
 neighbor 2001:10:10:1::1 remote-as 65001
 neighbor 2001:10:10:1::1 ebgp-multihop 255
 neighbor 2001:10:10:1::1 update-source 2001:10:10:3::1
 neighbor 2001:10:10:2::1 remote-as 65001
 neighbor 2001:10:10:2::1 ebgp-multihop 255
 neighbor 2001:10:10:2::1 update-source 2001:10:10:3::1
 address-family ipv6 unicast
 neighbor 2001:10:10:1::1 activate
 neighbor 2001:10:10:2::1 activate
</code></pre>
<p>RT1:</p>
<pre><code>router bgp 65001
 neighbor 2001:10:10:1::1 remote-as 65001 
 neighbor 2001:10:10:1::1 update-source Loopback1
 neighbor 2001:10:10:1::1 next-hop-self
 neighbor 2001:10:10:2::1 remote-as 65001 
 neighbor 2001:10:10:2::1 update-source Loopback1
 neighbor 2001:10:10:2::1 next-hop-self
 neighbor 2001:10:10:5::1 remote-as 65002 
 neighbor 2001:10:10:5::1 ebgp-multihop 255
 neighbor 2001:10:10:5::1 update-source Loopback1
          
 address-family ipv6
  neighbor 2001:10:10:1::1 activate
  neighbor 2001:10:10:1::1 next-hop-self
  neighbor 2001:10:10:2::1 activate
  neighbor 2001:10:10:2::1 next-hop-self
  neighbor 2001:10:10:5::1 activate
</code></pre>
<p>RT2:</p>
<pre><code>router bgp 65002
 neighbor 2001:10:10:4::1 remote-as 65001 
 neighbor 2001:10:10:4::1 ebgp-multihop 255
 neighbor 2001:10:10:4::1 update-source Loopback1
 address-family ipv6
</code></pre>
<p>(2)SW1ã€SW2ã€SW3ã€RT2 åˆ†åˆ«åªå‘å¸ƒè¥é”€ã€æ³•åŠ¡ã€è´¢åŠ¡ã€äººåŠ›ç­‰ipv6 è·¯ç”±ï¼›RT1 å‘å¸ƒåŠäº‹å¤„è¥é”€å’Œ ipv6 è·¯ç”±åˆ° BGPã€‚</p>
<p>SW1:</p>
<pre><code>router bgp 65001
 address-family ipv6 unicast
 network 2001:10:10:12::/64
 network 2001:10:10:13::/64
 network 2001:10:10:15::/64
</code></pre>
<p>SW2:</p>
<pre><code>router bgp 65001
 address-family ipv6 unicast
  network 2001:10:10:22::/64
  network 2001:10:10:23::/64
  network 2001:10:10:25::/64
</code></pre>
<p>SW3:</p>
<pre><code>router bgp 65003
 address-family ipv6 unicast
  network 2001:10:10:32::/64
  network 2001:10:10:33::/64
  network 2001:10:10:35::/64
</code></pre>
<p>RT2:</p>
<pre><code>router bgp 65002
 address-family ipv6
 network 2001:10:17:120::/64
</code></pre>
<p>RT1:</p>
<pre><code>router bgp 65001
 address-family ipv6
 redistribute ospf 2 match external 2 route-map BGPV6
!
route-map BGPV6 10 permit
 match ipv6 address prefix-list BGPV6
!
ipv6 prefix-list BGPV6 seq 5 permit 2001:10:16:120::/64
</code></pre>
<p>(3)SW3 è¥é”€åˆ†åˆ«ä¸ SW1 å’Œ SW2 è¥é”€ipv6 äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW1 é“¾è·¯ è½¬å‘ï¼›SW3 æ³•åŠ¡åŠäººåŠ›åˆ†åˆ«ä¸ SW1 å’Œ SW2 æ³•åŠ¡åŠäººåŠ›ipv6 äº’è®¿ä¼˜å…ˆåœ¨ SW3_SW2 é“¾è·¯è½¬å‘ï¼Œä¸»å¤‡é“¾è·¯ç›¸äº’å¤‡ä»½ï¼›ç”¨ prefix-listã€route-map å’Œ BGP è·¯ å¾„å±æ€§è¿›è¡Œé€‰è·¯ï¼Œæ–°å¢ AS 65000ã€‚</p>
<p>SW1:</p>
<pre><code>router bgp 65001
 address-family ipv6 unicast
  neighbor 2001:10:10:3::1 route-map R&amp;FV6 in
!
route-map R&amp;FV6 permit 10
 match ipv6 address prefix-list R&amp;FV6
 set as-path prepend 65000
!
route-map R&amp;FV6 permit 20
!
ipv6 prefix-list R&amp;FV6 seq 5 permit 2001:10:10:33::/64
ipv6 prefix-list R&amp;FV6 seq 10 permit 2001:10:10:35::/64
</code></pre>
<p>SW2:</p>
<pre><code>router bgp 65001
 address-family ipv6 unicast
  neighbor 2001:10:10:3::1 route-map R&amp;FV6 in
!
route-map R&amp;FV6 permit 10
 match ipv6 address prefix-list R&amp;FV6
 set as-path prepend 65000
!
route-map R&amp;FV6 permit 20
!
ipv6 prefix-list R&amp;FV6 seq 5 permit 2001:10:10:32::/64
</code></pre>
<p>SW3:</p>
<pre><code>router bgp 65003
  address-family ipv6 unicast
   neighbor 2001:10:10:1::1 route-map R&amp;FV6 in
   neighbor 2001:10:10:2::1 route-map YXV6 in
!
route-map R&amp;FV6 permit 10
 match ipv6 address prefix-list R&amp;FV6
 set as-path prepend 65000
!
route-map R&amp;FV6 permit 20
!
route-map YXV6 permit 10
 match ipv6 address prefix-list YXV6
 set as-path prepend 65000
!
route-map YXV6 permit 20
!
ipv6 prefix-list R&amp;FV6 seq 5 permit 2001:10:10:13::/64
ipv6 prefix-list R&amp;FV6 seq 10 permit 2001:10:10:23::/64
ipv6 prefix-list R&amp;FV6 seq 15 permit 2001:10:10:15::/64
ipv6 prefix-list R&amp;FV6 seq 20 permit 2001:10:10:25::/64
ipv6 prefix-list YXV6 seq 5 permit 2001:10:10:12::/64
ipv6 prefix-list YXV6 seq 10 permit 2001:10:10:22::/64
ipv6 prefix-list YXV6 seq 15 permit 2001:10:16:120::/64
ipv6 prefix-list YXV6 seq 20 permit 2001:10:17:120::/64
</code></pre>
<p><strong>è·¯ç”±è¡¨ï¼š</strong></p>
<p>SW1:</p>
<pre><code>SW1(config)#sho ipv route nsm bgp 
IPv6 Routing Table
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - IS-IS, B - BGP
Timers: Uptime

B   2001:10:10:22::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:07:05  tag:0
B   2001:10:10:23::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:07:05  tag:0
B   2001:10:10:25::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:07:05  tag:0
B   2001:10:10:32::/64 [20/0] via 2001:10:10:3::1 (recursive via fe80::203:fff:fee0:f9b8, Vlan10), 01:06:02  tag:0
B   2001:10:10:33::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:06:17  tag:0
B   2001:10:10:35::/64 [200/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:06:17  tag:0
B   2001:10:16:120::/64 [200/20] via 2001:10:10:4::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1026), 01:05:18  tag:0
</code></pre>
<p>SW2:</p>
<pre><code>SW2#sho ipv route nsm bgp 
IPv6 Routing Table
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - IS-IS, B - BGP
Timers: Uptime

B   2001:10:10:12::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:07:22  tag:0
B   2001:10:10:13::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:07:22  tag:0
B   2001:10:10:15::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:07:22  tag:0
B   2001:10:10:32::/64 [200/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1026), 01:06:17  tag:0
B   2001:10:10:33::/64 [20/0] via 2001:10:10:3::1 (recursive via fe80::203:fff:fee0:f9b8, Vlan1022), 01:06:34  tag:0
B   2001:10:10:35::/64 [20/0] via 2001:10:10:3::1 (recursive via fe80::203:fff:fee0:f9b8, Vlan1022), 01:06:34  tag:0
B   2001:10:16:120::/64 [200/20] via 2001:10:10:4::1 (recursive via fe80::203:fff:fedc:c392, Vlan1021), 01:06:37  tag:0
</code></pre>
<p>SW3:</p>
<pre><code>SW3#sho ipv route nsm bgp
IPv6 Routing Table
Codes: K - kernel route, C - connected, S - static, R - RIP, O - OSPF,
       I - IS-IS, B - BGP
Timers: Uptime

B   2001:10:10:12::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:04:16  tag:0
B   2001:10:10:13::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43  tag:0
B   2001:10:10:15::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43  tag:0
B   2001:10:10:22::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:04:43  tag:0
B   2001:10:10:23::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43  tag:0
B   2001:10:10:25::/64 [20/0] via 2001:10:10:2::1 (recursive via fe80::203:fff:fee0:f9b5, Vlan1022), 00:04:43  tag:0
B   2001:10:16:120::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:03:47  tag:0
B   2001:10:17:120::/64 [20/0] via 2001:10:10:1::1 (recursive via fe80::203:fff:fee0:f9b2, Vlan1021), 00:03:47  tag:0
</code></pre>
<p>RT1:</p>
<pre><code>RT1#sho ipv route bgp 
B      2001:10:10:12::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:1::1
B      2001:10:10:13::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:1::1
B      2001:10:10:15::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:1::1
B      2001:10:10:22::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:2::1
B      2001:10:10:23::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:2::1
B      2001:10:10:25::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:2::1
B      2001:10:10:32::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:1::1
B      2001:10:10:33::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:2::1
B      2001:10:10:35::/64[1]
        [200,0] via fe80::203:fff:fee0:f9b5(on GigaEthernet0/1)
        gate 2001:10:10:2::1
B      2001:10:17:120::/64[1]
        [20,2] via fe80::203:fff:fedc:c389(on GigaEthernet0/0)
        gate 2001:10:10:5::1
</code></pre>
<p>RT2:</p>
<pre><code>RT2#sho ipv route bgp 
B      2001:10:10:12::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:13::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:15::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:22::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:23::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:25::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:32::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:33::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:10:35::/64[1]
        [20,0] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
B      2001:10:16:120::/64[1]
        [20,20] via fe80::203:fff:fedc:c391(on GigaEthernet0/0)
        gate 2001:10:10:4::1
</code></pre>
<h3 id="10bgpmplsvpn">10ã€BGPã€MPLSã€VPN<a hidden class="anchor" aria-hidden="true" href="#10bgpmplsvpn">#</a></h3>
<p>åˆ©ç”¨ BGP MPLS VPN æŠ€æœ¯ï¼ŒRT1 ä¸ RT2 ä»¥å¤ªé“¾è·¯é—´è¿è¡Œå¤šåè®®æ ‡ç­¾äº¤æ¢ã€ æ ‡ç­¾åˆ†å‘åè®®ã€‚RT1 ä¸ RT2 é—´åˆ›å»ºè´¢åŠ¡ VPN å®ä¾‹ï¼Œåç§°ä¸º CWï¼ŒRT1 çš„ RD å€¼ä¸º 1:1ï¼Œexport rt å€¼ä¸º 1:2ï¼Œimport rt å€¼ä¸º 2:1ï¼›RT2 çš„ RD å€¼ä¸º 2:2ã€‚é€šè¿‡ä¸¤ç«¯ loopback1 å»ºç«‹ VPN é‚»å±…ï¼Œåˆ†åˆ«å®ç°ä¸¤ç«¯ loopback5 ipv4 äº’é€šå’Œ ipv6 äº’é€šã€‚</p>
<h4 id="ipv4-mpls"><strong>ipv4 MPLS</strong><a hidden class="anchor" aria-hidden="true" href="#ipv4-mpls">#</a></h4>
<p>RT1:</p>
<pre><code>RT1_config#sho run

ip vrf CW
 rd 1:1
 route-target export 1:2
 route-target import 2:1
 
interface Loopback5
 ip vrf forwarding CW
</code></pre>
<pre><code>RT1_config#mpls ip
RT1_config#mpls ldp router-id 10.10.4.1 
RT1_config#int g0/0
RT1_config_g0/0#mpls ip
RT1_config_g0/0#mpls ldp enable
</code></pre>
<pre><code>router bgp 65001
 
 address-family vpnv4
 neighbor 10.10.5.1 activate
 neighbor 10.10.5.1 send-community extended
 exit-address-family
 
 address-family ipv4 vrf CW 
 no synchronization
 network 10.10.4.5/32
 exit-address-family
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>RT1_config#sho ip route vrf CW bgp 
VRF ID: 1

B      10.10.5.5/32         [20,0] via 10.10.5.1
</code></pre>
<p>RT2:</p>
<pre><code>RT2_config#sho run

ip vrf CW
 rd 2:2
 route-target export 2:1
 route-target import 1:2
 
 interface Loopback5
 ip vrf forwarding CW
</code></pre>
<pre><code>RT2_config#mpls ip
RT2_config#mpls ldp router-id 10.10.5.1
RT2_config#int g0/0
RT2_config_g0/0#mpls ip
RT2_config_g0/0#mpls ldp enable
</code></pre>
<pre><code>router bgp 65002

 address-family vpnv4
 neighbor 10.10.4.1 activate
 neighbor 10.10.4.1 send-community extended
 exit-address-family
 
 address-family ipv4 vrf CW
 no synchronization
 network 10.10.5.5/32
 exit-address-family
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>RT2_config#sho ip route vr CW bgp 
VRF ID: 1

B      10.10.4.5/32         [20,0] via 10.10.4.1
</code></pre>
<h4 id="ipv6-mpls"><strong>ipv6 MPLS</strong><a hidden class="anchor" aria-hidden="true" href="#ipv6-mpls">#</a></h4>
<p>RT1:</p>
<pre><code>RT1_config#sho run 

ipv6 unicast-routing
ipv6 vrf CW
 rd 1:1
 route-target import 2:1
 route-target export 1:2
 
 interface Loopback5
 ipv6 vrf forwarding CW
</code></pre>
<pre><code>router bgp 65001

 address-family vpnv6
 neighbor 10.10.5.1 activate
 neighbor 10.10.5.1 send-community extended
 exit-address-family
 
 address-family ipv6 vrf CW
 no synchronization
 network 2001:10:10:4::5/128
 exit-address-family
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code>RT1_config#sho ipv route vrf CW bgp 
B      2001:10:10:5::5/128[1]
        [20,0] via ::ffff:10.10.255.30(on GigaEthernet0/0)
        gate ::ffff:10.10.5.1 (vrf_id: 0)
</code></pre>
<p>RT2:</p>
<pre><code>RT2_config#sho run 

ipv6 unicast-routing
ipv6 vrf CW
 rd 1:1
 route-target import 1:2
 route-target export 2:1
 
 interface Loopback5
 ipv6 vrf forwarding CW
</code></pre>
<pre><code>router bgp 65002
  
 address-family vpnv6
 neighbor 10.10.4.1 activate
 neighbor 10.10.4.1 send-community extended
 exit-address-family
 
 address-family ipv6 vrf CW
 no synchronization
 network 2001:10:10:5::5/128
 exit-address-family
</code></pre>
<p>é…ç½®ç»“æœï¼š</p>
<pre><code> RT2_config#sho ipv route vrf CW bgp 
B      2001:10:10:4::5/128[1]
        [20,0] via ::ffff:10.10.255.29(on GigaEthernet0/0)
        gate ::ffff:10.10.4.1 (vrf_id: 0)
</code></pre>
<h3 id="11pim-sm-ç»„æ’­">11ã€PIM-SM ç»„æ’­<a hidden class="anchor" aria-hidden="true" href="#11pim-sm-ç»„æ’­">#</a></h3>
<p>SW1ã€SW2ã€RT1ã€RT2ã€AC1 è¿è¡Œ PIM-SMï¼ŒRT1 loopback1 ä¸º c-bsr å’Œ crpï¼ŒRT2 è¿è¡Œ IGMPv3ï¼›SW1 äº§å“éƒ¨é—¨ï¼ˆPC1 æµ‹è¯•ï¼‰ç»ˆç«¯å¯ç”¨ç»„æ’­ï¼Œç”¨ VLC å·¥å…·ä¸² æµæ’­æ”¾è§†é¢‘æ–‡ä»¶â€œ1.mp4â€ï¼Œæ¨¡æ‹Ÿç»„æ’­æºï¼Œè®¾ç½®æ­¤è§†é¢‘å¾ªç¯æ’­æ”¾ï¼Œç»„åœ°å€232.1.1.1ï¼Œ ç«¯å£ 1234ï¼Œå®ç°åˆ†å…¬å¸äº§å“éƒ¨é—¨ï¼ˆPC2 æµ‹è¯•ï¼‰æ”¶çœ‹è§†é¢‘ã€‚</p>
<p>SW1:</p>
<pre><code>SW1(config)#ip pim multicast-routing

Interface Ethernet1/0/21
 ip dhcp snooping trust
 ipv6 dhcp snooping trust
Interface Ethernet1/0/22
 ip dhcp snooping trust
 ipv6 dhcp snooping trust
Interface Ethernet1/0/26
 ip dhcp snooping trust
 ipv6 dhcp snooping trust
 
 interface Vlan10
  ip pim sparse-mode
 interface Vlan1026
  ip pim sparse-mode
</code></pre>
<p>SW2:</p>
<pre><code>SW2(config)#ip pim multicast-routing

interface Vlan1021
 ip pim sparse-mode
interface Vlan1026
 ip pim sparse-mode
</code></pre>
<p>RT1:</p>
<pre><code>ip multicast-routing

router pim-sm
  reg-rate-limit 1
  c-bsr l1
  c-rp l1

interface Loopback1
 ip pim-sm
interface GigaEthernet0/0
 ip pim-sm
interface GigaEthernet0/1
 ip pim-sm
</code></pre>
<p>RT2:</p>
<pre><code>ip multicast-routing

router pim-sm
  reg-rate-limit 1
  
interface GigaEthernet0/0
 ip pim-sm
interface GigaEthernet0/1
 ip pim-sm
 ip igmp enable
</code></pre>
<p>AC1:</p>
<pre><code>ip pim multicast-routing

interface Vlan1001
  ip pim sparse-mode
interface Vlan110
 ip pim sparse-mode
</code></pre>
<h2 id="ä¸‰æ— çº¿é…ç½®">ä¸‰ã€æ— çº¿é…ç½®<a hidden class="anchor" aria-hidden="true" href="#ä¸‰æ— çº¿é…ç½®">#</a></h2>
<h3 id="1apä¸Šçº¿">1ã€APä¸Šçº¿ï¼š<a hidden class="anchor" aria-hidden="true" href="#1apä¸Šçº¿">#</a></h3>
<pre><code>wireless
 auto-ip-assign
 ap authentication mac
 discovery vlan-list 100
 
 ap database 00-03-0f-8a-f8-b0
</code></pre>
<pre><code>AC1(config-wireless)#sho wireless ap status

    MAC Address                                                            Configuration                

 (*) Peer Managed  IP Address                              Profile Status     Status           Age      

------------------ --------------------------------------- ------- ------- ------------- --------------

 00-03-0f-8a-f8-b0 10.17.100.9                             1       Managed Success       0d:00:00:01

Total Access Points............................ 1
</code></pre>
<h3 id="2åˆ›å»ºssid">2ã€åˆ›å»ºssid<a hidden class="anchor" aria-hidden="true" href="#2åˆ›å»ºssid">#</a></h3>
<p>AC1 loopback1 ipv4 å’Œ ipv6 åœ°å€åˆ†åˆ«ä½œä¸º AC1 çš„ ipv4 å’Œ ipv6 ç®¡ç†åœ° å€ã€‚AP äºŒå±‚è‡ªåŠ¨æ³¨å†Œï¼ŒAP é‡‡ç”¨ MAC åœ°å€è®¤è¯ã€‚é…ç½® 2 ä¸ª ssidï¼Œåˆ†åˆ«ä¸º SKILLS2.4G å’Œ SKILLS-5Gã€‚SKILLS-2.4G å¯¹åº” vlan110ï¼Œç”¨ network 110 å’Œ radio1ï¼ˆæ¨¡ å¼ä¸º n-only-gï¼‰,ç”¨æˆ·æ¥å…¥æ— çº¿ç½‘ç»œæ—¶éœ€è¦é‡‡ç”¨åŸºäº WPA-personal åŠ å¯†æ–¹å¼ï¼Œ å¯†ç ä¸º Pass-1234ã€‚SKILLS-5G å¯¹åº” vlan120ï¼Œç”¨ network 120 å’Œ radio2ï¼ˆæ¨¡å¼ ä¸º n-only-aï¼‰ï¼Œä¸éœ€è¦è®¤è¯ï¼Œéšè— ssidï¼ŒSKILLS-5G ç”¨å€’æ•°ç¬¬ä¸€ä¸ªå¯ç”¨ VAP å‘é€ 5G ä¿¡å·ã€‚</p>
<pre><code> network 110
  security mode wpa-personal
  ssid SKILLS-2.4G
  vlan 110
  wpa key Pass-1234
  
 network 120
  hide-ssid
  ssid SKILLS-5G
  vlan 120
  
 ap profile 1
  radio 1
   mode n-only-g
   vap 0
    network 110
 
 radio 2
   mode n-only-a
   vap 15
    network 120
</code></pre>
<h3 id="3apè‡ªåŠ¨å‡çº§">3ã€APè‡ªåŠ¨å‡çº§<a hidden class="anchor" aria-hidden="true" href="#3apè‡ªåŠ¨å‡çº§">#</a></h3>
<p>å½“ AP ä¸Šçº¿ï¼Œå¦‚æœ AC ä¸­å‚¨å­˜çš„ Image ç‰ˆæœ¬å’Œ AP çš„ Image ç‰ˆæœ¬å·ä¸åŒæ—¶ï¼Œ ä¼šè§¦å‘ AP è‡ªåŠ¨å‡çº§ã€‚AP å¤±è´¥çŠ¶æ€è¶…æ—¶æ—¶é—´åŠæ¢æµ‹åˆ°çš„å®¢æˆ·ç«¯çŠ¶æ€è¶…æ—¶æ—¶é—´éƒ½ä¸º 2 å°æ—¶ã€‚</p>
<pre><code>AC1(config-wireless)#ap auto-upgrade 
AC1(config-wireless)#agetime ap-failure 2
AC1(config-wireless)#agetime detected-clients
</code></pre>
<h3 id="4é»‘åå•macè®¤è¯æ¨¡å¼">4ã€é»‘åå•MACè®¤è¯æ¨¡å¼<a hidden class="anchor" aria-hidden="true" href="#4é»‘åå•macè®¤è¯æ¨¡å¼">#</a></h3>
<p>MAC è®¤è¯æ¨¡å¼ä¸ºé»‘åå•ï¼ŒMAC åœ°å€ä¸º 80-45-DD-77-CC-48 çš„æ— çº¿ç»ˆç«¯é‡‡ç”¨ å…¨å±€é…ç½® MAC è®¤è¯ã€‚</p>
<pre><code> mac-authentication-mode black-list
 known-client 80-45-dd-77-cc-48 action global-action
 
 network 110
  mac authentication local 
 network 120
  mac authentication local
</code></pre>
<h3 id="5é˜²æ­¢å¤š-ap-å’Œ-ac-ç›¸è¿æ—¶è¿‡å¤šçš„å®‰å…¨è®¤è¯è¿æ¥è€Œæ¶ˆè€—-cpu-èµ„æºæ£€æµ‹åˆ°-ap-ä¸-ac-10-åˆ†é’Ÿå†…å»ºç«‹è¿æ¥-5-æ¬¡å°±ä¸å†å…è®¸ç»§ç»­è¿æ¥2-å°æ—¶åæ¢å¤æ­£å¸¸">5ã€é˜²æ­¢å¤š AP å’Œ AC ç›¸è¿æ—¶è¿‡å¤šçš„å®‰å…¨è®¤è¯è¿æ¥è€Œæ¶ˆè€— CPU èµ„æºï¼Œæ£€æµ‹åˆ° AP ä¸ AC 10 åˆ†é’Ÿå†…å»ºç«‹è¿æ¥ 5 æ¬¡å°±ä¸å†å…è®¸ç»§ç»­è¿æ¥ï¼Œ2 å°æ—¶åæ¢å¤æ­£å¸¸ã€‚<a hidden class="anchor" aria-hidden="true" href="#5é˜²æ­¢å¤š-ap-å’Œ-ac-ç›¸è¿æ—¶è¿‡å¤šçš„å®‰å…¨è®¤è¯è¿æ¥è€Œæ¶ˆè€—-cpu-èµ„æºæ£€æµ‹åˆ°-ap-ä¸-ac-10-åˆ†é’Ÿå†…å»ºç«‹è¿æ¥-5-æ¬¡å°±ä¸å†å…è®¸ç»§ç»­è¿æ¥2-å°æ—¶åæ¢å¤æ­£å¸¸">#</a></h3>
<pre><code>    wireless ap anti-flood interval 10
    wireless ap anti-flood max-conn-count 5
    wireless ap anti-flood agetime 120
</code></pre>
<h3 id="6ç”¨æˆ·è®¿é—®-internet--https">6ã€ç”¨æˆ·è®¿é—® Internet  https<a hidden class="anchor" aria-hidden="true" href="#6ç”¨æˆ·è®¿é—®-internet--https">#</a></h3>
<p>é…ç½®vlan110æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šç­æ—¶é—´ï¼ˆå·¥ä½œæ—¥09:00-17:00ï¼‰è®¿é—®Internet https ä¸Šä¸‹è¡Œ CIR ä¸º 100Mbpsï¼ŒCBS ä¸º 200Mbpsï¼ŒPBS ä¸º 300Mbpsï¼Œexceed-action å’Œ violate-action å‡ä¸º dropã€‚æ—¶é—´èŒƒå›´åç§°ã€æ§åˆ¶åˆ—è¡¨åç§°ã€åˆ†ç±»åç§°ã€ç­–ç•¥ åç§°å‡ä¸º SKILLSã€‚</p>
<pre><code>time-range SKILLS
 periodic weekdays 09:00:00 to 17:00:00

ip access-list extended SKILLS
  
  exit

class-map SKILLS
 match access-group SKILLS

policy-map SKILLS
 class SKILLS
 policy 100000 200000 300000 exceed-action drop violate-action drop
 exit
 
 network 110
  client-qos enable
  client-qos diffserv-policy down SKILLS
  client-qos diffserv-policy up SKILLS
</code></pre>
<h3 id="7apç»„æ’­çªå‘é™åˆ¶apå‘å°„åŠŸç‡">7ã€APç»„æ’­çªå‘é™åˆ¶ã€APå‘å°„åŠŸç‡<a hidden class="anchor" aria-hidden="true" href="#7apç»„æ’­çªå‘é™åˆ¶apå‘å°„åŠŸç‡">#</a></h3>
<p>å¼€å¯ AP ç»„æ’­å¹¿æ’­çªå‘é™åˆ¶åŠŸèƒ½ï¼›AP æ”¶åˆ°é”™è¯¯å¸§æ—¶ï¼Œå°†ä¸å†å‘é€ ACK å¸§ï¼› AP å‘é€å‘æ— çº¿ç»ˆç«¯è¡¨æ˜ AP å­˜åœ¨çš„å¸§æ—¶é—´é—´éš”ä¸º 1 ç§’ã€‚AP å‘å°„åŠŸç‡ä¸º 80%ã€‚</p>
<pre><code> radio 1
   rate-limit
   beacon-interval 1000
   incorrect-frame-no-ack
   power default 80
   
  radio 2
   rate-limit
   beacon-interval 1000
   incorrect-frame-no-ack
   power default 80
</code></pre>
<h3 id="8é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šä¸‹è¡Œæœ€å¤§å¸¦å®½ä¸º8000mkpsarpä¸Šä¸‹è¡Œæœ€å¤§é€Ÿç‡ä¸º6packetss">8ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šä¸‹è¡Œæœ€å¤§å¸¦å®½ä¸º8000Mkpsï¼Œarpä¸Šä¸‹è¡Œæœ€å¤§é€Ÿç‡ä¸º6packets/s<a hidden class="anchor" aria-hidden="true" href="#8é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ä¸Šä¸‹è¡Œæœ€å¤§å¸¦å®½ä¸º8000mkpsarpä¸Šä¸‹è¡Œæœ€å¤§é€Ÿç‡ä¸º6packetss">#</a></h3>
<pre><code>  client-qos bandwidth-limit down 800000
  client-qos bandwidth-limit up 800000
  client-qos bandwidth-limit arp down 6
  client-qos bandwidth-limit arp up 6
</code></pre>
<h3 id="9é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ç›¸äº’éš”ç¦»å¼€å¯arpæŠ‘åˆ¶åŠŸèƒ½é™åˆ¶æ¯å¤©æ—©ä¸Š0ç‚¹åˆ°4ç‚¹ç¦æ­¢ç»ˆç«¯æ¥å…¥">9ã€é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ç›¸äº’éš”ç¦»ï¼Œå¼€å¯ARPæŠ‘åˆ¶åŠŸèƒ½ï¼Œé™åˆ¶æ¯å¤©æ—©ä¸Š0ç‚¹åˆ°4ç‚¹ç¦æ­¢ç»ˆç«¯æ¥å…¥<a hidden class="anchor" aria-hidden="true" href="#9é…ç½®vlan140æ— çº¿æ¥å…¥ç”¨æˆ·ç›¸äº’éš”ç¦»å¼€å¯arpæŠ‘åˆ¶åŠŸèƒ½é™åˆ¶æ¯å¤©æ—©ä¸Š0ç‚¹åˆ°4ç‚¹ç¦æ­¢ç»ˆç«¯æ¥å…¥">#</a></h3>
<pre><code>station-isolation
arp-suppression
time-limit from 00:00 to 04:00 weekday all
</code></pre>
<h3 id="10ç‰¹æƒæ¨¡å¼ä¸‹å‘"><strong>10ã€ç‰¹æƒæ¨¡å¼ä¸‹å‘ï¼š</strong><a hidden class="anchor" aria-hidden="true" href="#10ç‰¹æƒæ¨¡å¼ä¸‹å‘">#</a></h3>
<pre><code>AC1#wireless ap profile apply 1 
All configurations will be send to the aps associated to this profile and associated clients on these aps will be disconnected. Because of work mode configurations, some aps associated to this profile will reboot. Are you sure you want to apply the profile configuration? [Y/N] y
AP Profile apply is in progress.
</code></pre>


  </div>

  <footer class="post-footer">
    <ul class="post-tags">
    </ul>
<nav class="paginav">
  <a class="prev" href="https://erain.fun/posts/tech/%E7%88%B1%E5%BF%AB%E5%AF%B9openvpn%E7%9A%84%E9%85%8D%E7%BD%AE/">
    <span class="title">Â« Prev</span>
    <br>
    <span>çˆ±å¿«å¯¹OpenVPNçš„é…ç½®</span>
  </a>
  <a class="next" href="https://erain.fun/posts/tech/%E6%A8%AA%E5%90%91%E7%A7%BB%E5%8A%A8-%E9%80%9A%E8%BF%87ssh%E8%BF%9E%E6%8E%A5%E4%BD%BF%E7%9B%AE%E6%A0%87%E6%9C%BA%E5%8F%8A%E4%BD%9C%E4%B8%BAsocks5%E4%BB%A3%E7%90%86%E6%9C%8D%E5%8A%A1%E5%99%A8/">
    <span class="title">Next Â»</span>
    <br>
    <span>æ¨ªå‘ç§»åŠ¨ é€šè¿‡SSHè¿æ¥ä½¿ç›®æ ‡æœºåŠä½œä¸ºSocks5ä»£ç†æœåŠ¡å™¨</span>
  </a>
</nav>

  </footer>
</article>
    </main>
    
<footer class="footer">
    <span>Â©2020-2023 æœªæ·¼</span>
    <span>All rights reserved.


    </span>
</footer>
<a href="#top" aria-label="go to top" title="Go to Top (Alt + G)" class="top-link" id="top-link" accesskey="g">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentColor">
        <path d="M12 6H0l6-6z" />
    </svg>
</a>

<script>
    let menu = document.getElementById('menu')
    if (menu) {
        menu.scrollLeft = localStorage.getItem("menu-scroll-position");
        menu.onscroll = function () {
            localStorage.setItem("menu-scroll-position", menu.scrollLeft);
        }
    }

    document.querySelectorAll('a[href^="#"]').forEach(anchor => {
        anchor.addEventListener("click", function (e) {
            e.preventDefault();
            var id = this.getAttribute("href").substr(1);
            if (!window.matchMedia('(prefers-reduced-motion: reduce)').matches) {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({
                    behavior: "smooth"
                });
            } else {
                document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();
            }
            if (id === "top") {
                history.replaceState(null, null, " ");
            } else {
                history.pushState(null, null, `#${id}`);
            }
        });
    });

</script>
<script>
    var mybutton = document.getElementById("top-link");
    window.onscroll = function () {
        if (document.body.scrollTop > 800 || document.documentElement.scrollTop > 800) {
            mybutton.style.visibility = "visible";
            mybutton.style.opacity = "1";
        } else {
            mybutton.style.visibility = "hidden";
            mybutton.style.opacity = "0";
        }
    };

</script>
<script>
    document.querySelectorAll('pre > code').forEach((codeblock) => {
        const container = codeblock.parentNode.parentNode;

        const copybutton = document.createElement('button');
        copybutton.classList.add('copy-code');
        copybutton.innerHTML = 'copy';

        function copyingDone() {
            copybutton.innerHTML = 'copied!';
            setTimeout(() => {
                copybutton.innerHTML = 'copy';
            }, 2000);
        }

        copybutton.addEventListener('click', (cb) => {
            if ('clipboard' in navigator) {
                navigator.clipboard.writeText(codeblock.textContent);
                copyingDone();
                return;
            }

            const range = document.createRange();
            range.selectNodeContents(codeblock);
            const selection = window.getSelection();
            selection.removeAllRanges();
            selection.addRange(range);
            try {
                document.execCommand('copy');
                copyingDone();
            } catch (e) { };
            selection.removeRange(range);
        });

        if (container.classList.contains("highlight")) {
            container.appendChild(copybutton);
        } else if (container.parentNode.firstChild == container) {
            
        } else if (codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName == "TABLE") {
            
            codeblock.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(copybutton);
        } else {
            
            codeblock.parentNode.appendChild(copybutton);
        }
    });
</script>
</body>

</html>
